Durations for: Evaluation=240ms, Total=259ms
2022-01-11 13:47:19.464  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c323a7da-1048-420b-ad31-edaf98e34e74, content=null, timestamp=1641908839420, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56046, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908839418, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=99D0C0F90BE14C5F05A8B56BC3D20705, http-session-last-accessed-time=1641908839418, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56046 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:19.476  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:19.488  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45711788
2022-01-11 13:47:19.498  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45711788
2022-01-11 13:47:19.552  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45711788
2022-01-11 13:47:19.559  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45711788
2022-01-11 13:47:19.586  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45711788
2022-01-11 13:47:19.590  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:19.593  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:19.596  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45711788
2022-01-11 13:47:19.600  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45711788
2022-01-11 13:47:19.605  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:19.609  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:19.616  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45711788
2022-01-11 13:47:19.654  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45711788
2022-01-11 13:47:19.659  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45711788
2022-01-11 13:47:19.695  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8022703872875-975336, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:19.700  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c323a7da-1048-420b-ad31-edaf98e34e74, content=DENY, timestamp=1641908839700, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:19.707  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=222ms, Total=251ms
2022-01-11 13:47:19.780  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8bb11548-8734-4a51-b1aa-30a9bd23fb77, content=null, timestamp=1641908839767, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56048, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908839749, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=287E2FAD7BC031904476B892C7CE44C9, http-session-last-accessed-time=1641908839749, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56048 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:19.792  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:19.817  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2992cb7d
2022-01-11 13:47:19.821  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2992cb7d
2022-01-11 13:47:19.854  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2992cb7d
2022-01-11 13:47:19.857  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2992cb7d
2022-01-11 13:47:19.924  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2992cb7d
2022-01-11 13:47:19.929  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:19.934  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:19.938  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2992cb7d
2022-01-11 13:47:19.943  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2992cb7d
2022-01-11 13:47:19.947  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:19.949  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:19.952  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2992cb7d
2022-01-11 13:47:19.974  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2992cb7d
2022-01-11 13:47:19.978  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2992cb7d
2022-01-11 13:47:20.017  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8023027231175-406055, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:20.021  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8bb11548-8734-4a51-b1aa-30a9bd23fb77, content=DENY, timestamp=1641908840021, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:20.032  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=219ms, Total=254ms
2022-01-11 13:47:20.105  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=dca275e4-7ebe-486b-90ad-610545e3acad, content=null, timestamp=1641908840091, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56050, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908840088, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=30CC988DBB6EA172E3EB8CFBAB9F5D1B, http-session-last-accessed-time=1641908840088, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56050 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:20.110  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:20.126  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ff31df5
2022-01-11 13:47:20.133  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ff31df5
2022-01-11 13:47:20.167  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ff31df5
2022-01-11 13:47:20.169  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ff31df5
2022-01-11 13:47:20.245  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ff31df5
2022-01-11 13:47:20.247  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:20.250  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:20.254  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ff31df5
2022-01-11 13:47:20.257  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ff31df5
2022-01-11 13:47:20.261  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:20.265  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:20.268  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ff31df5
2022-01-11 13:47:20.310  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ff31df5
2022-01-11 13:47:20.327  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ff31df5
2022-01-11 13:47:20.365  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8023339065775-626729, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:20.369  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=dca275e4-7ebe-486b-90ad-610545e3acad, content=DENY, timestamp=1641908840368, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:20.374  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=255ms, Total=271ms
2022-01-11 13:47:20.520  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=08d3b4db-670f-4e0c-aa31-64e64a93955b, content=null, timestamp=1641908840475, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56052, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908840466, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=AFA0903241DC6E95020FC62299AB53CB, http-session-last-accessed-time=1641908840466, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56052 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:20.528  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:20.533  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f547a5d
2022-01-11 13:47:20.536  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f547a5d
2022-01-11 13:47:20.592  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f547a5d
2022-01-11 13:47:20.594  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f547a5d
2022-01-11 13:47:20.703  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f547a5d
2022-01-11 13:47:20.707  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:20.710  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:20.714  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f547a5d
2022-01-11 13:47:20.722  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f547a5d
2022-01-11 13:47:20.725  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:20.729  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:20.733  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f547a5d
2022-01-11 13:47:20.774  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f547a5d
2022-01-11 13:47:20.777  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f547a5d
2022-01-11 13:47:20.824  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8023755781775-111487, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:20.827  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=08d3b4db-670f-4e0c-aa31-64e64a93955b, content=DENY, timestamp=1641908840826, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:20.831  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=296ms, Total=318ms
2022-01-11 13:47:20.916  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=eb3dc0f2-3d1f-4c7e-a3ad-c417a6d33918, content=null, timestamp=1641908840892, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56054, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908840888, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=19DA58E5AF63984712390CCCFD40E5FE, http-session-last-accessed-time=1641908840888, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56054 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:20.925  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:20.938  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2fd19507
2022-01-11 13:47:20.942  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2fd19507
2022-01-11 13:47:21.003  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2fd19507
2022-01-11 13:47:21.006  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2fd19507
2022-01-11 13:47:21.075  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2fd19507
2022-01-11 13:47:21.077  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:21.080  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:21.088  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2fd19507
2022-01-11 13:47:21.094  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2fd19507
2022-01-11 13:47:21.100  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:21.105  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:21.109  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2fd19507
2022-01-11 13:47:21.142  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2fd19507
2022-01-11 13:47:21.145  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2fd19507
2022-01-11 13:47:21.176  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8024153088575-950016, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:21.179  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=eb3dc0f2-3d1f-4c7e-a3ad-c417a6d33918, content=DENY, timestamp=1641908841179, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:21.184  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=252ms, Total=270ms
2022-01-11 13:47:21.251  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=55d946d4-2f33-4ac2-ad09-72005775c939, content=null, timestamp=1641908841240, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56056, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908841237, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=1AB2BC0B6BCE511C8EDE94A7968AA82D, http-session-last-accessed-time=1641908841237, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56056 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:21.256  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:21.265  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@598dd310
2022-01-11 13:47:21.269  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@598dd310
2022-01-11 13:47:21.299  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@598dd310
2022-01-11 13:47:21.303  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@598dd310
2022-01-11 13:47:21.381  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@598dd310
2022-01-11 13:47:21.384  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:21.386  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:21.391  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@598dd310
2022-01-11 13:47:21.394  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@598dd310
2022-01-11 13:47:21.398  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:21.402  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:21.406  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@598dd310
2022-01-11 13:47:21.442  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@598dd310
2022-01-11 13:47:21.452  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@598dd310
2022-01-11 13:47:21.483  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8024484873475-629867, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:21.489  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=55d946d4-2f33-4ac2-ad09-72005775c939, content=DENY, timestamp=1641908841489, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:21.496  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=230ms, Total=246ms
2022-01-11 13:47:21.588  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=79fa0090-8a9e-495c-8570-1f74c5d24378, content=null, timestamp=1641908841541, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56058, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908841539, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=621F919BFCC9421FF972CC33B6D5CEF8, http-session-last-accessed-time=1641908841539, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56058 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:21.593  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:21.601  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3081d4d1
2022-01-11 13:47:21.605  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3081d4d1
2022-01-11 13:47:21.633  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3081d4d1
2022-01-11 13:47:21.639  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3081d4d1
2022-01-11 13:47:21.710  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3081d4d1
2022-01-11 13:47:21.713  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:21.715  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:21.718  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3081d4d1
2022-01-11 13:47:21.721  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3081d4d1
2022-01-11 13:47:21.724  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:21.726  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:21.729  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3081d4d1
2022-01-11 13:47:21.759  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3081d4d1
2022-01-11 13:47:21.763  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3081d4d1
2022-01-11 13:47:21.800  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8024822972675-330795, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:21.813  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=79fa0090-8a9e-495c-8570-1f74c5d24378, content=DENY, timestamp=1641908841813, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:21.817  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=216ms, Total=231ms
2022-01-11 13:47:21.901  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d615d5fd-3b66-44d1-bfc6-c65ed8d93a02, content=null, timestamp=1641908841892, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56060, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908841873, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=3D675402E3DE15BE2A4940E9B0D68FD1, http-session-last-accessed-time=1641908841873, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56060 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:21.908  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:21.932  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62e10687
2022-01-11 13:47:21.937  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62e10687
2022-01-11 13:47:21.979  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62e10687
2022-01-11 13:47:21.982  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62e10687
2022-01-11 13:47:22.079  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62e10687
2022-01-11 13:47:22.083  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:22.086  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:22.088  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62e10687
2022-01-11 13:47:22.092  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62e10687
2022-01-11 13:47:22.094  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:22.096  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:22.099  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62e10687
2022-01-11 13:47:22.148  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62e10687
2022-01-11 13:47:22.153  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62e10687
2022-01-11 13:47:22.221  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8025147042575-51030, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:22.226  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d615d5fd-3b66-44d1-bfc6-c65ed8d93a02, content=DENY, timestamp=1641908842226, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:22.235  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=305ms, Total=337ms
2022-01-11 13:47:22.413  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5ed34014-df1f-41f5-8e2e-b909505aa7b7, content=null, timestamp=1641908842396, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56062, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908842368, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=9C28FB6B2C385FA431C6BC376F6F5E96, http-session-last-accessed-time=1641908842368, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56062 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:22.424  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:22.431  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13aaa18
2022-01-11 13:47:22.437  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13aaa18
2022-01-11 13:47:22.470  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13aaa18
2022-01-11 13:47:22.478  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13aaa18
2022-01-11 13:47:22.549  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13aaa18
2022-01-11 13:47:22.552  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:22.557  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:22.563  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13aaa18
2022-01-11 13:47:22.567  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13aaa18
2022-01-11 13:47:22.571  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:22.575  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:22.581  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13aaa18
2022-01-11 13:47:22.633  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13aaa18
2022-01-11 13:47:22.635  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13aaa18
2022-01-11 13:47:22.661  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8025653059375-693756, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:22.664  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5ed34014-df1f-41f5-8e2e-b909505aa7b7, content=DENY, timestamp=1641908842664, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:22.692  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=237ms, Total=281ms
2022-01-11 13:47:22.838  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2de2ea88-7b05-4fcc-a149-0bf5cefc2d04, content=null, timestamp=1641908842782, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56064, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908842779, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=A1884BC173DBDFDF073C413DD6B46EE9, http-session-last-accessed-time=1641908842779, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56064 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:22.855  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:22.860  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5dc7d7ec
2022-01-11 13:47:22.865  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5dc7d7ec
2022-01-11 13:47:22.889  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5dc7d7ec
2022-01-11 13:47:22.894  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5dc7d7ec
2022-01-11 13:47:22.923  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5dc7d7ec
2022-01-11 13:47:22.926  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:22.932  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:22.937  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5dc7d7ec
2022-01-11 13:47:22.943  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5dc7d7ec
2022-01-11 13:47:22.953  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:22.958  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:22.961  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5dc7d7ec
2022-01-11 13:47:22.996  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5dc7d7ec
2022-01-11 13:47:23.000  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5dc7d7ec
2022-01-11 13:47:23.079  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8026083926575-173724, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:23.082  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2de2ea88-7b05-4fcc-a149-0bf5cefc2d04, content=DENY, timestamp=1641908843082, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:23.086  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=224ms, Total=268ms
2022-01-11 13:47:23.156  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8b655e40-0e0a-4153-8cac-f5541cd6546c, content=null, timestamp=1641908843140, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56066, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908843137, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=4DDC47B8DC49177FA4DE41545DDE93FB, http-session-last-accessed-time=1641908843137, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56066 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:23.162  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:23.176  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@406e74bc
2022-01-11 13:47:23.179  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@406e74bc
2022-01-11 13:47:23.218  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@406e74bc
2022-01-11 13:47:23.220  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@406e74bc
2022-01-11 13:47:23.257  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@406e74bc
2022-01-11 13:47:23.265  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:23.268  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:23.271  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@406e74bc
2022-01-11 13:47:23.274  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@406e74bc
2022-01-11 13:47:23.278  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:23.281  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:23.284  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@406e74bc
2022-01-11 13:47:23.362  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@406e74bc
2022-01-11 13:47:23.366  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@406e74bc
2022-01-11 13:47:23.441  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8026390994175-551389, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:23.445  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8b655e40-0e0a-4153-8cac-f5541cd6546c, content=DENY, timestamp=1641908843445, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:23.451  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=280ms, Total=298ms
2022-01-11 13:47:23.546  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4c429cea-3983-4870-8281-8aa4ccde3ce4, content=null, timestamp=1641908843525, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56068, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908843514, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=067BE1BF2DEDFE99A8FD69CFB10D5D5C, http-session-last-accessed-time=1641908843514, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56068 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:23.556  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:23.560  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@37262dd2
2022-01-11 13:47:23.563  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@37262dd2
2022-01-11 13:47:23.587  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@37262dd2
2022-01-11 13:47:23.591  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@37262dd2
2022-01-11 13:47:23.619  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@37262dd2
2022-01-11 13:47:23.627  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:23.629  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:23.631  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@37262dd2
2022-01-11 13:47:23.634  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@37262dd2
2022-01-11 13:47:23.636  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:23.647  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:23.649  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@37262dd2
2022-01-11 13:47:23.677  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@37262dd2
2022-01-11 13:47:23.680  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@37262dd2
2022-01-11 13:47:23.749  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8026783735475-244428, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:23.752  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4c429cea-3983-4870-8281-8aa4ccde3ce4, content=DENY, timestamp=1641908843752, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:23.762  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=194ms, Total=217ms
2022-01-11 13:47:23.842  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=17200a9d-8bb7-43f0-bb50-8b10ce62a506, content=null, timestamp=1641908843826, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56070, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908843824, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=0FF6E2F5904A92DB600DEA6B34A6BAFD, http-session-last-accessed-time=1641908843824, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56070 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:23.855  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:23.862  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7abd91ea
2022-01-11 13:47:23.872  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7abd91ea
2022-01-11 13:47:23.908  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7abd91ea
2022-01-11 13:47:23.918  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7abd91ea
2022-01-11 13:47:23.943  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7abd91ea
2022-01-11 13:47:23.947  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:23.951  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:23.955  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7abd91ea
2022-01-11 13:47:23.969  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7abd91ea
2022-01-11 13:47:23.974  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:23.978  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:23.983  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7abd91ea
2022-01-11 13:47:24.015  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7abd91ea
2022-01-11 13:47:24.021  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7abd91ea
2022-01-11 13:47:24.055  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8027082473375-200241, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:24.065  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=17200a9d-8bb7-43f0-bb50-8b10ce62a506, content=DENY, timestamp=1641908844065, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:24.072  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=208ms, Total=233ms
2022-01-11 13:47:24.147  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=254727ba-ee54-49ff-b47e-6fa5babbd722, content=null, timestamp=1641908844131, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56072, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908844118, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=F58F325DFC83700CEA03089CFEDE814E, http-session-last-accessed-time=1641908844118, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56072 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:24.153  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:24.167  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca98202
2022-01-11 13:47:24.170  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca98202
2022-01-11 13:47:24.204  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca98202
2022-01-11 13:47:24.209  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca98202
2022-01-11 13:47:24.272  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca98202
2022-01-11 13:47:24.275  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:24.279  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:24.282  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca98202
2022-01-11 13:47:24.285  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca98202
2022-01-11 13:47:24.287  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:24.290  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:24.294  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca98202
2022-01-11 13:47:24.331  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca98202
2022-01-11 13:47:24.336  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca98202
2022-01-11 13:47:24.365  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8027382978075-384890, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:24.369  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=254727ba-ee54-49ff-b47e-6fa5babbd722, content=DENY, timestamp=1641908844369, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:24.374  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=212ms, Total=229ms
2022-01-11 13:47:24.432  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=40fdb7eb-a140-4807-bfc9-144a1b63a46a, content=null, timestamp=1641908844425, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56074, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908844411, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=5452B6E04DD5E7529DA831CC64A0FE0D, http-session-last-accessed-time=1641908844411, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56074 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:24.439  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:24.442  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ed48c17
2022-01-11 13:47:24.445  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ed48c17
2022-01-11 13:47:24.465  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ed48c17
2022-01-11 13:47:24.468  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ed48c17
2022-01-11 13:47:24.531  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ed48c17
2022-01-11 13:47:24.534  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:24.536  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:24.538  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ed48c17
2022-01-11 13:47:24.548  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ed48c17
2022-01-11 13:47:24.552  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:24.557  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:24.562  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ed48c17
2022-01-11 13:47:24.611  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ed48c17
2022-01-11 13:47:24.613  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ed48c17
2022-01-11 13:47:24.654  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8027666022675-549153, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:24.657  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=40fdb7eb-a140-4807-bfc9-144a1b63a46a, content=DENY, timestamp=1641908844657, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:24.662  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=217ms, Total=232ms
2022-01-11 13:47:24.762  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4dd3a174-34b1-4ca9-85b4-4662cba00838, content=null, timestamp=1641908844743, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56076, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908844734, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=E47AF51192B5355DEC0B93C1708F563C, http-session-last-accessed-time=1641908844734, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56076 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:24.766  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:24.774  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a47929c
2022-01-11 13:47:24.779  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a47929c
2022-01-11 13:47:24.818  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a47929c
2022-01-11 13:47:24.828  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a47929c
2022-01-11 13:47:24.909  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a47929c
2022-01-11 13:47:24.912  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:24.917  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:24.922  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a47929c
2022-01-11 13:47:24.924  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a47929c
2022-01-11 13:47:24.927  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:24.929  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:24.932  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a47929c
2022-01-11 13:47:24.971  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a47929c
2022-01-11 13:47:24.974  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a47929c
2022-01-11 13:47:25.003  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8027995825875-223414, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:25.007  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4dd3a174-34b1-4ca9-85b4-4662cba00838, content=DENY, timestamp=1641908845007, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:25.011  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=236ms, Total=251ms
2022-01-11 13:47:25.126  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3d1e5952-26c4-43f0-a46b-17693f3038e9, content=null, timestamp=1641908845112, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56078, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908845094, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=5513815D5A112CA57F9BB923C4B1E45C, http-session-last-accessed-time=1641908845094, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56078 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:25.131  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:25.136  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@251ee8d4
2022-01-11 13:47:25.140  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@251ee8d4
2022-01-11 13:47:25.180  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@251ee8d4
2022-01-11 13:47:25.184  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@251ee8d4
2022-01-11 13:47:25.249  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@251ee8d4
2022-01-11 13:47:25.253  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:25.255  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:25.258  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@251ee8d4
2022-01-11 13:47:25.262  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@251ee8d4
2022-01-11 13:47:25.267  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:25.273  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:25.278  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@251ee8d4
2022-01-11 13:47:25.318  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@251ee8d4
2022-01-11 13:47:25.328  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@251ee8d4
2022-01-11 13:47:25.364  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8028359484975-672948, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:25.372  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3d1e5952-26c4-43f0-a46b-17693f3038e9, content=DENY, timestamp=1641908845371, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:25.382  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=237ms, Total=259ms
2022-01-11 13:47:25.448  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b52c2e12-8b71-49ad-bfed-b6ced0a2822f, content=null, timestamp=1641908845433, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56080, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908845430, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=83798F3C0C7D6FFD5E4103D9FEEFF2E0, http-session-last-accessed-time=1641908845430, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56080 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:25.453  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:25.475  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d80b8af
2022-01-11 13:47:25.479  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d80b8af
2022-01-11 13:47:25.504  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d80b8af
2022-01-11 13:47:25.507  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d80b8af
2022-01-11 13:47:25.584  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d80b8af
2022-01-11 13:47:25.590  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:25.593  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:25.598  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d80b8af
2022-01-11 13:47:25.605  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d80b8af
2022-01-11 13:47:25.609  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:25.616  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:25.621  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d80b8af
2022-01-11 13:47:25.657  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d80b8af
2022-01-11 13:47:25.660  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d80b8af
2022-01-11 13:47:25.695  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8028684795175-304203, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:25.701  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b52c2e12-8b71-49ad-bfed-b6ced0a2822f, content=DENY, timestamp=1641908845701, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:25.708  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=243ms, Total=268ms
2022-01-11 13:47:25.760  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=58f0b4f5-9375-459a-b645-d5d440cebce9, content=null, timestamp=1641908845749, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56082, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908845744, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=0B470966991AE34FCFC836E449E73045, http-session-last-accessed-time=1641908845744, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56082 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:25.766  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:25.784  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e3aba13
2022-01-11 13:47:25.787  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e3aba13
2022-01-11 13:47:25.871  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e3aba13
2022-01-11 13:47:25.874  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e3aba13
2022-01-11 13:47:25.938  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e3aba13
2022-01-11 13:47:25.943  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:25.946  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:25.948  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e3aba13
2022-01-11 13:47:25.950  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e3aba13
2022-01-11 13:47:25.953  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:25.957  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:25.959  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e3aba13
2022-01-11 13:47:26.025  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e3aba13
2022-01-11 13:47:26.030  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e3aba13
2022-01-11 13:47:26.105  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8028995336275-96109, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:26.108  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=58f0b4f5-9375-459a-b645-d5d440cebce9, content=DENY, timestamp=1641908846108, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:26.114  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=338ms, Total=356ms
2022-01-11 13:47:26.170  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0525d307-2f04-4b3c-bf68-580a0a919e0e, content=null, timestamp=1641908846155, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56084, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908846153, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=DFEAFEA2DA87E172FEB6B39720A895DE, http-session-last-accessed-time=1641908846153, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56084 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:26.177  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:26.190  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@357f14b9
2022-01-11 13:47:26.196  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@357f14b9
2022-01-11 13:47:26.221  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@357f14b9
2022-01-11 13:47:26.224  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@357f14b9
2022-01-11 13:47:26.260  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@357f14b9
2022-01-11 13:47:26.265  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:26.269  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:26.272  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@357f14b9
2022-01-11 13:47:26.276  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@357f14b9
2022-01-11 13:47:26.280  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:26.286  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:26.289  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@357f14b9
2022-01-11 13:47:26.338  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@357f14b9
2022-01-11 13:47:26.341  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@357f14b9
2022-01-11 13:47:26.363  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8029406715175-906164, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:26.366  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0525d307-2f04-4b3c-bf68-580a0a919e0e, content=DENY, timestamp=1641908846366, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:26.370  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=185ms, Total=201ms
2022-01-11 13:47:26.438  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f558f71a-f4bf-4c8b-aae2-ca27a0f546bb, content=null, timestamp=1641908846411, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56086, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908846409, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=737B83D159713012FB986A143E1D08A8, http-session-last-accessed-time=1641908846409, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56086 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:26.443  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:26.453  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a6b2873
2022-01-11 13:47:26.457  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a6b2873
2022-01-11 13:47:26.488  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a6b2873
2022-01-11 13:47:26.492  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a6b2873
2022-01-11 13:47:26.563  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a6b2873
2022-01-11 13:47:26.566  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:26.567  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:26.572  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a6b2873
2022-01-11 13:47:26.579  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a6b2873
2022-01-11 13:47:26.583  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:26.586  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:26.590  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a6b2873
2022-01-11 13:47:26.619  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a6b2873
2022-01-11 13:47:26.623  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a6b2873
2022-01-11 13:47:26.677  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8029672777075-29042, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:26.680  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f558f71a-f4bf-4c8b-aae2-ca27a0f546bb, content=DENY, timestamp=1641908846680, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:26.684  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=233ms, Total=249ms
2022-01-11 13:47:26.743  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d4d0a869-4890-4d93-988d-df2038aba549, content=null, timestamp=1641908846730, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56088, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908846723, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=39463BC9A4EC2106FB30921785C38B8F, http-session-last-accessed-time=1641908846723, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56088 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:26.748  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:26.755  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@512d9886
2022-01-11 13:47:26.760  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@512d9886
2022-01-11 13:47:26.791  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@512d9886
2022-01-11 13:47:26.793  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@512d9886
2022-01-11 13:47:26.860  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@512d9886
2022-01-11 13:47:26.865  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:26.868  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:26.870  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@512d9886
2022-01-11 13:47:26.872  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@512d9886
2022-01-11 13:47:26.875  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:26.878  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:26.880  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@512d9886
2022-01-11 13:47:26.896  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@512d9886
2022-01-11 13:47:26.900  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@512d9886
2022-01-11 13:47:26.930  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8029976694875-970285, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:26.932  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d4d0a869-4890-4d93-988d-df2038aba549, content=DENY, timestamp=1641908846932, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:26.937  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=181ms, Total=196ms
2022-01-11 13:47:27.001  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=350aca24-b8cc-4883-86b8-c37d193dad6a, content=null, timestamp=1641908846992, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56090, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908846990, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=302AA3928C9A6F2B442CCC5FC5BBB0A0, http-session-last-accessed-time=1641908846990, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56090 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:27.009  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:27.015  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12aaf055
2022-01-11 13:47:27.027  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12aaf055
2022-01-11 13:47:27.089  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12aaf055
2022-01-11 13:47:27.099  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12aaf055
2022-01-11 13:47:27.198  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12aaf055
2022-01-11 13:47:27.202  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:27.205  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:27.207  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12aaf055
2022-01-11 13:47:27.209  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12aaf055
2022-01-11 13:47:27.211  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:27.214  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:27.216  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12aaf055
2022-01-11 13:47:27.248  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12aaf055
2022-01-11 13:47:27.253  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12aaf055
2022-01-11 13:47:27.302  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8030238994775-137512, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:27.307  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=350aca24-b8cc-4883-86b8-c37d193dad6a, content=DENY, timestamp=1641908847307, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:27.310  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=294ms, Total=311ms
2022-01-11 13:47:27.357  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=696f6adf-3339-4605-b9e1-b25f270f12fd, content=null, timestamp=1641908847349, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56092, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908847347, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=27356E52B0FF1273CF3B3605D870AFAC, http-session-last-accessed-time=1641908847347, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56092 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:27.362  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:27.377  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@791144e
2022-01-11 13:47:27.380  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@791144e
2022-01-11 13:47:27.408  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@791144e
2022-01-11 13:47:27.412  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@791144e
2022-01-11 13:47:27.492  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@791144e
2022-01-11 13:47:27.495  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:27.498  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:27.503  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@791144e
2022-01-11 13:47:27.508  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@791144e
2022-01-11 13:47:27.514  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:27.517  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:27.518  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@791144e
2022-01-11 13:47:27.559  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@791144e
2022-01-11 13:47:27.563  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@791144e
2022-01-11 13:47:27.599  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8030591235675-878712, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:27.608  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=696f6adf-3339-4605-b9e1-b25f270f12fd, content=DENY, timestamp=1641908847608, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:27.612  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=243ms, Total=257ms
2022-01-11 13:47:27.663  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8c87fe0a-fb17-49ee-9cdb-eca3b7cf6931, content=null, timestamp=1641908847654, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56094, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908847642, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=AC29087A253DD5FF67802AD914FC1226, http-session-last-accessed-time=1641908847642, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56094 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:27.670  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:27.684  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110239f4
2022-01-11 13:47:27.689  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110239f4
2022-01-11 13:47:27.730  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110239f4
2022-01-11 13:47:27.733  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110239f4
2022-01-11 13:47:27.823  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110239f4
2022-01-11 13:47:27.826  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:27.829  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:27.833  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110239f4
2022-01-11 13:47:27.836  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110239f4
2022-01-11 13:47:27.840  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:27.842  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:27.847  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110239f4
2022-01-11 13:47:27.870  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110239f4
2022-01-11 13:47:27.875  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110239f4
2022-01-11 13:47:27.907  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8030898926775-834890, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:27.912  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8c87fe0a-fb17-49ee-9cdb-eca3b7cf6931, content=DENY, timestamp=1641908847912, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:27.915  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=239ms, Total=254ms
2022-01-11 13:47:27.970  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=88f641f3-7f67-443c-b3cf-09e5a0c16adf, content=null, timestamp=1641908847957, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56096, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908847952, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=4C5DA87B0F9AB0568C00D520886E8CCC, http-session-last-accessed-time=1641908847952, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56096 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:27.976  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:27.988  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95538a5
2022-01-11 13:47:27.990  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95538a5
2022-01-11 13:47:28.019  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95538a5
2022-01-11 13:47:28.023  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95538a5
2022-01-11 13:47:28.100  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95538a5
2022-01-11 13:47:28.103  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:28.105  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:28.107  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95538a5
2022-01-11 13:47:28.112  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95538a5
2022-01-11 13:47:28.116  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:28.119  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:28.121  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95538a5
2022-01-11 13:47:28.153  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95538a5
2022-01-11 13:47:28.157  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95538a5
2022-01-11 13:47:28.185  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8031204845475-18066, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:28.189  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=88f641f3-7f67-443c-b3cf-09e5a0c16adf, content=DENY, timestamp=1641908848189, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:28.194  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=210ms, Total=226ms
2022-01-11 13:47:28.261  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3a8c1b4f-c3ee-40fc-bfb8-d1f7665e91c5, content=null, timestamp=1641908848240, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56098, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908848236, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=9D82519E5303D6E38722C41DAB09FE1E, http-session-last-accessed-time=1641908848236, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56098 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:28.269  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:28.283  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28707149
2022-01-11 13:47:28.293  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28707149
2022-01-11 13:47:28.348  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28707149
2022-01-11 13:47:28.354  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28707149
2022-01-11 13:47:28.442  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28707149
2022-01-11 13:47:28.454  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:28.458  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:28.462  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28707149
2022-01-11 13:47:28.465  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28707149
2022-01-11 13:47:28.467  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:28.469  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:28.472  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28707149
2022-01-11 13:47:28.521  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28707149
2022-01-11 13:47:28.524  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28707149
2022-01-11 13:47:28.573  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8031503518375-786296, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:28.576  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3a8c1b4f-c3ee-40fc-bfb8-d1f7665e91c5, content=DENY, timestamp=1641908848576, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:28.579  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=301ms, Total=319ms
2022-01-11 13:47:28.654  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4bf01b32-1ebc-4c0d-b94a-85a7a6fa4871, content=null, timestamp=1641908848629, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56100, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908848626, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=58E15C13998D01C32D90ABD6C26EF7BE, http-session-last-accessed-time=1641908848626, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56100 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:28.670  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:28.675  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35af9011
2022-01-11 13:47:28.679  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35af9011
2022-01-11 13:47:28.738  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35af9011
2022-01-11 13:47:28.744  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35af9011
2022-01-11 13:47:28.832  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35af9011
2022-01-11 13:47:28.835  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:28.837  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:28.840  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35af9011
2022-01-11 13:47:28.844  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35af9011
2022-01-11 13:47:28.847  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:28.849  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:28.851  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35af9011
2022-01-11 13:47:28.882  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35af9011
2022-01-11 13:47:28.886  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35af9011
2022-01-11 13:47:28.920  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8031898887675-16301, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:28.923  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4bf01b32-1ebc-4c0d-b94a-85a7a6fa4871, content=DENY, timestamp=1641908848923, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:28.931  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=250ms, Total=287ms
2022-01-11 13:47:28.975  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=76c8cbe5-940a-44fd-92fc-2c5c1fc51326, content=null, timestamp=1641908848966, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56102, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908848964, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=14DAB1EC5C9FC562F3DD882A3734B911, http-session-last-accessed-time=1641908848964, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56102 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:28.983  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:28.990  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@454d1b68
2022-01-11 13:47:28.994  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@454d1b68
2022-01-11 13:47:29.017  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@454d1b68
2022-01-11 13:47:29.020  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@454d1b68
2022-01-11 13:47:29.091  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@454d1b68
2022-01-11 13:47:29.093  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:29.096  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:29.100  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@454d1b68
2022-01-11 13:47:29.103  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@454d1b68
2022-01-11 13:47:29.105  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:29.108  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:29.111  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@454d1b68
2022-01-11 13:47:29.143  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@454d1b68
2022-01-11 13:47:29.146  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@454d1b68
2022-01-11 13:47:29.178  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8032211616675-120875, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:29.185  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=76c8cbe5-940a-44fd-92fc-2c5c1fc51326, content=DENY, timestamp=1641908849185, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:29.189  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=199ms, Total=216ms
2022-01-11 13:47:29.238  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a6d41eb7-e7b4-4bbd-bb89-68ae2098b404, content=null, timestamp=1641908849225, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56104, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908849219, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=2EA608AFDF0E0AD998C870B2E8DC2AFC, http-session-last-accessed-time=1641908849219, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56104 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:29.249  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:29.257  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13f27892
2022-01-11 13:47:29.260  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13f27892
2022-01-11 13:47:29.322  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13f27892
2022-01-11 13:47:29.325  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13f27892
2022-01-11 13:47:29.401  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13f27892
2022-01-11 13:47:29.404  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:29.408  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:29.413  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13f27892
2022-01-11 13:47:29.416  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13f27892
2022-01-11 13:47:29.419  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:29.421  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:29.424  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13f27892
2022-01-11 13:47:29.456  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13f27892
2022-01-11 13:47:29.462  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13f27892
2022-01-11 13:47:29.522  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8032478280275-591779, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:29.526  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a6d41eb7-e7b4-4bbd-bb89-68ae2098b404, content=DENY, timestamp=1641908849526, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:29.531  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=274ms, Total=300ms
2022-01-11 13:47:29.615  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f83697f4-2b6d-4951-bc3f-cf02e01bd6e1, content=null, timestamp=1641908849592, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56106, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908849590, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=E4F23DF788C59B29701D13BEE491EFC4, http-session-last-accessed-time=1641908849590, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56106 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:29.620  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:29.625  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1af54cb9
2022-01-11 13:47:29.628  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1af54cb9
2022-01-11 13:47:29.668  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1af54cb9
2022-01-11 13:47:29.671  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1af54cb9
2022-01-11 13:47:29.749  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1af54cb9
2022-01-11 13:47:29.751  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:29.754  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:29.755  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1af54cb9
2022-01-11 13:47:29.758  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1af54cb9
2022-01-11 13:47:29.771  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:29.775  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:29.778  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1af54cb9
2022-01-11 13:47:29.825  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1af54cb9
2022-01-11 13:47:29.828  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1af54cb9
2022-01-11 13:47:29.899  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8032847541775-408788, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:29.901  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f83697f4-2b6d-4951-bc3f-cf02e01bd6e1, content=DENY, timestamp=1641908849901, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:29.904  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=279ms, Total=296ms
2022-01-11 13:47:29.986  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3e5de3b0-7e06-4d77-b391-72f90307ba06, content=null, timestamp=1641908849970, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56108, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908849959, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=9335DF952232203917603181A210E6F8, http-session-last-accessed-time=1641908849959, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56108 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:29.991  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:30.006  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d8e0d05
2022-01-11 13:47:30.011  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d8e0d05
2022-01-11 13:47:30.043  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d8e0d05
2022-01-11 13:47:30.050  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d8e0d05
2022-01-11 13:47:30.120  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d8e0d05
2022-01-11 13:47:30.122  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:30.126  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:30.130  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d8e0d05
2022-01-11 13:47:30.133  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d8e0d05
2022-01-11 13:47:30.136  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:30.138  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:30.140  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d8e0d05
2022-01-11 13:47:30.175  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d8e0d05
2022-01-11 13:47:30.179  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d8e0d05
2022-01-11 13:47:30.207  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8033221016775-373499, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:30.211  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3e5de3b0-7e06-4d77-b391-72f90307ba06, content=DENY, timestamp=1641908850211, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:30.219  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=216ms, Total=234ms
2022-01-11 13:47:30.279  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=cde21330-eead-4591-823b-fe8904623f2e, content=null, timestamp=1641908850265, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56110, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908850262, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=19D20FAC929EE82EAD975FC8B923D843, http-session-last-accessed-time=1641908850262, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56110 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:30.283  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:30.306  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78bccf9d
2022-01-11 13:47:30.309  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78bccf9d
2022-01-11 13:47:30.335  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78bccf9d
2022-01-11 13:47:30.339  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78bccf9d
2022-01-11 13:47:30.427  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78bccf9d
2022-01-11 13:47:30.430  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:30.433  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:30.436  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78bccf9d
2022-01-11 13:47:30.438  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78bccf9d
2022-01-11 13:47:30.441  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:30.444  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:30.447  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78bccf9d
2022-01-11 13:47:30.488  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78bccf9d
2022-01-11 13:47:30.493  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78bccf9d
2022-01-11 13:47:30.533  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8033511019675-496799, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:30.536  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=cde21330-eead-4591-823b-fe8904623f2e, content=DENY, timestamp=1641908850536, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:30.542  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=251ms, Total=266ms
2022-01-11 13:47:30.623  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=95d1a2da-5511-40ff-943c-6668a81a9c16, content=null, timestamp=1641908850612, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56112, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908850600, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=8FCBFC67EDEC8CEEA6F4F57F137672E2, http-session-last-accessed-time=1641908850600, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56112 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:30.643  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:30.649  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@39b0a6a2
2022-01-11 13:47:30.654  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@39b0a6a2
2022-01-11 13:47:30.721  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@39b0a6a2
2022-01-11 13:47:30.725  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@39b0a6a2
2022-01-11 13:47:30.826  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@39b0a6a2
2022-01-11 13:47:30.829  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:30.833  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:30.836  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@39b0a6a2
2022-01-11 13:47:30.839  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@39b0a6a2
2022-01-11 13:47:30.842  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:30.846  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:30.848  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@39b0a6a2
2022-01-11 13:47:30.888  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@39b0a6a2
2022-01-11 13:47:30.891  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@39b0a6a2
2022-01-11 13:47:30.941  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8033872880075-324066, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:30.946  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=95d1a2da-5511-40ff-943c-6668a81a9c16, content=DENY, timestamp=1641908850945, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:30.953  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=298ms, Total=330ms
2022-01-11 13:47:31.017  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1e4ac450-aea5-417b-9e49-0d59e356f8d0, content=null, timestamp=1641908851005, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56114, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908850996, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=8F5F11E09686C2571C39C9AECD0A2A98, http-session-last-accessed-time=1641908850996, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56114 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:31.023  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:31.036  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@577b3c3f
2022-01-11 13:47:31.038  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@577b3c3f
2022-01-11 13:47:31.090  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@577b3c3f
2022-01-11 13:47:31.093  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@577b3c3f
2022-01-11 13:47:31.191  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@577b3c3f
2022-01-11 13:47:31.196  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:31.199  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:31.202  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@577b3c3f
2022-01-11 13:47:31.205  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@577b3c3f
2022-01-11 13:47:31.207  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:31.210  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:31.213  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@577b3c3f
2022-01-11 13:47:31.239  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@577b3c3f
2022-01-11 13:47:31.247  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@577b3c3f
2022-01-11 13:47:31.278  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8034258238375-862178, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:31.285  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1e4ac450-aea5-417b-9e49-0d59e356f8d0, content=DENY, timestamp=1641908851284, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:31.301  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=251ms, Total=287ms
2022-01-11 13:47:31.375  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ca974249-11fc-4a60-84a7-b4a90ee2b70a, content=null, timestamp=1641908851355, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56116, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908851350, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=4F31BA195D1E40724FC6239B84F2BB6A, http-session-last-accessed-time=1641908851350, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56116 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:31.385  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:31.400  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@367c5bcc
2022-01-11 13:47:31.403  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@367c5bcc
2022-01-11 13:47:31.447  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@367c5bcc
2022-01-11 13:47:31.450  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@367c5bcc
2022-01-11 13:47:31.518  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@367c5bcc
2022-01-11 13:47:31.520  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:31.522  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:31.525  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@367c5bcc
2022-01-11 13:47:31.528  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@367c5bcc
2022-01-11 13:47:31.530  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:31.537  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:31.541  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@367c5bcc
2022-01-11 13:47:31.568  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@367c5bcc
2022-01-11 13:47:31.573  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@367c5bcc
2022-01-11 13:47:31.607  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8034622036075-456541, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:31.609  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ca974249-11fc-4a60-84a7-b4a90ee2b70a, content=DENY, timestamp=1641908851609, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:31.614  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=213ms, Total=241ms
2022-01-11 13:47:31.671  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=164c888d-455a-433d-a0ef-eafc3ed1f0d7, content=null, timestamp=1641908851661, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56118, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908851659, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=88FE1C71ADD1559185181919A4A0A83E, http-session-last-accessed-time=1641908851659, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56118 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:31.686  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:31.701  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a760d0b
2022-01-11 13:47:31.706  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a760d0b
2022-01-11 13:47:31.732  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a760d0b
2022-01-11 13:47:31.737  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a760d0b
2022-01-11 13:47:31.829  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a760d0b
2022-01-11 13:47:31.832  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:31.833  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:31.838  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a760d0b
2022-01-11 13:47:31.843  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a760d0b
2022-01-11 13:47:31.850  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:31.855  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:31.857  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a760d0b
2022-01-11 13:47:31.896  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a760d0b
2022-01-11 13:47:31.899  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a760d0b
2022-01-11 13:47:31.935  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8034919349975-869046, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:31.940  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=164c888d-455a-433d-a0ef-eafc3ed1f0d7, content=DENY, timestamp=1641908851940, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:31.942  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=246ms, Total=273ms
2022-01-11 13:47:32.008  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f4cd1e08-2220-4c9a-9897-0ca3091c5050, content=null, timestamp=1641908852000, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56120, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908851990, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=99B13AE2126FB2A4DFA3AC9015F8D257, http-session-last-accessed-time=1641908851990, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56120 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:32.019  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:32.024  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c476d18
2022-01-11 13:47:32.027  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c476d18
2022-01-11 13:47:32.050  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c476d18
2022-01-11 13:47:32.054  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c476d18
2022-01-11 13:47:32.124  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c476d18
2022-01-11 13:47:32.130  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:32.133  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:32.136  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c476d18
2022-01-11 13:47:32.144  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c476d18
2022-01-11 13:47:32.145  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:32.147  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:32.150  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c476d18
2022-01-11 13:47:32.199  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c476d18
2022-01-11 13:47:32.202  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c476d18
2022-01-11 13:47:32.280  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8035247012575-20484, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:32.283  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f4cd1e08-2220-4c9a-9897-0ca3091c5050, content=DENY, timestamp=1641908852283, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:32.288  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=262ms, Total=282ms
2022-01-11 13:47:32.345  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9997a504-6953-49be-ba4d-6448e4243e73, content=null, timestamp=1641908852337, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56122, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908852336, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=0ADE628E181829931AA244ACA0700D6F, http-session-last-accessed-time=1641908852336, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56122 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:32.349  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:32.357  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f4a844b
2022-01-11 13:47:32.362  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f4a844b
2022-01-11 13:47:32.445  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f4a844b
2022-01-11 13:47:32.449  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f4a844b
2022-01-11 13:47:32.542  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f4a844b
2022-01-11 13:47:32.544  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:32.546  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:32.547  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f4a844b
2022-01-11 13:47:32.550  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f4a844b
2022-01-11 13:47:32.552  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:32.553  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:32.555  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f4a844b
2022-01-11 13:47:32.598  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f4a844b
2022-01-11 13:47:32.600  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f4a844b
2022-01-11 13:47:32.651  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8035576648775-652178, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:32.654  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9997a504-6953-49be-ba4d-6448e4243e73, content=DENY, timestamp=1641908852654, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:32.658  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=303ms, Total=315ms
2022-01-11 13:47:32.693  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c6128990-ea9f-4280-9e72-f890efec8df6, content=null, timestamp=1641908852671, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56124, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908852667, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=3D283400BFBD16923D342B8D7733B5BA, http-session-last-accessed-time=1641908852667, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56124 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:32.702  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:32.712  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bc6341
2022-01-11 13:47:32.717  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bc6341
2022-01-11 13:47:32.777  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bc6341
2022-01-11 13:47:32.787  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bc6341
2022-01-11 13:47:32.889  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bc6341
2022-01-11 13:47:32.897  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:32.899  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:32.908  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bc6341
2022-01-11 13:47:32.911  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bc6341
2022-01-11 13:47:32.914  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:32.917  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:32.921  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bc6341
2022-01-11 13:47:33.025  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bc6341
2022-01-11 13:47:33.053  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bc6341
2022-01-11 13:47:33.184  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8035963070475-832135, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:33.188  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c6128990-ea9f-4280-9e72-f890efec8df6, content=DENY, timestamp=1641908853188, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:33.191  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=483ms, Total=500ms
2022-01-11 13:47:33.272  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=256ecad1-8be1-4eda-803e-f40111ce95c3, content=null, timestamp=1641908853248, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56126, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908853244, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=F5814B31781E0EC26CA04211DFCFCA87, http-session-last-accessed-time=1641908853244, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56126 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:33.282  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:33.292  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@209786cf
2022-01-11 13:47:33.294  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@209786cf
2022-01-11 13:47:33.338  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@209786cf
2022-01-11 13:47:33.341  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@209786cf
2022-01-11 13:47:33.376  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@209786cf
2022-01-11 13:47:33.381  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:33.383  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:33.388  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@209786cf
2022-01-11 13:47:33.391  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@209786cf
2022-01-11 13:47:33.394  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:33.396  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:33.402  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@209786cf
2022-01-11 13:47:33.479  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@209786cf
2022-01-11 13:47:33.484  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@209786cf
2022-01-11 13:47:33.534  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8036542027475-846827, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:33.544  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=256ecad1-8be1-4eda-803e-f40111ce95c3, content=DENY, timestamp=1641908853544, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:33.547  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=260ms, Total=281ms
2022-01-11 13:47:33.622  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4a17c390-6ddd-4ff0-927f-a954635e8489, content=null, timestamp=1641908853595, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56128, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908853579, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=7F23F104789CE36088BF264EBC54A280, http-session-last-accessed-time=1641908853579, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56128 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:33.638  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:33.643  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f425caf
2022-01-11 13:47:33.652  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f425caf
2022-01-11 13:47:33.699  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f425caf
2022-01-11 13:47:33.708  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f425caf
2022-01-11 13:47:33.733  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f425caf
2022-01-11 13:47:33.736  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:33.738  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:33.742  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f425caf
2022-01-11 13:47:33.748  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f425caf
2022-01-11 13:47:33.751  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:33.755  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:33.759  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f425caf
2022-01-11 13:47:33.834  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f425caf
2022-01-11 13:47:33.837  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f425caf
2022-01-11 13:47:33.871  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8036898971175-732686, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:33.873  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4a17c390-6ddd-4ff0-927f-a954635e8489, content=DENY, timestamp=1641908853873, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:33.877  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=232ms, Total=258ms
2022-01-11 13:47:33.964  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e3e5ee19-cb8a-4d8f-9264-5ad1944fcfc6, content=null, timestamp=1641908853947, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56130, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908853937, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=A44DA110DAF5203EB5C7E01EF134270E, http-session-last-accessed-time=1641908853937, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56130 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:33.968  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:33.972  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ee7e816
2022-01-11 13:47:33.974  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ee7e816
2022-01-11 13:47:34.016  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ee7e816
2022-01-11 13:47:34.020  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ee7e816
2022-01-11 13:47:34.052  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ee7e816
2022-01-11 13:47:34.058  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:34.062  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:34.065  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ee7e816
2022-01-11 13:47:34.067  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ee7e816
2022-01-11 13:47:34.070  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:34.073  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:34.076  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ee7e816
2022-01-11 13:47:34.146  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ee7e816
2022-01-11 13:47:34.149  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ee7e816
2022-01-11 13:47:34.180  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8037227877075-893607, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:34.183  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e3e5ee19-cb8a-4d8f-9264-5ad1944fcfc6, content=DENY, timestamp=1641908854183, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:34.189  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=213ms, Total=226ms
2022-01-11 13:47:34.236  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8cabcf7a-294f-4213-acf4-e603d760937f, content=null, timestamp=1641908854230, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56132, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908854227, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=B0765172B4CF2673C0F686A24C37BF62, http-session-last-accessed-time=1641908854227, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56132 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:34.243  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:34.254  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e646b75
2022-01-11 13:47:34.257  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e646b75
2022-01-11 13:47:34.300  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e646b75
2022-01-11 13:47:34.304  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e646b75
2022-01-11 13:47:34.346  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e646b75
2022-01-11 13:47:34.350  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:34.354  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:34.356  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e646b75
2022-01-11 13:47:34.359  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e646b75
2022-01-11 13:47:34.361  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:34.363  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:34.367  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e646b75
2022-01-11 13:47:34.458  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e646b75
2022-01-11 13:47:34.461  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e646b75
2022-01-11 13:47:34.501  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8037505293175-524058, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:34.504  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8cabcf7a-294f-4213-acf4-e603d760937f, content=DENY, timestamp=1641908854504, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:34.515  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=257ms, Total=281ms
2022-01-11 13:47:34.569  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f1b6cb36-2682-471d-b073-66a7377f1fea, content=null, timestamp=1641908854554, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56134, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908854551, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=6A9F8C7457F27DBB52ACAFC78D89BE8F, http-session-last-accessed-time=1641908854551, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56134 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:34.577  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:34.591  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d72b25e
2022-01-11 13:47:34.596  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d72b25e
2022-01-11 13:47:34.634  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d72b25e
2022-01-11 13:47:34.637  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d72b25e
2022-01-11 13:47:34.667  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d72b25e
2022-01-11 13:47:34.673  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:34.677  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:34.683  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d72b25e
2022-01-11 13:47:34.688  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d72b25e
2022-01-11 13:47:34.692  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:34.697  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:34.702  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d72b25e
2022-01-11 13:47:34.746  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d72b25e
2022-01-11 13:47:34.750  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d72b25e
2022-01-11 13:47:34.820  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8037838874575-617187, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:34.825  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f1b6cb36-2682-471d-b073-66a7377f1fea, content=DENY, timestamp=1641908854825, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:34.830  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=244ms, Total=266ms
2022-01-11 13:47:34.904  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4fe40234-b888-446a-9f74-9bb7bd073866, content=null, timestamp=1641908854890, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56136, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908854885, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=958F5384143F6686B6E3B3B6BFAC1476, http-session-last-accessed-time=1641908854885, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56136 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:34.921  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:34.938  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@133f4f78
2022-01-11 13:47:34.940  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@133f4f78
2022-01-11 13:47:34.993  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@133f4f78
2022-01-11 13:47:34.999  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@133f4f78
2022-01-11 13:47:35.055  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@133f4f78
2022-01-11 13:47:35.059  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:35.063  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:35.069  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@133f4f78
2022-01-11 13:47:35.074  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@133f4f78
2022-01-11 13:47:35.078  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:35.082  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:35.086  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@133f4f78
2022-01-11 13:47:35.156  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@133f4f78
2022-01-11 13:47:35.159  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@133f4f78
2022-01-11 13:47:35.245  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8038184421175-103723, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:35.250  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4fe40234-b888-446a-9f74-9bb7bd073866, content=DENY, timestamp=1641908855250, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:35.257  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=323ms, Total=357ms
2022-01-11 13:47:35.317  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b80a5025-3507-4c1a-92af-04d3eccbeddc, content=null, timestamp=1641908855293, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56138, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908855289, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=C3BD0E9772B15BE271743C535C7D8FEA, http-session-last-accessed-time=1641908855289, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56138 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:35.330  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:35.340  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c559c5c
2022-01-11 13:47:35.345  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c559c5c
2022-01-11 13:47:35.389  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c559c5c
2022-01-11 13:47:35.393  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c559c5c
2022-01-11 13:47:35.428  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c559c5c
2022-01-11 13:47:35.435  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:35.438  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:35.442  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c559c5c
2022-01-11 13:47:35.446  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c559c5c
2022-01-11 13:47:35.451  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:35.454  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:35.456  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c559c5c
2022-01-11 13:47:35.505  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c559c5c
2022-01-11 13:47:35.509  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c559c5c
2022-01-11 13:47:35.598  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8038590391375-477127, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:35.601  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b80a5025-3507-4c1a-92af-04d3eccbeddc, content=DENY, timestamp=1641908855601, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:35.609  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=269ms, Total=293ms
2022-01-11 13:47:35.682  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=df282da5-111b-4374-853f-78f84aaa649c, content=null, timestamp=1641908855669, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56140, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908855649, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=F67B300F02EB665D8CC3AA64933AFA9E, http-session-last-accessed-time=1641908855649, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56140 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:35.689  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:35.706  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74a03119
2022-01-11 13:47:35.710  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74a03119
2022-01-11 13:47:35.757  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74a03119
2022-01-11 13:47:35.762  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74a03119
2022-01-11 13:47:35.799  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74a03119
2022-01-11 13:47:35.802  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:35.808  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:35.815  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74a03119
2022-01-11 13:47:35.823  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74a03119
2022-01-11 13:47:35.830  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:35.833  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:35.834  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74a03119
2022-01-11 13:47:35.866  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74a03119
2022-01-11 13:47:35.868  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74a03119
2022-01-11 13:47:35.929  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8038953462275-802200, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:35.931  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=df282da5-111b-4374-853f-78f84aaa649c, content=DENY, timestamp=1641908855931, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:35.934  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=238ms, Total=257ms
2022-01-11 13:47:35.975  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=50aa51ff-04cc-4300-9ce9-c61f4b0e4af3, content=null, timestamp=1641908855966, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56142, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908855963, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=343AB6AF66C0504729BCB25E070A0FEE, http-session-last-accessed-time=1641908855963, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56142 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:35.980  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:35.986  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6440a0ba
2022-01-11 13:47:35.989  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6440a0ba
2022-01-11 13:47:36.025  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6440a0ba
2022-01-11 13:47:36.030  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6440a0ba
2022-01-11 13:47:36.064  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6440a0ba
2022-01-11 13:47:36.067  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:36.070  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:36.072  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6440a0ba
2022-01-11 13:47:36.075  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6440a0ba
2022-01-11 13:47:36.078  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:36.081  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:36.084  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6440a0ba
2022-01-11 13:47:36.154  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6440a0ba
2022-01-11 13:47:36.158  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6440a0ba
2022-01-11 13:47:36.206  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8039241393075-667121, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:36.209  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=50aa51ff-04cc-4300-9ce9-c61f4b0e4af3, content=DENY, timestamp=1641908856209, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:36.218  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=226ms, Total=245ms
2022-01-11 13:47:36.286  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ee603974-f4df-40d8-a849-a8da7dd5046e, content=null, timestamp=1641908856264, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56144, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908856255, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=C8F46BD9ABF1ADD2BF7075A035EB8826, http-session-last-accessed-time=1641908856255, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56144 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:36.295  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:36.332  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f740b75
2022-01-11 13:47:36.338  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f740b75
2022-01-11 13:47:36.384  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f740b75
2022-01-11 13:47:36.388  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f740b75
2022-01-11 13:47:36.453  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f740b75
2022-01-11 13:47:36.456  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:36.458  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:36.462  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f740b75
2022-01-11 13:47:36.466  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f740b75
2022-01-11 13:47:36.470  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:36.473  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:36.477  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f740b75
2022-01-11 13:47:36.549  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f740b75
2022-01-11 13:47:36.553  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f740b75
2022-01-11 13:47:36.592  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8039577289175-225367, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:36.597  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ee603974-f4df-40d8-a849-a8da7dd5046e, content=DENY, timestamp=1641908856597, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:36.606  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=278ms, Total=322ms
2022-01-11 13:47:36.714  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9aee7f9c-13d0-48d7-96d2-26d5fbb49e88, content=null, timestamp=1641908856688, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56146, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908856685, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=39FAB050316CBB5B7F1D3FCA91F325B2, http-session-last-accessed-time=1641908856685, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56146 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:36.723  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:36.742  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@115a30b7
2022-01-11 13:47:36.755  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@115a30b7
2022-01-11 13:47:36.782  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@115a30b7
2022-01-11 13:47:36.785  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@115a30b7
2022-01-11 13:47:36.816  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@115a30b7
2022-01-11 13:47:36.819  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:36.821  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:36.823  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@115a30b7
2022-01-11 13:47:36.826  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@115a30b7
2022-01-11 13:47:36.829  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:36.832  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:36.833  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@115a30b7
2022-01-11 13:47:36.906  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@115a30b7
2022-01-11 13:47:36.914  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@115a30b7
2022-01-11 13:47:36.944  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8039986047575-772118, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:36.950  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9aee7f9c-13d0-48d7-96d2-26d5fbb49e88, content=DENY, timestamp=1641908856950, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:36.953  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=221ms, Total=249ms
2022-01-11 13:47:37.033  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9e13b71a-0eb1-48fd-87c4-a783ddcd1c63, content=null, timestamp=1641908857002, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56148, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908856996, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=DCDEFCE7D38D2F77603C53B2607FF764, http-session-last-accessed-time=1641908856996, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56148 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:37.038  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:37.051  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3af1a057
2022-01-11 13:47:37.055  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3af1a057
2022-01-11 13:47:37.077  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3af1a057
2022-01-11 13:47:37.082  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3af1a057
2022-01-11 13:47:37.115  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3af1a057
2022-01-11 13:47:37.118  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:37.120  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:37.124  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3af1a057
2022-01-11 13:47:37.131  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3af1a057
2022-01-11 13:47:37.134  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:37.138  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:37.142  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3af1a057
2022-01-11 13:47:37.205  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3af1a057
2022-01-11 13:47:37.210  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3af1a057
2022-01-11 13:47:37.248  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8040298783675-778245, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:37.254  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9e13b71a-0eb1-48fd-87c4-a783ddcd1c63, content=DENY, timestamp=1641908857254, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:37.261  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=213ms, Total=240ms
2022-01-11 13:47:37.325  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ce867309-d75f-42ec-a50c-d8dc0aa64d92, content=null, timestamp=1641908857317, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56150, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908857304, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=D8C5EA66B73D1088EA49DB0D83003BE3, http-session-last-accessed-time=1641908857304, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56150 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:37.330  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:37.337  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@563ff91c
2022-01-11 13:47:37.342  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@563ff91c
2022-01-11 13:47:37.376  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@563ff91c
2022-01-11 13:47:37.379  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@563ff91c
2022-01-11 13:47:37.405  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@563ff91c
2022-01-11 13:47:37.408  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:37.414  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:37.420  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@563ff91c
2022-01-11 13:47:37.426  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@563ff91c
2022-01-11 13:47:37.430  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:37.432  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:37.435  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@563ff91c
2022-01-11 13:47:37.499  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@563ff91c
2022-01-11 13:47:37.502  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@563ff91c
2022-01-11 13:47:37.530  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8040590526875-235982, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:37.533  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ce867309-d75f-42ec-a50c-d8dc0aa64d92, content=DENY, timestamp=1641908857533, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:37.537  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=200ms, Total=213ms
2022-01-11 13:47:37.581  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b1d64e3a-5c7c-4a3a-b712-bbea1ed0a144, content=null, timestamp=1641908857575, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56152, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908857573, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=E6C4BC6FA5E26753C5025D5C33CD1B9D, http-session-last-accessed-time=1641908857573, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56152 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:37.585  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:37.589  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b30a894
2022-01-11 13:47:37.593  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b30a894
2022-01-11 13:47:37.624  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b30a894
2022-01-11 13:47:37.626  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b30a894
2022-01-11 13:47:37.664  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b30a894
2022-01-11 13:47:37.667  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:37.671  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:37.673  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b30a894
2022-01-11 13:47:37.676  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b30a894
2022-01-11 13:47:37.678  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:37.680  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:37.682  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b30a894
2022-01-11 13:47:37.768  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b30a894
2022-01-11 13:47:37.771  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b30a894
2022-01-11 13:47:37.817  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8040844890375-760048, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:37.821  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b1d64e3a-5c7c-4a3a-b712-bbea1ed0a144, content=DENY, timestamp=1641908857821, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:37.824  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=234ms, Total=245ms
2022-01-11 13:47:37.874  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=088f4397-9f8f-4d6a-ae57-ce420732b6b9, content=null, timestamp=1641908857862, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56154, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908857854, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=511C452CAEF8E65C3702B475EF37F22F, http-session-last-accessed-time=1641908857854, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56154 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:37.880  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:37.894  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c292f0
2022-01-11 13:47:37.901  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c292f0
2022-01-11 13:47:37.940  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c292f0
2022-01-11 13:47:37.947  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c292f0
2022-01-11 13:47:37.982  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c292f0
2022-01-11 13:47:37.985  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:37.991  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:37.995  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c292f0
2022-01-11 13:47:37.999  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c292f0
2022-01-11 13:47:38.004  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:38.006  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:38.010  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c292f0
2022-01-11 13:47:38.080  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c292f0
2022-01-11 13:47:38.083  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c292f0
2022-01-11 13:47:38.116  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8041142650175-528684, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:38.119  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=088f4397-9f8f-4d6a-ae57-ce420732b6b9, content=DENY, timestamp=1641908858119, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:38.129  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=235ms, Total=258ms
2022-01-11 13:47:38.189  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b397511d-68ab-4b78-a117-f6577b77db69, content=null, timestamp=1641908858182, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56156, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908858180, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=A56A97236E00016E9297E6AB1D29A093, http-session-last-accessed-time=1641908858180, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56156 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:38.198  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:38.202  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd39b98
2022-01-11 13:47:38.205  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd39b98
2022-01-11 13:47:38.225  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd39b98
2022-01-11 13:47:38.229  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd39b98
2022-01-11 13:47:38.271  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd39b98
2022-01-11 13:47:38.276  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:38.279  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:38.282  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd39b98
2022-01-11 13:47:38.284  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd39b98
2022-01-11 13:47:38.287  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:38.289  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:38.292  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd39b98
2022-01-11 13:47:38.361  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd39b98
2022-01-11 13:47:38.363  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd39b98
2022-01-11 13:47:38.393  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8041458313875-688058, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:38.397  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b397511d-68ab-4b78-a117-f6577b77db69, content=DENY, timestamp=1641908858397, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:38.400  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=197ms, Total=213ms
2022-01-11 13:47:38.464  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5d68bae7-7fb4-4927-a440-1d94be46920a, content=null, timestamp=1641908858454, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56158, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908858453, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=4CEAB60D4FDB73E6D12DC807ADADEB5C, http-session-last-accessed-time=1641908858453, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56158 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:38.469  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:38.476  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3685ee27
2022-01-11 13:47:38.478  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3685ee27
2022-01-11 13:47:38.499  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3685ee27
2022-01-11 13:47:38.501  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3685ee27
2022-01-11 13:47:38.543  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3685ee27
2022-01-11 13:47:38.546  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:38.548  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:38.550  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3685ee27
2022-01-11 13:47:38.552  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3685ee27
2022-01-11 13:47:38.555  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:38.557  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:38.559  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3685ee27
2022-01-11 13:47:38.625  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3685ee27
2022-01-11 13:47:38.630  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3685ee27
2022-01-11 13:47:38.659  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8041730745175-792548, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:38.662  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5d68bae7-7fb4-4927-a440-1d94be46920a, content=DENY, timestamp=1641908858662, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:38.664  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=189ms, Total=204ms
2022-01-11 13:47:38.713  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=128fae76-72f8-4d48-a230-d2aa1cd183bb, content=null, timestamp=1641908858702, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56160, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908858700, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=49C953C12AF3D4A8B984989645719602, http-session-last-accessed-time=1641908858700, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56160 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:38.718  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:38.724  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@177a347d
2022-01-11 13:47:38.726  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@177a347d
2022-01-11 13:47:38.758  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@177a347d
2022-01-11 13:47:38.760  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@177a347d
2022-01-11 13:47:38.795  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@177a347d
2022-01-11 13:47:38.797  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:38.799  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:38.801  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@177a347d
2022-01-11 13:47:38.807  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@177a347d
2022-01-11 13:47:38.810  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:38.815  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:38.820  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@177a347d
2022-01-11 13:47:38.913  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@177a347d
2022-01-11 13:47:38.915  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@177a347d
2022-01-11 13:47:38.981  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8041978541475-748944, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:38.983  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=128fae76-72f8-4d48-a230-d2aa1cd183bb, content=DENY, timestamp=1641908858983, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:38.996  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=262ms, Total=285ms
2022-01-11 13:47:39.085  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=66e500d5-2be6-4730-ac80-6d04175b42b4, content=null, timestamp=1641908859057, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56162, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908859045, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=2845485BF05743C2A98F3F3951BE47C8, http-session-last-accessed-time=1641908859045, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56162 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:39.091  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:39.106  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ce0bd79
2022-01-11 13:47:39.121  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ce0bd79
2022-01-11 13:47:39.149  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ce0bd79
2022-01-11 13:47:39.151  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ce0bd79
2022-01-11 13:47:39.197  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ce0bd79
2022-01-11 13:47:39.201  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:39.202  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:39.205  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ce0bd79
2022-01-11 13:47:39.208  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ce0bd79
2022-01-11 13:47:39.210  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:39.213  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:39.215  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ce0bd79
2022-01-11 13:47:39.299  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ce0bd79
2022-01-11 13:47:39.302  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ce0bd79
2022-01-11 13:47:39.330  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8042355628475-381039, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:39.331  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=66e500d5-2be6-4730-ac80-6d04175b42b4, content=DENY, timestamp=1641908859331, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:39.334  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=233ms, Total=257ms
2022-01-11 13:47:39.378  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f1165eee-e7d5-45b1-abd3-306473b5d4af, content=null, timestamp=1641908859372, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56164, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908859366, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=2BD64E4403650FA2891B2487F881E1AA, http-session-last-accessed-time=1641908859366, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56164 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:39.383  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:39.387  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28396a3c
2022-01-11 13:47:39.389  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28396a3c
2022-01-11 13:47:39.431  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28396a3c
2022-01-11 13:47:39.434  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28396a3c
2022-01-11 13:47:39.506  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28396a3c
2022-01-11 13:47:39.511  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:39.512  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:39.516  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28396a3c
2022-01-11 13:47:39.518  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28396a3c
2022-01-11 13:47:39.520  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:39.523  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:39.526  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28396a3c
2022-01-11 13:47:39.559  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28396a3c
2022-01-11 13:47:39.562  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28396a3c
2022-01-11 13:47:39.592  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8042642842775-862856, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:39.595  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f1165eee-e7d5-45b1-abd3-306473b5d4af, content=DENY, timestamp=1641908859595, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:39.602  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=210ms, Total=225ms
2022-01-11 13:47:39.643  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7802dede-fbfc-4564-bdb0-f3ff5ad00c36, content=null, timestamp=1641908859636, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56166, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908859634, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=F89DE33C02DA50DEF7F4D77147EA7DEB, http-session-last-accessed-time=1641908859634, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56166 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:39.656  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:39.667  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f6e0add
2022-01-11 13:47:39.671  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f6e0add
2022-01-11 13:47:39.734  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f6e0add
2022-01-11 13:47:39.738  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f6e0add
2022-01-11 13:47:39.765  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f6e0add
2022-01-11 13:47:39.768  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:39.773  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:39.776  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f6e0add
2022-01-11 13:47:39.780  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f6e0add
2022-01-11 13:47:39.785  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:39.789  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:39.795  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f6e0add
2022-01-11 13:47:39.822  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f6e0add
2022-01-11 13:47:39.824  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f6e0add
2022-01-11 13:47:39.897  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8042917677875-148453, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:39.904  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7802dede-fbfc-4564-bdb0-f3ff5ad00c36, content=DENY, timestamp=1641908859904, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:39.906  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=244ms, Total=264ms
2022-01-11 13:47:39.965  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ec621eb8-78ee-490d-93bd-500378c05559, content=null, timestamp=1641908859956, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56168, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908859950, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=83D9D69CCBD0597100F922B59FC8B1EB, http-session-last-accessed-time=1641908859950, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56168 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:39.969  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:39.982  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f5ebf62
2022-01-11 13:47:39.987  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f5ebf62
2022-01-11 13:47:40.019  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f5ebf62
2022-01-11 13:47:40.022  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f5ebf62
2022-01-11 13:47:40.049  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f5ebf62
2022-01-11 13:47:40.051  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:40.052  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:40.054  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f5ebf62
2022-01-11 13:47:40.057  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f5ebf62
2022-01-11 13:47:40.059  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:40.061  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:40.063  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f5ebf62
2022-01-11 13:47:40.112  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f5ebf62
2022-01-11 13:47:40.113  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f5ebf62
2022-01-11 13:47:40.199  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8043230907875-352970, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:40.202  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ec621eb8-78ee-490d-93bd-500378c05559, content=DENY, timestamp=1641908860202, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:40.204  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=229ms, Total=241ms
2022-01-11 13:47:40.263  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1b007fa1-e835-45b9-b5ad-6e3184673257, content=null, timestamp=1641908860243, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56170, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908860240, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=4E462D8E29C769A0A1C6EEC5689EF39C, http-session-last-accessed-time=1641908860240, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56170 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:40.274  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:40.285  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c837d5e
2022-01-11 13:47:40.311  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c837d5e
2022-01-11 13:47:40.350  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c837d5e
2022-01-11 13:47:40.358  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c837d5e
2022-01-11 13:47:40.389  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c837d5e
2022-01-11 13:47:40.391  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:40.396  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:40.401  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c837d5e
2022-01-11 13:47:40.411  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c837d5e
2022-01-11 13:47:40.417  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:40.421  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:40.427  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c837d5e
2022-01-11 13:47:40.458  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c837d5e
2022-01-11 13:47:40.463  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c837d5e
2022-01-11 13:47:40.493  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8043536637775-500045, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:40.495  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1b007fa1-e835-45b9-b5ad-6e3184673257, content=DENY, timestamp=1641908860495, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:40.499  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=216ms, Total=240ms
2022-01-11 13:47:40.553  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=88854b0a-6303-45b1-b731-4efcea2ac19f, content=null, timestamp=1641908860540, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56172, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908860533, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=EAC3411DA0267CA0E81E51EEBA399402, http-session-last-accessed-time=1641908860533, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56172 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:40.560  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:40.579  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693b51a1
2022-01-11 13:47:40.586  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693b51a1
2022-01-11 13:47:40.622  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693b51a1
2022-01-11 13:47:40.625  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693b51a1
2022-01-11 13:47:40.695  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693b51a1
2022-01-11 13:47:40.698  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:40.703  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:40.708  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693b51a1
2022-01-11 13:47:40.712  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693b51a1
2022-01-11 13:47:40.719  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:40.722  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:40.726  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693b51a1
2022-01-11 13:47:40.750  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693b51a1
2022-01-11 13:47:40.755  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693b51a1
2022-01-11 13:47:40.792  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8043825439075-169597, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:40.795  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=88854b0a-6303-45b1-b731-4efcea2ac19f, content=DENY, timestamp=1641908860795, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:40.800  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=228ms, Total=249ms
2022-01-11 13:47:40.849  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b1c28120-5bb0-4cf5-ae9f-9f28522b5633, content=null, timestamp=1641908860839, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56174, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908860836, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=4B088289153751453015F3BF3911B769, http-session-last-accessed-time=1641908860836, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56174 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:40.853  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:40.857  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f637b5
2022-01-11 13:47:40.860  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f637b5
2022-01-11 13:47:40.885  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f637b5
2022-01-11 13:47:40.889  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f637b5
2022-01-11 13:47:40.972  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f637b5
2022-01-11 13:47:40.976  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:40.980  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:40.985  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f637b5
2022-01-11 13:47:40.989  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f637b5
2022-01-11 13:47:40.993  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:40.999  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:41.007  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f637b5
2022-01-11 13:47:41.045  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f637b5
2022-01-11 13:47:41.047  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f637b5
2022-01-11 13:47:41.070  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8044113296375-43354, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:41.072  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b1c28120-5bb0-4cf5-ae9f-9f28522b5633, content=DENY, timestamp=1641908861072, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:41.076  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=216ms, Total=228ms
2022-01-11 13:47:41.135  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=60255001-e140-4939-9f38-c1be11ce0927, content=null, timestamp=1641908861118, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56176, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908861115, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=07BC59B8A774ABAD01CF23E96760BD93, http-session-last-accessed-time=1641908861115, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56176 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:41.139  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:41.153  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f83caa
2022-01-11 13:47:41.157  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f83caa
2022-01-11 13:47:41.177  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f83caa
2022-01-11 13:47:41.182  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f83caa
2022-01-11 13:47:41.250  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f83caa
2022-01-11 13:47:41.252  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:41.255  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:41.259  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f83caa
2022-01-11 13:47:41.262  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f83caa
2022-01-11 13:47:41.264  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:41.268  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:41.271  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f83caa
2022-01-11 13:47:41.295  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f83caa
2022-01-11 13:47:41.299  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f83caa
2022-01-11 13:47:41.340  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8044402994475-754819, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:41.343  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=60255001-e140-4939-9f38-c1be11ce0927, content=DENY, timestamp=1641908861343, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:41.357  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=198ms, Total=230ms
2022-01-11 13:47:41.452  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=74bf1e17-405d-4215-a8a8-afe8d032b249, content=null, timestamp=1641908861417, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56178, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908861399, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=7B95C944EFCC145BC839F7BCEA0A9C3E, http-session-last-accessed-time=1641908861399, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56178 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:41.462  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:41.477  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@557fafee
2022-01-11 13:47:41.492  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@557fafee
2022-01-11 13:47:41.587  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@557fafee
2022-01-11 13:47:41.589  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@557fafee
2022-01-11 13:47:41.684  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@557fafee
2022-01-11 13:47:41.687  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:41.690  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:41.692  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@557fafee
2022-01-11 13:47:41.694  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@557fafee
2022-01-11 13:47:41.697  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:41.699  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:41.701  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@557fafee
2022-01-11 13:47:41.718  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@557fafee
2022-01-11 13:47:41.722  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@557fafee
2022-01-11 13:47:41.747  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8044731227275-494405, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:41.750  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=74bf1e17-405d-4215-a8a8-afe8d032b249, content=DENY, timestamp=1641908861750, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:41.753  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=277ms, Total=301ms
2022-01-11 13:47:41.794  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b38af668-5317-4c51-9292-47bf44acbcbe, content=null, timestamp=1641908861784, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56180, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908861780, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=B5731C4B34BC9CB8E62F6C0026BE7F66, http-session-last-accessed-time=1641908861780, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56180 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:41.799  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:41.817  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@413abd22
2022-01-11 13:47:41.830  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@413abd22
2022-01-11 13:47:41.861  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@413abd22
2022-01-11 13:47:41.864  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@413abd22
2022-01-11 13:47:41.940  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@413abd22
2022-01-11 13:47:41.942  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:41.944  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:41.946  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@413abd22
2022-01-11 13:47:41.948  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@413abd22
2022-01-11 13:47:41.950  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:41.953  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:41.955  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@413abd22
2022-01-11 13:47:41.977  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@413abd22
2022-01-11 13:47:41.983  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@413abd22
2022-01-11 13:47:42.010  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8045064037375-135596, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:42.015  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b38af668-5317-4c51-9292-47bf44acbcbe, content=DENY, timestamp=1641908862015, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:42.018  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=209ms, Total=227ms
2022-01-11 13:47:42.072  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=16cc847e-8255-43a5-819a-d5cde0639802, content=null, timestamp=1641908862054, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56182, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908862050, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=F5A47E77A14ED78D0484960F773FFE77, http-session-last-accessed-time=1641908862050, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56182 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:42.076  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:42.092  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19888628
2022-01-11 13:47:42.095  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19888628
2022-01-11 13:47:42.123  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19888628
2022-01-11 13:47:42.126  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19888628
2022-01-11 13:47:42.192  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19888628
2022-01-11 13:47:42.194  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:42.197  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:42.200  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19888628
2022-01-11 13:47:42.202  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19888628
2022-01-11 13:47:42.206  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:42.212  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:42.215  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19888628
2022-01-11 13:47:42.249  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19888628
2022-01-11 13:47:42.253  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19888628
2022-01-11 13:47:42.281  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8045337269675-167067, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:42.283  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=16cc847e-8255-43a5-819a-d5cde0639802, content=DENY, timestamp=1641908862283, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:42.286  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=204ms, Total=220ms
2022-01-11 13:47:42.336  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=19b96238-8499-45f7-b798-ce831f2d0e01, content=null, timestamp=1641908862324, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56184, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908862322, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=BD0FBB945614AA51C6CBCE6314256744, http-session-last-accessed-time=1641908862322, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56184 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:42.350  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:42.363  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@134ab46
2022-01-11 13:47:42.365  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@134ab46
2022-01-11 13:47:42.445  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@134ab46
2022-01-11 13:47:42.447  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@134ab46
2022-01-11 13:47:42.473  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@134ab46
2022-01-11 13:47:42.475  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:42.478  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:42.482  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@134ab46
2022-01-11 13:47:42.486  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@134ab46
2022-01-11 13:47:42.489  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:42.492  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:42.495  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@134ab46
2022-01-11 13:47:42.520  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@134ab46
2022-01-11 13:47:42.523  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@134ab46
2022-01-11 13:47:42.600  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8045609408475-587961, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:42.603  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=19b96238-8499-45f7-b798-ce831f2d0e01, content=DENY, timestamp=1641908862603, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:42.607  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=252ms, Total=272ms
2022-01-11 13:47:42.650  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b48d554b-3dfd-4e03-a7f3-ab16afbbe2b9, content=null, timestamp=1641908862641, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56186, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908862639, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=EBBCC7FA456FBE7E08B3AC2CF0A7AC1F, http-session-last-accessed-time=1641908862639, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56186 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:42.654  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:42.658  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f1278c4
2022-01-11 13:47:42.663  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f1278c4
2022-01-11 13:47:42.733  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f1278c4
2022-01-11 13:47:42.736  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f1278c4
2022-01-11 13:47:42.814  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f1278c4
2022-01-11 13:47:42.816  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:42.818  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:42.820  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f1278c4
2022-01-11 13:47:42.822  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f1278c4
2022-01-11 13:47:42.826  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:42.830  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:42.832  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f1278c4
2022-01-11 13:47:42.902  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f1278c4
2022-01-11 13:47:42.906  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f1278c4
2022-01-11 13:47:42.944  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8045914384675-618050, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:42.947  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b48d554b-3dfd-4e03-a7f3-ab16afbbe2b9, content=DENY, timestamp=1641908862947, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:42.955  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=291ms, Total=307ms
2022-01-11 13:47:43.008  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=20f86221-6689-4512-b61d-7db27a80e4e8, content=null, timestamp=1641908862997, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56188, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908862991, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=29309A4F3FD69144640FC4FC7DEC5F98, http-session-last-accessed-time=1641908862991, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56188 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:43.013  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:43.024  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eead63e
2022-01-11 13:47:43.028  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eead63e
2022-01-11 13:47:43.063  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eead63e
2022-01-11 13:47:43.068  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eead63e
2022-01-11 13:47:43.098  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eead63e
2022-01-11 13:47:43.102  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:43.106  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:43.109  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eead63e
2022-01-11 13:47:43.113  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eead63e
2022-01-11 13:47:43.118  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:43.121  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:43.124  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eead63e
2022-01-11 13:47:43.191  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eead63e
2022-01-11 13:47:43.194  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eead63e
2022-01-11 13:47:43.231  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8046274753875-63162, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:43.236  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=20f86221-6689-4512-b61d-7db27a80e4e8, content=DENY, timestamp=1641908863236, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:43.239  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=219ms, Total=233ms
2022-01-11 13:47:43.297  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5eeb5975-0d1e-4c1f-bffb-f9540a09a3c9, content=null, timestamp=1641908863288, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56190, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908863286, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=ABD0ACA20FECB85B9B9ECB6DDEA7F872, http-session-last-accessed-time=1641908863286, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56190 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:43.311  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:43.324  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54ac2433
2022-01-11 13:47:43.327  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54ac2433
2022-01-11 13:47:43.364  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54ac2433
2022-01-11 13:47:43.367  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54ac2433
2022-01-11 13:47:43.403  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54ac2433
2022-01-11 13:47:43.407  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:43.410  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:43.416  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54ac2433
2022-01-11 13:47:43.421  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54ac2433
2022-01-11 13:47:43.425  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:43.428  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:43.434  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54ac2433
2022-01-11 13:47:43.516  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54ac2433
2022-01-11 13:47:43.523  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54ac2433
2022-01-11 13:47:43.554  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8046573024475-620044, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:43.559  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5eeb5975-0d1e-4c1f-bffb-f9540a09a3c9, content=DENY, timestamp=1641908863559, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:43.565  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=244ms, Total=270ms
2022-01-11 13:47:43.631  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=567584b2-0823-43f1-afd2-2cbde199a470, content=null, timestamp=1641908863604, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56192, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908863602, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=12AFDC7BED16B1CA4373831D66C1649C, http-session-last-accessed-time=1641908863602, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56192 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:43.638  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:43.679  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2e5cc3d4
2022-01-11 13:47:43.682  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2e5cc3d4
2022-01-11 13:47:43.712  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2e5cc3d4
2022-01-11 13:47:43.714  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2e5cc3d4
2022-01-11 13:47:43.751  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2e5cc3d4
2022-01-11 13:47:43.754  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:43.756  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:43.757  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2e5cc3d4
2022-01-11 13:47:43.771  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2e5cc3d4
2022-01-11 13:47:43.773  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:43.776  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:43.777  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2e5cc3d4
2022-01-11 13:47:43.859  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2e5cc3d4
2022-01-11 13:47:43.863  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2e5cc3d4
2022-01-11 13:47:43.992  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8046908322475-552403, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:43.995  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=567584b2-0823-43f1-afd2-2cbde199a470, content=DENY, timestamp=1641908863995, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:43.999  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=345ms, Total=375ms
2022-01-11 13:47:44.138  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=da0df78d-7cfb-44ea-90a5-839a9213ae0b, content=null, timestamp=1641908864086, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56194, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908864074, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=047FD484791A556CAF79C75053FFC8AF, http-session-last-accessed-time=1641908864074, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56194 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:44.142  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:44.151  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a9c1d89
2022-01-11 13:47:44.157  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a9c1d89
2022-01-11 13:47:44.189  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a9c1d89
2022-01-11 13:47:44.192  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a9c1d89
2022-01-11 13:47:44.229  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a9c1d89
2022-01-11 13:47:44.235  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:44.238  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:44.242  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a9c1d89
2022-01-11 13:47:44.250  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a9c1d89
2022-01-11 13:47:44.254  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:44.257  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:44.268  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a9c1d89
2022-01-11 13:47:44.304  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a9c1d89
2022-01-11 13:47:44.308  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a9c1d89
2022-01-11 13:47:44.378  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8047403672675-705490, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:44.380  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=da0df78d-7cfb-44ea-90a5-839a9213ae0b, content=DENY, timestamp=1641908864380, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:44.385  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=234ms, Total=248ms
2022-01-11 13:47:44.443  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=55622651-f987-427e-b879-e5905df165a1, content=null, timestamp=1641908864424, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56196, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908864423, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=3581FD57BB33607C3747B88CE57E47EE, http-session-last-accessed-time=1641908864423, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56196 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:44.449  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:44.465  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c64c15
2022-01-11 13:47:44.469  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c64c15
2022-01-11 13:47:44.505  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c64c15
2022-01-11 13:47:44.509  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c64c15
2022-01-11 13:47:44.537  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c64c15
2022-01-11 13:47:44.553  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:44.555  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:44.558  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c64c15
2022-01-11 13:47:44.560  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c64c15
2022-01-11 13:47:44.562  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:44.565  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:44.568  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c64c15
2022-01-11 13:47:44.625  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c64c15
2022-01-11 13:47:44.630  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c64c15
2022-01-11 13:47:44.709  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8047712891975-187165, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:44.713  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=55622651-f987-427e-b879-e5905df165a1, content=DENY, timestamp=1641908864713, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:44.718  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=258ms, Total=278ms
2022-01-11 13:47:44.760  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6ba3c6a2-aa5c-4eda-a88a-ab71313a3335, content=null, timestamp=1641908864748, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56198, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908864746, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=F8D2E4B87D7F625F9506A847102069C9, http-session-last-accessed-time=1641908864746, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56198 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:44.772  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:44.780  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7af4609b
2022-01-11 13:47:44.782  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7af4609b
2022-01-11 13:47:44.815  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7af4609b
2022-01-11 13:47:44.822  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7af4609b
2022-01-11 13:47:44.852  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7af4609b
2022-01-11 13:47:44.856  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:44.861  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:44.867  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7af4609b
2022-01-11 13:47:44.870  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7af4609b
2022-01-11 13:47:44.874  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:44.877  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:44.881  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7af4609b
2022-01-11 13:47:44.919  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7af4609b
2022-01-11 13:47:44.921  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7af4609b
2022-01-11 13:47:45.028  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8048036196375-755956, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:45.036  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6ba3c6a2-aa5c-4eda-a88a-ab71313a3335, content=DENY, timestamp=1641908865036, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:45.047  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=258ms, Total=290ms
2022-01-11 13:47:45.171  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8a0fe03e-296e-46e0-acac-dcca3b170890, content=null, timestamp=1641908865133, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56200, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908865113, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=EA0BD16FF65500C146E15B52DEEB3E61, http-session-last-accessed-time=1641908865113, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56200 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:45.174  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:45.183  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f5f937e
2022-01-11 13:47:45.188  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f5f937e
2022-01-11 13:47:45.257  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f5f937e
2022-01-11 13:47:45.265  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f5f937e
2022-01-11 13:47:45.319  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f5f937e
2022-01-11 13:47:45.329  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:45.332  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:45.335  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f5f937e
2022-01-11 13:47:45.337  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f5f937e
2022-01-11 13:47:45.340  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:45.343  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:45.345  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f5f937e
2022-01-11 13:47:45.407  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f5f937e
2022-01-11 13:47:45.411  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f5f937e
2022-01-11 13:47:45.516  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8048434072275-327226, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:45.520  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8a0fe03e-296e-46e0-acac-dcca3b170890, content=DENY, timestamp=1641908865519, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:45.524  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=343ms, Total=362ms
2022-01-11 13:47:45.612  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f2c95876-7f1d-40e4-bc36-e0e6b1a6dfba, content=null, timestamp=1641908865574, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56202, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908865573, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=21743471DD933B7CB0D2A7B17E07E4EE, http-session-last-accessed-time=1641908865573, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56202 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:45.622  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:45.632  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6098e601
2022-01-11 13:47:45.638  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6098e601
2022-01-11 13:47:45.673  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6098e601
2022-01-11 13:47:45.675  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6098e601
2022-01-11 13:47:45.753  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6098e601
2022-01-11 13:47:45.757  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:45.765  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:45.768  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6098e601
2022-01-11 13:47:45.771  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6098e601
2022-01-11 13:47:45.775  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:45.777  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:45.779  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6098e601
2022-01-11 13:47:45.808  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6098e601
2022-01-11 13:47:45.818  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6098e601
2022-01-11 13:47:45.849  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8048882497075-27431, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:45.856  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f2c95876-7f1d-40e4-bc36-e0e6b1a6dfba, content=DENY, timestamp=1641908865856, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:45.859  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=231ms, Total=259ms
2022-01-11 13:47:45.935  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ce506695-15cf-451b-80e6-a901a3f20e7e, content=null, timestamp=1641908865921, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56204, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908865912, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=2B7322C32EF6F8C905AFEC37E945B5A2, http-session-last-accessed-time=1641908865912, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56204 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:45.941  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:45.950  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2211ba14
2022-01-11 13:47:45.954  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2211ba14
2022-01-11 13:47:45.991  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2211ba14
2022-01-11 13:47:45.993  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2211ba14
2022-01-11 13:47:46.062  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2211ba14
2022-01-11 13:47:46.064  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:46.070  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:46.073  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2211ba14
2022-01-11 13:47:46.077  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2211ba14
2022-01-11 13:47:46.081  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:46.084  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:46.087  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2211ba14
2022-01-11 13:47:46.119  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2211ba14
2022-01-11 13:47:46.121  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2211ba14
2022-01-11 13:47:46.159  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8049202782475-331724, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:46.162  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ce506695-15cf-451b-80e6-a901a3f20e7e, content=DENY, timestamp=1641908866162, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:46.167  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=217ms, Total=234ms
2022-01-11 13:47:46.236  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c3a12c72-ee56-48ee-bb20-2c3f22709f6b, content=null, timestamp=1641908866225, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56206, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908866221, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=B7650C565BD2193350569362B8460A56, http-session-last-accessed-time=1641908866221, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56206 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:46.241  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:46.257  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@691af433
2022-01-11 13:47:46.260  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@691af433
2022-01-11 13:47:46.290  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@691af433
2022-01-11 13:47:46.295  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@691af433
2022-01-11 13:47:46.391  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@691af433
2022-01-11 13:47:46.394  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:46.400  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:46.402  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@691af433
2022-01-11 13:47:46.405  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@691af433
2022-01-11 13:47:46.407  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:46.408  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:46.411  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@691af433
2022-01-11 13:47:46.455  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@691af433
2022-01-11 13:47:46.457  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@691af433
2022-01-11 13:47:46.486  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8049501246275-198761, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:46.488  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c3a12c72-ee56-48ee-bb20-2c3f22709f6b, content=DENY, timestamp=1641908866488, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:46.491  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=245ms, Total=256ms
2022-01-11 13:47:46.546  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=226b2b6e-13e0-4ef0-b1af-6cd3b77fd747, content=null, timestamp=1641908866529, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56208, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908866526, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=466AFDBCE96A8BD3DF5DE525B7A85B3F, http-session-last-accessed-time=1641908866526, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56208 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:46.552  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:46.558  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f0f6cc9
2022-01-11 13:47:46.565  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f0f6cc9
2022-01-11 13:47:46.626  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f0f6cc9
2022-01-11 13:47:46.628  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f0f6cc9
2022-01-11 13:47:46.739  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f0f6cc9
2022-01-11 13:47:46.742  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:46.744  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:46.746  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f0f6cc9
2022-01-11 13:47:46.749  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f0f6cc9
2022-01-11 13:47:46.752  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:46.754  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:46.756  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f0f6cc9
2022-01-11 13:47:46.805  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f0f6cc9
2022-01-11 13:47:46.808  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f0f6cc9
2022-01-11 13:47:46.880  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8049814436675-496368, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:46.883  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=226b2b6e-13e0-4ef0-b1af-6cd3b77fd747, content=DENY, timestamp=1641908866883, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:46.888  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=327ms, Total=353ms
2022-01-11 13:47:46.958  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3567d912-0455-41c3-b2db-5495b5226629, content=null, timestamp=1641908866929, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56210, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908866927, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=6936F7FD8D1028D1CF378035B64BB0BE, http-session-last-accessed-time=1641908866927, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56210 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:46.964  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:46.976  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@22ee2e7d
2022-01-11 13:47:46.982  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@22ee2e7d
2022-01-11 13:47:47.028  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@22ee2e7d
2022-01-11 13:47:47.030  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@22ee2e7d
2022-01-11 13:47:47.134  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@22ee2e7d
2022-01-11 13:47:47.141  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:47.144  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:47.147  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@22ee2e7d
2022-01-11 13:47:47.151  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@22ee2e7d
2022-01-11 13:47:47.155  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:47.158  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:47.161  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@22ee2e7d
2022-01-11 13:47:47.229  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@22ee2e7d
2022-01-11 13:47:47.235  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@22ee2e7d
2022-01-11 13:47:47.279  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8050224524675-435709, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:47.288  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3567d912-0455-41c3-b2db-5495b5226629, content=DENY, timestamp=1641908867287, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:47.309  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=320ms, Total=370ms
2022-01-11 13:47:47.388  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9f453e06-d3eb-428b-8cc0-b61469909f8d, content=null, timestamp=1641908867368, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56212, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908867358, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=2748964B442FCF48D82AB4A555EA1E62, http-session-last-accessed-time=1641908867358, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56212 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:47.398  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:47.402  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4fb5dc38
2022-01-11 13:47:47.405  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4fb5dc38
2022-01-11 13:47:47.436  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4fb5dc38
2022-01-11 13:47:47.447  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4fb5dc38
2022-01-11 13:47:47.528  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4fb5dc38
2022-01-11 13:47:47.531  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:47.534  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:47.538  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4fb5dc38
2022-01-11 13:47:47.542  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4fb5dc38
2022-01-11 13:47:47.546  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:47.552  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:47.556  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4fb5dc38
2022-01-11 13:47:47.599  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4fb5dc38
2022-01-11 13:47:47.604  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4fb5dc38
2022-01-11 13:47:47.663  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8050658654375-581803, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:47.670  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9f453e06-d3eb-428b-8cc0-b61469909f8d, content=DENY, timestamp=1641908867670, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:47.674  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=269ms, Total=286ms
2022-01-11 13:47:47.716  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=776af562-6bf9-4670-b86f-f826ac67755c, content=null, timestamp=1641908867708, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56214, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908867707, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=3B5FEFC6D52625B3BCCD3CB7DDBF92EF, http-session-last-accessed-time=1641908867707, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56214 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:47.722  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:47.737  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57797416
2022-01-11 13:47:47.742  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57797416
2022-01-11 13:47:47.790  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57797416
2022-01-11 13:47:47.794  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57797416
2022-01-11 13:47:47.832  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57797416
2022-01-11 13:47:47.834  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:47.836  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:47.841  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57797416
2022-01-11 13:47:47.844  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57797416
2022-01-11 13:47:47.847  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:47.850  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:47.856  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57797416
2022-01-11 13:47:47.927  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57797416
2022-01-11 13:47:47.929  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57797416
2022-01-11 13:47:47.952  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8050986255175-581530, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:47.954  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=776af562-6bf9-4670-b86f-f826ac67755c, content=DENY, timestamp=1641908867954, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:47.959  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=226ms, Total=244ms
2022-01-11 13:47:48.015  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d3b973b2-9308-45f6-b5ca-ad7f80d6f0e8, content=null, timestamp=1641908868009, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56216, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908868007, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=3D0D93BCA863F466B46DC5A902A4DA8C, http-session-last-accessed-time=1641908868007, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56216 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:48.047  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:48.061  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f42f243
2022-01-11 13:47:48.065  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f42f243
2022-01-11 13:47:48.125  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f42f243
2022-01-11 13:47:48.127  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f42f243
2022-01-11 13:47:48.171  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f42f243
2022-01-11 13:47:48.174  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:48.178  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:48.180  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f42f243
2022-01-11 13:47:48.185  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f42f243
2022-01-11 13:47:48.188  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:48.191  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:48.195  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f42f243
2022-01-11 13:47:48.280  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f42f243
2022-01-11 13:47:48.284  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f42f243
2022-01-11 13:47:48.314  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8051310528775-966802, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:48.317  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d3b973b2-9308-45f6-b5ca-ad7f80d6f0e8, content=DENY, timestamp=1641908868317, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:48.321  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=264ms, Total=308ms
2022-01-11 13:47:48.363  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=84755621-3df1-455a-a9e2-f07fadf3d192, content=null, timestamp=1641908868358, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56218, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908868357, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=C5B19EACD02A030EAE10120F30EED4D3, http-session-last-accessed-time=1641908868357, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56218 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:48.369  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:48.373  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1963e576
2022-01-11 13:47:48.378  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1963e576
2022-01-11 13:47:48.402  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1963e576
2022-01-11 13:47:48.404  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1963e576
2022-01-11 13:47:48.476  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1963e576
2022-01-11 13:47:48.478  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:48.480  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:48.482  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1963e576
2022-01-11 13:47:48.485  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1963e576
2022-01-11 13:47:48.487  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:48.490  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:48.491  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1963e576
2022-01-11 13:47:48.516  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1963e576
2022-01-11 13:47:48.519  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1963e576
2022-01-11 13:47:48.560  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8051629335875-749578, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:48.562  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=84755621-3df1-455a-a9e2-f07fadf3d192, content=DENY, timestamp=1641908868562, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:48.571  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=191ms, Total=209ms
2022-01-11 13:47:48.638  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c1fa92fa-47a6-4997-a197-65b87c38dbb5, content=null, timestamp=1641908868622, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56220, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908868615, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=F54399F2B5BB0E60BDAD4A751194ABAE, http-session-last-accessed-time=1641908868615, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56220 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:48.641  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:48.646  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3177db33
2022-01-11 13:47:48.649  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3177db33
2022-01-11 13:47:48.684  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3177db33
2022-01-11 13:47:48.687  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3177db33
2022-01-11 13:47:48.766  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3177db33
2022-01-11 13:47:48.770  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:48.772  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:48.779  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3177db33
2022-01-11 13:47:48.782  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3177db33
2022-01-11 13:47:48.787  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:48.790  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:48.794  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3177db33
2022-01-11 13:47:48.830  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3177db33
2022-01-11 13:47:48.833  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3177db33
2022-01-11 13:47:48.872  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8051901766775-201308, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:48.880  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c1fa92fa-47a6-4997-a197-65b87c38dbb5, content=DENY, timestamp=1641908868880, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:48.885  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=237ms, Total=249ms
2022-01-11 13:47:49.008  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6694e58a-1916-4164-9a58-3345a7a92c66, content=null, timestamp=1641908868936, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56222, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908868934, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=52AFFB2E66AC8641859D5578BC931461, http-session-last-accessed-time=1641908868934, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56222 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:49.012  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:49.016  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49c448be
2022-01-11 13:47:49.018  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49c448be
2022-01-11 13:47:49.034  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49c448be
2022-01-11 13:47:49.036  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49c448be
2022-01-11 13:47:49.104  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49c448be
2022-01-11 13:47:49.108  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:49.111  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:49.113  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49c448be
2022-01-11 13:47:49.115  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49c448be
2022-01-11 13:47:49.117  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:49.120  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:49.125  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49c448be
2022-01-11 13:47:49.165  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49c448be
2022-01-11 13:47:49.169  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49c448be
2022-01-11 13:47:49.211  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8052272753975-215448, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:49.213  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6694e58a-1916-4164-9a58-3345a7a92c66, content=DENY, timestamp=1641908869213, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:49.217  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=198ms, Total=209ms
2022-01-11 13:47:49.265  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0f6ef40a-0bfe-4911-b0eb-614c64328948, content=null, timestamp=1641908869252, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56226, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908869251, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=BE2B7DC1F8501E609B9464CD6A36DDEB, http-session-last-accessed-time=1641908869251, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56226 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:49.292  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:49.316  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57b072fd
2022-01-11 13:47:49.318  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57b072fd
2022-01-11 13:47:49.376  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57b072fd
2022-01-11 13:47:49.377  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57b072fd
2022-01-11 13:47:49.463  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57b072fd
2022-01-11 13:47:49.466  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:49.468  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:49.471  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57b072fd
2022-01-11 13:47:49.476  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57b072fd
2022-01-11 13:47:49.478  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:49.480  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:49.482  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57b072fd
2022-01-11 13:47:49.524  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57b072fd
2022-01-11 13:47:49.527  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57b072fd
2022-01-11 13:47:49.574  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8052559680375-277218, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:49.576  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0f6ef40a-0bfe-4911-b0eb-614c64328948, content=DENY, timestamp=1641908869576, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:49.582  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=274ms, Total=318ms
2022-01-11 13:47:49.673  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e78d2638-ac7a-4f71-8bbb-736de644b4e8, content=null, timestamp=1641908869622, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56228, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908869621, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=C8E4B0C2B07905DB74CB3B055E134A31, http-session-last-accessed-time=1641908869621, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56228 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:49.679  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:49.683  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc50223
2022-01-11 13:47:49.687  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc50223
2022-01-11 13:47:49.729  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc50223
2022-01-11 13:47:49.732  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc50223
2022-01-11 13:47:49.834  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc50223
2022-01-11 13:47:49.840  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:49.845  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:49.848  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc50223
2022-01-11 13:47:49.851  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc50223
2022-01-11 13:47:49.854  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:49.857  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:49.859  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc50223
2022-01-11 13:47:49.910  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc50223
2022-01-11 13:47:49.912  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc50223
2022-01-11 13:47:49.939  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8052938714275-324698, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:49.941  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e78d2638-ac7a-4f71-8bbb-736de644b4e8, content=DENY, timestamp=1641908869941, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:49.944  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=260ms, Total=299ms
2022-01-11 13:47:49.993  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=18fd014e-7fc8-4019-a1ca-0de407d656e8, content=null, timestamp=1641908869981, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56230, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908869979, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=5BC05B8CDEFAE6735D68F9E1EE84D02A, http-session-last-accessed-time=1641908869979, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56230 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:50.012  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:50.023  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@391e75ca
2022-01-11 13:47:50.034  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@391e75ca
2022-01-11 13:47:50.082  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@391e75ca
2022-01-11 13:47:50.085  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@391e75ca
2022-01-11 13:47:50.170  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@391e75ca
2022-01-11 13:47:50.176  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:50.179  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:50.182  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@391e75ca
2022-01-11 13:47:50.184  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@391e75ca
2022-01-11 13:47:50.186  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:50.188  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:50.190  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@391e75ca
2022-01-11 13:47:50.228  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@391e75ca
2022-01-11 13:47:50.234  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@391e75ca
2022-01-11 13:47:50.259  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8053272720375-401360, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:50.264  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=18fd014e-7fc8-4019-a1ca-0de407d656e8, content=DENY, timestamp=1641908870264, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:50.268  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=249ms, Total=277ms
2022-01-11 13:47:50.325  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4455557a-1d1c-4150-9570-1577f45ebceb, content=null, timestamp=1641908870303, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56232, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908870301, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=BC4ACD69A8329DC505CFF1D0A10C6A04, http-session-last-accessed-time=1641908870301, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56232 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:50.332  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:50.340  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73bd4b2e
2022-01-11 13:47:50.347  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73bd4b2e
2022-01-11 13:47:50.398  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73bd4b2e
2022-01-11 13:47:50.402  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73bd4b2e
2022-01-11 13:47:50.506  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73bd4b2e
2022-01-11 13:47:50.509  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:50.513  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:50.515  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73bd4b2e
2022-01-11 13:47:50.517  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73bd4b2e
2022-01-11 13:47:50.519  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:50.523  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:50.527  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73bd4b2e
2022-01-11 13:47:50.571  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73bd4b2e
2022-01-11 13:47:50.574  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73bd4b2e
2022-01-11 13:47:50.615  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8053591376275-464755, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:50.620  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4455557a-1d1c-4150-9570-1577f45ebceb, content=DENY, timestamp=1641908870620, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:50.625  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=287ms, Total=302ms
2022-01-11 13:47:50.720  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8db39294-fdb5-4a20-a656-132067b6abdf, content=null, timestamp=1641908870689, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56234, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908870679, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=7B6A0773B4B3B8FCEC1D0D9A5AA47C62, http-session-last-accessed-time=1641908870679, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56234 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:50.726  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:50.731  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6ba01eec
2022-01-11 13:47:50.761  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6ba01eec
2022-01-11 13:47:50.815  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6ba01eec
2022-01-11 13:47:50.818  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6ba01eec
2022-01-11 13:47:50.916  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6ba01eec
2022-01-11 13:47:50.920  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:50.923  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:50.927  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6ba01eec
2022-01-11 13:47:50.930  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6ba01eec
2022-01-11 13:47:50.933  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:50.946  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:50.949  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6ba01eec
2022-01-11 13:47:50.992  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6ba01eec
2022-01-11 13:47:50.995  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6ba01eec
2022-01-11 13:47:51.035  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8053987864475-270498, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:51.041  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8db39294-fdb5-4a20-a656-132067b6abdf, content=DENY, timestamp=1641908871040, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:51.045  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=310ms, Total=326ms
2022-01-11 13:47:51.134  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f153bf35-1883-49ca-a0dd-5b9acae2eaaf, content=null, timestamp=1641908871121, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56236, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908871116, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=6F1CFF46477190423DC04ACB869145A3, http-session-last-accessed-time=1641908871116, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56236 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:51.142  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:51.151  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7aba05a6
2022-01-11 13:47:51.155  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7aba05a6
2022-01-11 13:47:51.202  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7aba05a6
2022-01-11 13:47:51.209  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7aba05a6
2022-01-11 13:47:51.278  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7aba05a6
2022-01-11 13:47:51.286  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:51.291  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:51.295  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7aba05a6
2022-01-11 13:47:51.302  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7aba05a6
2022-01-11 13:47:51.321  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:51.332  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:51.341  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7aba05a6
2022-01-11 13:47:51.383  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7aba05a6
2022-01-11 13:47:51.388  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7aba05a6
2022-01-11 13:47:51.439  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8054402363975-141612, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:51.443  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f153bf35-1883-49ca-a0dd-5b9acae2eaaf, content=DENY, timestamp=1641908871443, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:51.456  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=299ms, Total=325ms
2022-01-11 13:47:51.528  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8cc69d6a-5629-46ef-a252-87c07a95544c, content=null, timestamp=1641908871508, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56238, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908871504, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=34D5F780C9284AC64CFAD1BC12A7B9DE, http-session-last-accessed-time=1641908871504, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56238 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:51.531  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:51.535  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38bfaa55
2022-01-11 13:47:51.537  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38bfaa55
2022-01-11 13:47:51.575  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38bfaa55
2022-01-11 13:47:51.577  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38bfaa55
2022-01-11 13:47:51.653  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38bfaa55
2022-01-11 13:47:51.655  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:51.660  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:51.664  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38bfaa55
2022-01-11 13:47:51.666  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38bfaa55
2022-01-11 13:47:51.670  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:51.676  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:51.678  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38bfaa55
2022-01-11 13:47:51.708  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38bfaa55
2022-01-11 13:47:51.712  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38bfaa55
2022-01-11 13:47:51.750  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8054791718975-590718, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:51.753  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8cc69d6a-5629-46ef-a252-87c07a95544c, content=DENY, timestamp=1641908871753, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:51.759  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=219ms, Total=236ms
2022-01-11 13:47:51.856  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7dc9161f-c458-42a1-a99b-f9b387a7cbc2, content=null, timestamp=1641908871834, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56240, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908871816, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=4EA994C0CF3E3C1761779A83DAB39F22, http-session-last-accessed-time=1641908871816, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56240 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:51.865  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:51.874  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d36b965
2022-01-11 13:47:51.878  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d36b965
2022-01-11 13:47:51.914  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d36b965
2022-01-11 13:47:51.920  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d36b965
2022-01-11 13:47:52.001  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d36b965
2022-01-11 13:47:52.006  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:52.009  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:52.018  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d36b965
2022-01-11 13:47:52.022  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d36b965
2022-01-11 13:47:52.025  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:52.027  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:52.030  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d36b965
2022-01-11 13:47:52.080  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d36b965
2022-01-11 13:47:52.084  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d36b965
2022-01-11 13:47:52.129  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8055125788075-77073, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:52.132  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7dc9161f-c458-42a1-a99b-f9b387a7cbc2, content=DENY, timestamp=1641908872132, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:52.138  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=264ms, Total=293ms
2022-01-11 13:47:52.178  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b5b94465-3548-4841-b6fc-ed938d74848b, content=null, timestamp=1641908872169, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56242, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908872166, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=1F7EC5FB5DCA776EDC9C8176434531F3, http-session-last-accessed-time=1641908872166, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56242 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:52.184  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:52.211  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5d2a6f76
2022-01-11 13:47:52.225  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5d2a6f76
2022-01-11 13:47:52.343  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5d2a6f76
2022-01-11 13:47:52.345  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5d2a6f76
2022-01-11 13:47:52.472  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5d2a6f76
2022-01-11 13:47:52.474  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:52.478  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:52.482  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5d2a6f76
2022-01-11 13:47:52.484  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5d2a6f76
2022-01-11 13:47:52.487  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:52.490  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:52.493  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5d2a6f76
2022-01-11 13:47:52.531  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5d2a6f76
2022-01-11 13:47:52.533  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5d2a6f76
2022-01-11 13:47:52.574  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8055446811875-834734, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:52.579  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b5b94465-3548-4841-b6fc-ed938d74848b, content=DENY, timestamp=1641908872579, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:52.584  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=390ms, Total=408ms
2022-01-11 13:47:52.641  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=71694d87-bc4d-425a-9dd0-95312238de88, content=null, timestamp=1641908872629, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56244, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ebcc041a8f59, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.144.1, kc-session-state=bffd5f63-a769-45f6-b0c7-94307f73676a, http-req-server-port=80, http-header-accept=*/*, kc-id=911881a9-514d-4a57-90d8-defead2f2163, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641908872628, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2LjnNxAH4AEQAAAABh3YpidAAkOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJCNTh3cGNaWlNmcF9CWjhwWUJEWFJYTGZGb3k4dTYzazYxeUphc0g5QnBRIn0.eyJleHAiOjE2NDE5MDkxMzQsImlhdCI6MTY0MTkwODgzNCwianRpIjoiOTExODgxYTktNTE0ZC00YTU3LTkwZDgtZGVmZWFkMmYyMTYzIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYmZmZDVmNjMtYTc2OS00NWY2LWIwYzctOTQzMDdmNzM2NzZhIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Lc3n5hKQFTCAcSNBy2pSikug4OuNpae-jugZ0BjZe6kPu3j-G7oyK92jBXn06nHArsrWjUTTxiyHff97IP6KqKmYW6-w3LOZYJaa3wVsrrXxXnI6f-wO9H9Lf2A3_dD3xIQuo1nvspJ89IFQuaumU4ape7u0ZPqmuhE2UrVRhxp6ZuKLQwS_CISI4zSHfWvmOTuUyJJKjSOugdirwy7YNEt4Alc0yuyrF19hmR5QOpyPmvgddsuXa-ynwRJouHED8qzJZtLdhjjGcjGrjJMP5AwUpDnOeoZ3xEgf8QN60pVKHkD4HfB8z9VKxt3MXzEsDOvPSZz3OGkF7Y4lITSU1A, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641909134, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.144.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.144.1, http-session-id=CAC5319F3482EFE1C744C136E2768E79, http-session-last-accessed-time=1641908872628, kc-category-name=ACCESS, kc-iat=1641908834, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.144.1:56244 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:47:52.645  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:47:52.650  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4687999d
2022-01-11 13:47:52.653  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4687999d
2022-01-11 13:47:52.687  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4687999d
2022-01-11 13:47:52.690  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4687999d
2022-01-11 13:47:52.761  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4687999d
2022-01-11 13:47:52.763  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:52.765  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:52.770  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4687999d
2022-01-11 13:47:52.775  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4687999d
2022-01-11 13:47:52.779  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-11 13:47:52.782  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-11 13:47:52.785  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4687999d
2022-01-11 13:47:52.808  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4687999d
2022-01-11 13:47:52.812  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4687999d
2022-01-11 13:47:52.853  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-8055906469375-552326, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}})
2022-01-11 13:47:52.857  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=71694d87-bc4d-425a-9dd0-95312238de88, content=DENY, timestamp=1641908872857, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:d60fc86c-2efa-4deb-8521-561987b7d636:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=d60fc86c-2efa-4deb-8521-561987b7d636, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 6 - Current Time greater than or equal Time Treat, asclepios:obligation:decision=DENY}}))
2022-01-11 13:47:52.861  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=209ms, Total=222ms
