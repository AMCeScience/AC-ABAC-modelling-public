2022-01-13 11:36:22.600  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=320ms, Total=338ms
2022-01-13 11:36:22.688  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=667b2336-e43a-4ad0-9d40-f03e7648f430, content=null, timestamp=1642073782672, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56284, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073782660, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=45E56A53B6848E5CE6037619BF401AA6, http-session-last-accessed-time=1642073782660, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56284 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:22.694  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:22.711  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a818169
2022-01-13 11:36:22.719  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a818169
2022-01-13 11:36:22.823  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a818169
2022-01-13 11:36:22.826  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a818169
2022-01-13 11:36:22.889  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a818169
2022-01-13 11:36:22.891  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:22.894  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:22.896  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a818169
2022-01-13 11:36:23.065  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a818169
2022-01-13 11:36:23.067  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:23.070  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:23.074  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a818169
2022-01-13 11:36:23.104  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a818169
2022-01-13 11:36:23.108  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a818169
2022-01-13 11:36:23.140  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17076242625590-286835, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:23.145  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=667b2336-e43a-4ad0-9d40-f03e7648f430, content=DENY, timestamp=1642073783145, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:23.151  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=446ms, Total=470ms
2022-01-13 11:36:23.221  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=334e0093-9a4d-4909-8ded-eff081a951f4, content=null, timestamp=1642073783212, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56286, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073783207, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=FCBA65A5AE08E54E68C433DBCF2936B1, http-session-last-accessed-time=1642073783207, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56286 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:23.227  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:23.243  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15f927
2022-01-13 11:36:23.247  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15f927
2022-01-13 11:36:23.288  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15f927
2022-01-13 11:36:23.290  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15f927
2022-01-13 11:36:23.372  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15f927
2022-01-13 11:36:23.378  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:23.381  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:23.386  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15f927
2022-01-13 11:36:23.420  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15f927
2022-01-13 11:36:23.430  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:23.435  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:23.439  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15f927
2022-01-13 11:36:23.482  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15f927
2022-01-13 11:36:23.489  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15f927
2022-01-13 11:36:23.573  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17076775590790-851171, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:23.576  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=334e0093-9a4d-4909-8ded-eff081a951f4, content=DENY, timestamp=1642073783576, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:23.592  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=344ms, Total=373ms
2022-01-13 11:36:23.699  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f5c1287c-8c76-4976-bd99-f6a3211954b9, content=null, timestamp=1642073783684, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56288, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073783664, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=12141E3A767C4511A7582284FAE45E05, http-session-last-accessed-time=1642073783664, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56288 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:23.704  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:23.709  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2504672b
2022-01-13 11:36:23.713  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2504672b
2022-01-13 11:36:23.775  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2504672b
2022-01-13 11:36:23.782  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2504672b
2022-01-13 11:36:23.829  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2504672b
2022-01-13 11:36:23.832  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:23.839  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:23.846  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2504672b
2022-01-13 11:36:23.899  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2504672b
2022-01-13 11:36:23.901  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:23.907  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:23.910  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2504672b
2022-01-13 11:36:23.986  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2504672b
2022-01-13 11:36:23.991  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2504672b
2022-01-13 11:36:24.051  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17077251027090-678160, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:24.055  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f5c1287c-8c76-4976-bd99-f6a3211954b9, content=DENY, timestamp=1642073784055, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:24.061  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=346ms, Total=365ms
2022-01-13 11:36:24.243  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1e1470b1-f7ac-4439-a56b-61078636a492, content=null, timestamp=1642073784231, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56290, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073784182, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=D48A90EF5E0B8768F0AE8B0E8FCE4D28, http-session-last-accessed-time=1642073784182, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56290 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:24.275  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:24.284  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73e6df4b
2022-01-13 11:36:24.288  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73e6df4b
2022-01-13 11:36:24.333  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73e6df4b
2022-01-13 11:36:24.339  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73e6df4b
2022-01-13 11:36:24.376  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73e6df4b
2022-01-13 11:36:24.383  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:24.388  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:24.395  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73e6df4b
2022-01-13 11:36:24.473  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73e6df4b
2022-01-13 11:36:24.476  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:24.481  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:24.486  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73e6df4b
2022-01-13 11:36:24.528  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73e6df4b
2022-01-13 11:36:24.530  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73e6df4b
2022-01-13 11:36:24.584  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17077821074490-294398, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:24.589  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1e1470b1-f7ac-4439-a56b-61078636a492, content=DENY, timestamp=1642073784589, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:24.594  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=311ms, Total=353ms
2022-01-13 11:36:24.678  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=552fa2c3-a051-4f77-a443-69c537a18422, content=null, timestamp=1642073784647, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56292, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073784642, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=1C69F373BB574154D4BB28A4C465F043, http-session-last-accessed-time=1642073784642, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56292 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:24.698  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:24.705  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7170e311
2022-01-13 11:36:24.707  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7170e311
2022-01-13 11:36:24.754  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7170e311
2022-01-13 11:36:24.759  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7170e311
2022-01-13 11:36:24.828  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7170e311
2022-01-13 11:36:24.830  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:24.833  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:24.837  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7170e311
2022-01-13 11:36:24.880  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7170e311
2022-01-13 11:36:24.883  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:24.886  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:24.889  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7170e311
2022-01-13 11:36:24.943  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7170e311
2022-01-13 11:36:24.948  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7170e311
2022-01-13 11:36:25.034  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17078246098090-845442, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:25.038  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=552fa2c3-a051-4f77-a443-69c537a18422, content=DENY, timestamp=1642073785038, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:25.045  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=335ms, Total=368ms
2022-01-13 11:36:25.103  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ee78d8c8-e8db-4376-ad9f-16569857257b, content=null, timestamp=1642073785089, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56294, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073785087, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=BA0ABD73FAE1AF9F81B49B239C685CF2, http-session-last-accessed-time=1642073785087, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56294 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:25.109  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:25.119  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c6be799
2022-01-13 11:36:25.125  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c6be799
2022-01-13 11:36:25.165  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c6be799
2022-01-13 11:36:25.169  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c6be799
2022-01-13 11:36:25.222  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c6be799
2022-01-13 11:36:25.227  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:25.229  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:25.231  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c6be799
2022-01-13 11:36:25.302  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c6be799
2022-01-13 11:36:25.308  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:25.311  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:25.314  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c6be799
2022-01-13 11:36:25.430  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c6be799
2022-01-13 11:36:25.434  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c6be799
2022-01-13 11:36:25.494  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17078656930390-756015, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:25.499  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ee78d8c8-e8db-4376-ad9f-16569857257b, content=DENY, timestamp=1642073785499, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:25.502  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=385ms, Total=401ms
2022-01-13 11:36:25.562  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0f715bf5-a5ff-4558-a243-412accd1b8b9, content=null, timestamp=1642073785550, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56296, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073785549, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=559F54CD2BF4054C91D94433364FBA0F, http-session-last-accessed-time=1642073785549, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56296 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:25.570  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:25.575  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45b003
2022-01-13 11:36:25.578  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45b003
2022-01-13 11:36:25.618  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45b003
2022-01-13 11:36:25.622  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45b003
2022-01-13 11:36:25.652  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45b003
2022-01-13 11:36:25.655  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:25.662  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:25.668  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45b003
2022-01-13 11:36:25.736  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45b003
2022-01-13 11:36:25.740  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:25.743  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:25.745  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45b003
2022-01-13 11:36:25.777  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45b003
2022-01-13 11:36:25.788  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45b003
2022-01-13 11:36:25.829  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17079116252990-718702, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:25.831  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0f715bf5-a5ff-4558-a243-412accd1b8b9, content=DENY, timestamp=1642073785831, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:25.835  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=258ms, Total=274ms
2022-01-13 11:36:25.896  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=cc80b0c2-10ad-4a55-977c-b1e83b2d8149, content=null, timestamp=1642073785884, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56298, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073785878, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=1A0D6DD9B299FFADD7F8C876B2F30880, http-session-last-accessed-time=1642073785878, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56298 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:25.901  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:25.912  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f2856d
2022-01-13 11:36:25.915  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f2856d
2022-01-13 11:36:25.950  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f2856d
2022-01-13 11:36:25.956  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f2856d
2022-01-13 11:36:26.028  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f2856d
2022-01-13 11:36:26.031  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:26.033  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:26.038  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f2856d
2022-01-13 11:36:26.073  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f2856d
2022-01-13 11:36:26.076  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:26.079  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:26.084  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f2856d
2022-01-13 11:36:26.122  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f2856d
2022-01-13 11:36:26.127  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f2856d
2022-01-13 11:36:26.191  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17079450534790-465305, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:26.195  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=cc80b0c2-10ad-4a55-977c-b1e83b2d8149, content=DENY, timestamp=1642073786195, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:26.197  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=287ms, Total=303ms
2022-01-13 11:36:26.254  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=656fabc7-f9f2-4ab2-956e-6ed84bb5a657, content=null, timestamp=1642073786234, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56300, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073786223, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=53F678E69EBE10CAA34765921C1F6AE2, http-session-last-accessed-time=1642073786223, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56300 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:26.261  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:26.277  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47210e27
2022-01-13 11:36:26.281  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47210e27
2022-01-13 11:36:26.313  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47210e27
2022-01-13 11:36:26.317  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47210e27
2022-01-13 11:36:26.356  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47210e27
2022-01-13 11:36:26.360  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:26.364  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:26.366  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47210e27
2022-01-13 11:36:26.375  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47210e27
2022-01-13 11:36:26.379  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:26.384  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:26.387  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47210e27
2022-01-13 11:36:26.481  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47210e27
2022-01-13 11:36:26.484  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47210e27
2022-01-13 11:36:26.527  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17079809358890-666480, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:26.531  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=656fabc7-f9f2-4ab2-956e-6ed84bb5a657, content=DENY, timestamp=1642073786531, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:26.540  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=265ms, Total=288ms
2022-01-13 11:36:26.615  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c8b92ed7-2eaa-406f-b86f-45f4bab5e758, content=null, timestamp=1642073786599, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56302, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073786592, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=5066A8FCE7FA0FDC80E68F8CCA146657, http-session-last-accessed-time=1642073786592, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56302 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:26.621  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:26.642  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69898216
2022-01-13 11:36:26.645  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69898216
2022-01-13 11:36:26.714  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69898216
2022-01-13 11:36:26.718  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69898216
2022-01-13 11:36:26.762  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69898216
2022-01-13 11:36:26.769  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:26.771  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:26.776  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69898216
2022-01-13 11:36:26.866  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69898216
2022-01-13 11:36:26.870  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:26.873  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:26.876  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69898216
2022-01-13 11:36:26.906  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69898216
2022-01-13 11:36:26.912  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69898216
2022-01-13 11:36:26.944  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17080201782890-943522, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:26.947  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c8b92ed7-2eaa-406f-b86f-45f4bab5e758, content=DENY, timestamp=1642073786947, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:26.950  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=323ms, Total=336ms
2022-01-13 11:36:26.998  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6eed82ca-ccf6-40a6-9873-9655b38c1ee1, content=null, timestamp=1642073786986, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56304, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073786982, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=099CB34101E2670A32CC5A306288A19F, http-session-last-accessed-time=1642073786982, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56304 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:27.003  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:27.008  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ee964c
2022-01-13 11:36:27.012  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ee964c
2022-01-13 11:36:27.047  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ee964c
2022-01-13 11:36:27.052  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ee964c
2022-01-13 11:36:27.124  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ee964c
2022-01-13 11:36:27.128  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:27.131  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:27.134  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ee964c
2022-01-13 11:36:27.156  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ee964c
2022-01-13 11:36:27.158  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:27.164  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:27.167  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ee964c
2022-01-13 11:36:27.205  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ee964c
2022-01-13 11:36:27.207  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ee964c
2022-01-13 11:36:27.284  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17080583880890-439145, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:27.288  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6eed82ca-ccf6-40a6-9873-9655b38c1ee1, content=DENY, timestamp=1642073787288, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:27.291  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=282ms, Total=296ms
2022-01-13 11:36:27.336  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f8fe745d-e208-46cc-ae99-0e22d715258a, content=null, timestamp=1642073787324, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56306, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073787322, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=3F65B501228CA4646EC9F3ED0D388842, http-session-last-accessed-time=1642073787322, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56306 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:27.346  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:27.354  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a0843b5
2022-01-13 11:36:27.359  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a0843b5
2022-01-13 11:36:27.396  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a0843b5
2022-01-13 11:36:27.399  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a0843b5
2022-01-13 11:36:27.435  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a0843b5
2022-01-13 11:36:27.438  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:27.443  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:27.449  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a0843b5
2022-01-13 11:36:27.482  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a0843b5
2022-01-13 11:36:27.485  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:27.489  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:27.495  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a0843b5
2022-01-13 11:36:27.566  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a0843b5
2022-01-13 11:36:27.569  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a0843b5
2022-01-13 11:36:27.616  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17080926612190-602859, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:27.624  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f8fe745d-e208-46cc-ae99-0e22d715258a, content=DENY, timestamp=1642073787624, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:27.636  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=275ms, Total=301ms
2022-01-13 11:36:27.690  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d2549fc4-edd3-4b6d-8656-7dd2dd42814a, content=null, timestamp=1642073787670, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56308, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073787662, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=916E3FD58FF0EFA6D424F6E0DFEAAF28, http-session-last-accessed-time=1642073787662, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56308 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:27.702  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:27.713  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@30a1c6c2
2022-01-13 11:36:27.722  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@30a1c6c2
2022-01-13 11:36:27.763  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@30a1c6c2
2022-01-13 11:36:27.770  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@30a1c6c2
2022-01-13 11:36:27.805  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@30a1c6c2
2022-01-13 11:36:27.809  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:27.814  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:27.818  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@30a1c6c2
2022-01-13 11:36:27.895  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@30a1c6c2
2022-01-13 11:36:27.900  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:27.904  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:27.908  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@30a1c6c2
2022-01-13 11:36:27.939  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@30a1c6c2
2022-01-13 11:36:27.944  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@30a1c6c2
2022-01-13 11:36:27.968  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17081284238290-302980, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:27.974  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d2549fc4-edd3-4b6d-8656-7dd2dd42814a, content=DENY, timestamp=1642073787974, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:27.977  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=267ms, Total=297ms
2022-01-13 11:36:28.025  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=48e034fe-ccac-47ac-a2fe-ad0811475be9, content=null, timestamp=1642073788016, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56310, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073788015, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=1681A883C218A8C814131297B076C6F5, http-session-last-accessed-time=1642073788015, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56310 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:28.031  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:28.035  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c7d6d5
2022-01-13 11:36:28.042  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c7d6d5
2022-01-13 11:36:28.088  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c7d6d5
2022-01-13 11:36:28.093  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c7d6d5
2022-01-13 11:36:28.166  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c7d6d5
2022-01-13 11:36:28.175  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:28.180  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:28.185  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c7d6d5
2022-01-13 11:36:28.245  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c7d6d5
2022-01-13 11:36:28.255  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:28.258  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:28.264  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c7d6d5
2022-01-13 11:36:28.310  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c7d6d5
2022-01-13 11:36:28.314  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c7d6d5
2022-01-13 11:36:28.392  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17081611295390-544956, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:28.398  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=48e034fe-ccac-47ac-a2fe-ad0811475be9, content=DENY, timestamp=1642073788398, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:28.403  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=364ms, Total=380ms
2022-01-13 11:36:28.451  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e19e182b-3c02-4ac4-9c48-bd0ea42ee377, content=null, timestamp=1642073788442, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56312, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073788441, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=39C1A2C3385A7D7AE07AD61046B54596, http-session-last-accessed-time=1642073788441, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56312 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:28.458  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:28.465  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f85b6e4
2022-01-13 11:36:28.470  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f85b6e4
2022-01-13 11:36:28.513  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f85b6e4
2022-01-13 11:36:28.516  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f85b6e4
2022-01-13 11:36:28.548  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f85b6e4
2022-01-13 11:36:28.550  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:28.557  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:28.560  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f85b6e4
2022-01-13 11:36:28.587  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f85b6e4
2022-01-13 11:36:28.590  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:28.594  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:28.597  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f85b6e4
2022-01-13 11:36:28.677  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f85b6e4
2022-01-13 11:36:28.682  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f85b6e4
2022-01-13 11:36:28.728  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17082039119590-532974, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:28.735  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e19e182b-3c02-4ac4-9c48-bd0ea42ee377, content=DENY, timestamp=1642073788735, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:28.755  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=273ms, Total=306ms
2022-01-13 11:36:28.835  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c0df651f-7b33-4fac-a6f0-7ac197436f85, content=null, timestamp=1642073788807, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56314, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073788805, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=E43B9ABD924F8C28A1AA1937639D8BC4, http-session-last-accessed-time=1642073788805, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56314 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:28.850  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:28.855  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45546451
2022-01-13 11:36:28.871  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45546451
2022-01-13 11:36:28.942  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45546451
2022-01-13 11:36:28.948  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45546451
2022-01-13 11:36:28.999  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45546451
2022-01-13 11:36:29.002  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:29.006  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:29.008  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45546451
2022-01-13 11:36:29.081  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45546451
2022-01-13 11:36:29.084  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:29.087  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:29.092  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45546451
2022-01-13 11:36:29.122  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45546451
2022-01-13 11:36:29.125  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45546451
2022-01-13 11:36:29.176  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17082430122190-711545, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:29.182  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c0df651f-7b33-4fac-a6f0-7ac197436f85, content=DENY, timestamp=1642073789182, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:29.184  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=330ms, Total=353ms
2022-01-13 11:36:29.248  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=dcaead7b-3a76-498b-b81e-ddc9b0bfa654, content=null, timestamp=1642073789233, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56316, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073789232, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=CAC6B19BF8AD0ECFB3064A0A32FC9CB3, http-session-last-accessed-time=1642073789232, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56316 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:29.255  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:29.267  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@526c3e3f
2022-01-13 11:36:29.272  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@526c3e3f
2022-01-13 11:36:29.326  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@526c3e3f
2022-01-13 11:36:29.328  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@526c3e3f
2022-01-13 11:36:29.422  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@526c3e3f
2022-01-13 11:36:29.426  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:29.429  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:29.432  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@526c3e3f
2022-01-13 11:36:29.524  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@526c3e3f
2022-01-13 11:36:29.528  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:29.530  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:29.533  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@526c3e3f
2022-01-13 11:36:29.619  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@526c3e3f
2022-01-13 11:36:29.622  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@526c3e3f
2022-01-13 11:36:29.726  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17082839113490-452387, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:29.730  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=dcaead7b-3a76-498b-b81e-ddc9b0bfa654, content=DENY, timestamp=1642073789730, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:29.736  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=468ms, Total=489ms
2022-01-13 11:36:29.780  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c756e625-376c-4252-83bb-68c52b301fae, content=null, timestamp=1642073789770, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56318, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073789768, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=DFA9BAE3B316307D661454528EF3A1D7, http-session-last-accessed-time=1642073789768, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56318 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:29.785  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:29.800  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fe2d382
2022-01-13 11:36:29.805  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fe2d382
2022-01-13 11:36:29.855  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fe2d382
2022-01-13 11:36:29.859  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fe2d382
2022-01-13 11:36:29.904  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fe2d382
2022-01-13 11:36:29.909  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:29.913  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:29.917  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fe2d382
2022-01-13 11:36:29.942  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fe2d382
2022-01-13 11:36:29.945  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:29.951  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:29.956  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fe2d382
2022-01-13 11:36:30.034  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fe2d382
2022-01-13 11:36:30.039  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fe2d382
2022-01-13 11:36:30.084  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17083367101890-983383, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:30.086  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c756e625-376c-4252-83bb-68c52b301fae, content=DENY, timestamp=1642073790086, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:30.090  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=297ms, Total=312ms
2022-01-13 11:36:30.167  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7448f14e-88a6-43ef-bc7f-6faf6a46ccbd, content=null, timestamp=1642073790146, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56320, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073790144, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=78DB47699E433B5DEA73F19476593914, http-session-last-accessed-time=1642073790144, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56320 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:30.173  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:30.182  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74c2713e
2022-01-13 11:36:30.185  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74c2713e
2022-01-13 11:36:30.221  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74c2713e
2022-01-13 11:36:30.224  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74c2713e
2022-01-13 11:36:30.261  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74c2713e
2022-01-13 11:36:30.265  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:30.268  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:30.277  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74c2713e
2022-01-13 11:36:30.341  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74c2713e
2022-01-13 11:36:30.346  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:30.353  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:30.358  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74c2713e
2022-01-13 11:36:30.386  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74c2713e
2022-01-13 11:36:30.390  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74c2713e
2022-01-13 11:36:30.447  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17083756718690-257965, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:30.452  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7448f14e-88a6-43ef-bc7f-6faf6a46ccbd, content=DENY, timestamp=1642073790452, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:30.458  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=273ms, Total=295ms
2022-01-13 11:36:30.510  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9de45224-5ed4-4da4-bd9f-b1530e4288c4, content=null, timestamp=1642073790503, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56322, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073790502, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=6585059F0E768540624E86D2A98F85D6, http-session-last-accessed-time=1642073790502, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56322 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:30.527  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:30.542  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@8a29bc
2022-01-13 11:36:30.549  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@8a29bc
2022-01-13 11:36:30.576  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@8a29bc
2022-01-13 11:36:30.581  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@8a29bc
2022-01-13 11:36:30.664  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@8a29bc
2022-01-13 11:36:30.666  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:30.669  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:30.676  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@8a29bc
2022-01-13 11:36:30.709  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@8a29bc
2022-01-13 11:36:30.717  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:30.721  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:30.724  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@8a29bc
2022-01-13 11:36:30.780  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@8a29bc
2022-01-13 11:36:30.784  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@8a29bc
2022-01-13 11:36:30.860  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17084108702390-409817, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:30.866  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9de45224-5ed4-4da4-bd9f-b1530e4288c4, content=DENY, timestamp=1642073790865, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:30.871  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=334ms, Total=363ms
2022-01-13 11:36:30.944  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=fb78ebf7-9256-4c2c-bd85-13dc59585049, content=null, timestamp=1642073790927, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56324, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073790920, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=7BE63374DC240D89943EC01C973DB3BE, http-session-last-accessed-time=1642073790920, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56324 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:30.951  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:30.967  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65686a76
2022-01-13 11:36:30.975  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65686a76
2022-01-13 11:36:31.064  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65686a76
2022-01-13 11:36:31.067  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65686a76
2022-01-13 11:36:31.114  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65686a76
2022-01-13 11:36:31.120  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:31.123  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:31.127  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65686a76
2022-01-13 11:36:31.199  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65686a76
2022-01-13 11:36:31.203  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:31.205  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:31.207  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65686a76
2022-01-13 11:36:31.309  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65686a76
2022-01-13 11:36:31.316  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65686a76
2022-01-13 11:36:31.357  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17084533012190-53966, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:31.365  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=fb78ebf7-9256-4c2c-bd85-13dc59585049, content=DENY, timestamp=1642073791364, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:31.372  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=408ms, Total=430ms
2022-01-13 11:36:31.441  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bb008574-9ee3-4ebf-a9e7-1ab3c74d031f, content=null, timestamp=1642073791429, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56326, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073791427, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=F951292EDD789B53A9ABD2222455C80D, http-session-last-accessed-time=1642073791427, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56326 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:31.446  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:31.455  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f854674
2022-01-13 11:36:31.461  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f854674
2022-01-13 11:36:31.495  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f854674
2022-01-13 11:36:31.500  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f854674
2022-01-13 11:36:31.539  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f854674
2022-01-13 11:36:31.542  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:31.546  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:31.551  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f854674
2022-01-13 11:36:31.630  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f854674
2022-01-13 11:36:31.636  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:31.641  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:31.646  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f854674
2022-01-13 11:36:31.692  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f854674
2022-01-13 11:36:31.705  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f854674
2022-01-13 11:36:31.747  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17085028847890-746728, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:31.753  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bb008574-9ee3-4ebf-a9e7-1ab3c74d031f, content=DENY, timestamp=1642073791752, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:31.763  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=301ms, Total=324ms
2022-01-13 11:36:31.829  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2511ff2a-a6c7-4f61-a2c1-08c36d424773, content=null, timestamp=1642073791822, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56328, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073791814, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=CD7AA378C2DF19FD6E1EC6CD995ECEF3, http-session-last-accessed-time=1642073791814, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56328 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:31.834  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:31.842  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@429d5fcd
2022-01-13 11:36:31.852  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@429d5fcd
2022-01-13 11:36:31.885  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@429d5fcd
2022-01-13 11:36:31.888  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@429d5fcd
2022-01-13 11:36:31.985  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@429d5fcd
2022-01-13 11:36:31.988  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:31.992  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:31.995  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@429d5fcd
2022-01-13 11:36:32.043  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@429d5fcd
2022-01-13 11:36:32.045  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:32.050  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:32.056  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@429d5fcd
2022-01-13 11:36:32.114  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@429d5fcd
2022-01-13 11:36:32.118  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@429d5fcd
2022-01-13 11:36:32.217  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17085416028090-328893, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:32.221  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2511ff2a-a6c7-4f61-a2c1-08c36d424773, content=DENY, timestamp=1642073792221, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:32.225  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=382ms, Total=397ms
2022-01-13 11:36:32.309  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=42048f9e-8dc7-49ac-bcf2-857b11046b2b, content=null, timestamp=1642073792291, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56330, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073792289, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=6B71A810424120CA9F566E812D85A3B7, http-session-last-accessed-time=1642073792289, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56330 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:32.315  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:32.320  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b40261d
2022-01-13 11:36:32.331  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b40261d
2022-01-13 11:36:32.413  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b40261d
2022-01-13 11:36:32.431  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b40261d
2022-01-13 11:36:32.528  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b40261d
2022-01-13 11:36:32.532  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:32.539  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:32.543  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b40261d
2022-01-13 11:36:32.679  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b40261d
2022-01-13 11:36:32.686  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:32.695  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:32.701  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b40261d
2022-01-13 11:36:32.803  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b40261d
2022-01-13 11:36:32.806  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b40261d
2022-01-13 11:36:32.854  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17085895566290-167517, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:32.857  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=42048f9e-8dc7-49ac-bcf2-857b11046b2b, content=DENY, timestamp=1642073792857, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:32.860  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=539ms, Total=553ms
2022-01-13 11:36:32.932  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a634631b-d643-4558-ad73-976aeb89512d, content=null, timestamp=1642073792915, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56332, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073792912, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=1857DF3992AC677012A5939D6CB10A72, http-session-last-accessed-time=1642073792912, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56332 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:32.937  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:32.953  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e18b06
2022-01-13 11:36:32.957  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e18b06
2022-01-13 11:36:32.995  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e18b06
2022-01-13 11:36:33.000  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e18b06
2022-01-13 11:36:33.026  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e18b06
2022-01-13 11:36:33.030  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:33.035  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:33.044  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e18b06
2022-01-13 11:36:33.131  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e18b06
2022-01-13 11:36:33.134  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:33.137  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:33.144  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e18b06
2022-01-13 11:36:33.178  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e18b06
2022-01-13 11:36:33.183  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e18b06
2022-01-13 11:36:33.224  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17086525195290-679933, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:33.227  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a634631b-d643-4558-ad73-976aeb89512d, content=DENY, timestamp=1642073793227, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:33.232  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=281ms, Total=308ms
2022-01-13 11:36:33.286  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ddfb72ed-2985-4df7-b3b0-2a5ad2037ae9, content=null, timestamp=1642073793270, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56334, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073793267, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=C77E7E95879356C6AD4366D95A54B686, http-session-last-accessed-time=1642073793267, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56334 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:33.293  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:33.298  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6313ce7f
2022-01-13 11:36:33.302  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6313ce7f
2022-01-13 11:36:33.347  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6313ce7f
2022-01-13 11:36:33.351  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6313ce7f
2022-01-13 11:36:33.441  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6313ce7f
2022-01-13 11:36:33.450  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:33.454  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:33.457  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6313ce7f
2022-01-13 11:36:33.502  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6313ce7f
2022-01-13 11:36:33.506  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:33.510  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:33.513  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6313ce7f
2022-01-13 11:36:33.551  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6313ce7f
2022-01-13 11:36:33.558  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6313ce7f
2022-01-13 11:36:33.623  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17086874237890-938002, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:33.626  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ddfb72ed-2985-4df7-b3b0-2a5ad2037ae9, content=DENY, timestamp=1642073793626, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:33.632  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=329ms, Total=347ms
2022-01-13 11:36:33.684  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d825e496-7926-4e15-9b8c-1b289716aa0d, content=null, timestamp=1642073793675, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56336, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073793673, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=B90E4BA59FCCE0BADDF89BF3EC243684, http-session-last-accessed-time=1642073793673, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56336 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:33.691  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:33.708  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de14699
2022-01-13 11:36:33.712  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de14699
2022-01-13 11:36:33.763  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de14699
2022-01-13 11:36:33.768  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de14699
2022-01-13 11:36:33.850  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de14699
2022-01-13 11:36:33.853  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:33.857  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:33.860  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de14699
2022-01-13 11:36:33.952  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de14699
2022-01-13 11:36:33.955  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:33.960  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:33.963  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de14699
2022-01-13 11:36:34.068  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de14699
2022-01-13 11:36:34.072  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de14699
2022-01-13 11:36:34.142  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17087271490090-945887, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:34.145  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d825e496-7926-4e15-9b8c-1b289716aa0d, content=DENY, timestamp=1642073794145, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:34.151  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=451ms, Total=469ms
2022-01-13 11:36:34.230  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ac3edba5-7b81-4043-b00e-7be8710a3311, content=null, timestamp=1642073794197, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56338, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073794192, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=4B1D0EFCF89BEF683E8F4EC3828F063E, http-session-last-accessed-time=1642073794192, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56338 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:34.246  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:34.250  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@265f10d6
2022-01-13 11:36:34.253  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@265f10d6
2022-01-13 11:36:34.318  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@265f10d6
2022-01-13 11:36:34.321  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@265f10d6
2022-01-13 11:36:34.342  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@265f10d6
2022-01-13 11:36:34.345  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:34.348  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:34.354  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@265f10d6
2022-01-13 11:36:34.421  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@265f10d6
2022-01-13 11:36:34.426  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:34.429  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:34.433  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@265f10d6
2022-01-13 11:36:34.465  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@265f10d6
2022-01-13 11:36:34.471  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@265f10d6
2022-01-13 11:36:34.504  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17087825732690-75097, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:34.516  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ac3edba5-7b81-4043-b00e-7be8710a3311, content=DENY, timestamp=1642073794516, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:34.520  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=268ms, Total=293ms
2022-01-13 11:36:34.576  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=eba64b72-9506-4be8-ac24-3d10a36beac3, content=null, timestamp=1642073794565, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56340, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073794563, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=255E93E12E465D2BA8561F5A44CA6400, http-session-last-accessed-time=1642073794563, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56340 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:34.582  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:34.597  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c45271a
2022-01-13 11:36:34.606  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c45271a
2022-01-13 11:36:34.644  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c45271a
2022-01-13 11:36:34.648  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c45271a
2022-01-13 11:36:34.720  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c45271a
2022-01-13 11:36:34.724  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:34.727  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:34.730  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c45271a
2022-01-13 11:36:34.769  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c45271a
2022-01-13 11:36:34.776  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:34.780  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:34.785  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c45271a
2022-01-13 11:36:34.819  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c45271a
2022-01-13 11:36:34.825  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c45271a
2022-01-13 11:36:34.898  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17088164050790-214968, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:34.901  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=eba64b72-9506-4be8-ac24-3d10a36beac3, content=DENY, timestamp=1642073794901, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:34.905  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=315ms, Total=332ms
2022-01-13 11:36:34.952  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=986e51c6-45d0-4f93-a2b4-a0a808d6a071, content=null, timestamp=1642073794939, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56342, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073794937, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=CC26AA9C9E63FAAEB353C03E64003D58, http-session-last-accessed-time=1642073794937, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56342 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:34.958  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:34.970  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@774225ff
2022-01-13 11:36:34.979  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@774225ff
2022-01-13 11:36:35.033  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@774225ff
2022-01-13 11:36:35.038  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@774225ff
2022-01-13 11:36:35.092  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@774225ff
2022-01-13 11:36:35.095  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:35.098  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:35.103  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@774225ff
2022-01-13 11:36:35.145  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@774225ff
2022-01-13 11:36:35.150  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:35.153  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:35.158  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@774225ff
2022-01-13 11:36:35.240  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@774225ff
2022-01-13 11:36:35.245  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@774225ff
2022-01-13 11:36:35.275  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17088537964590-370049, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:35.279  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=986e51c6-45d0-4f93-a2b4-a0a808d6a071, content=DENY, timestamp=1642073795279, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:35.282  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=319ms, Total=332ms
2022-01-13 11:36:35.382  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=59f5c090-90a7-4a27-85ee-2ce758ff5e8e, content=null, timestamp=1642073795346, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56344, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073795323, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=74718B5A88F51B2B393157944EB60B3F, http-session-last-accessed-time=1642073795323, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56344 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:35.391  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:35.412  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5938203c
2022-01-13 11:36:35.414  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5938203c
2022-01-13 11:36:35.480  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5938203c
2022-01-13 11:36:35.482  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5938203c
2022-01-13 11:36:35.535  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5938203c
2022-01-13 11:36:35.537  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:35.543  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:35.546  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5938203c
2022-01-13 11:36:35.628  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5938203c
2022-01-13 11:36:35.631  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:35.635  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:35.638  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5938203c
2022-01-13 11:36:35.723  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5938203c
2022-01-13 11:36:35.725  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5938203c
2022-01-13 11:36:35.778  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17088974325090-984848, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:35.781  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=59f5c090-90a7-4a27-85ee-2ce758ff5e8e, content=DENY, timestamp=1642073795781, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:35.784  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=384ms, Total=404ms
2022-01-13 11:36:35.833  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c0158a63-835d-4158-a3a6-0ce0c4913023, content=null, timestamp=1642073795823, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56346, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073795821, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=2B4961BE1F547F6A94C36EC1808CB908, http-session-last-accessed-time=1642073795821, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56346 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:35.838  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:35.848  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f921819
2022-01-13 11:36:35.852  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f921819
2022-01-13 11:36:35.883  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f921819
2022-01-13 11:36:35.892  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f921819
2022-01-13 11:36:35.958  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f921819
2022-01-13 11:36:35.961  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:35.964  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:35.969  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f921819
2022-01-13 11:36:36.002  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f921819
2022-01-13 11:36:36.005  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:36.009  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:36.015  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f921819
2022-01-13 11:36:36.045  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f921819
2022-01-13 11:36:36.049  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f921819
2022-01-13 11:36:36.133  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17089420325590-494551, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:36.137  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c0158a63-835d-4158-a3a6-0ce0c4913023, content=DENY, timestamp=1642073796137, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:36.145  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=295ms, Total=314ms
2022-01-13 11:36:36.221  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b0bead27-671d-42ef-82cb-9d23f374b8c8, content=null, timestamp=1642073796212, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56348, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073796196, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=90AD86C22697B8E7DB962547AA05709C, http-session-last-accessed-time=1642073796196, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56348 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:36.227  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:36.239  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca25772
2022-01-13 11:36:36.242  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca25772
2022-01-13 11:36:36.310  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca25772
2022-01-13 11:36:36.313  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca25772
2022-01-13 11:36:36.372  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca25772
2022-01-13 11:36:36.376  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:36.379  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:36.381  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca25772
2022-01-13 11:36:36.421  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca25772
2022-01-13 11:36:36.424  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:36.428  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:36.431  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca25772
2022-01-13 11:36:36.512  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca25772
2022-01-13 11:36:36.516  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ca25772
2022-01-13 11:36:36.542  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17089813847990-265063, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:36.545  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b0bead27-671d-42ef-82cb-9d23f374b8c8, content=DENY, timestamp=1642073796545, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:36.549  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=309ms, Total=330ms
2022-01-13 11:36:36.601  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a9e96a90-f2b7-4703-bd9b-e4966257ef2b, content=null, timestamp=1642073796590, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56350, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073796587, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9BAE85680E34F0B73A408D5DCB930C43, http-session-last-accessed-time=1642073796587, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56350 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:36.607  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:36.612  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619b32b9
2022-01-13 11:36:36.617  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619b32b9
2022-01-13 11:36:36.647  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619b32b9
2022-01-13 11:36:36.651  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619b32b9
2022-01-13 11:36:36.686  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619b32b9
2022-01-13 11:36:36.691  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:36.694  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:36.695  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619b32b9
2022-01-13 11:36:36.767  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619b32b9
2022-01-13 11:36:36.771  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:36.774  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:36.776  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619b32b9
2022-01-13 11:36:36.834  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619b32b9
2022-01-13 11:36:36.838  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619b32b9
2022-01-13 11:36:36.906  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17090187659890-332531, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:36.908  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a9e96a90-f2b7-4703-bd9b-e4966257ef2b, content=DENY, timestamp=1642073796908, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:36.913  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=298ms, Total=316ms
2022-01-13 11:36:36.972  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3a8bc9c0-b14a-40b3-ac55-1f89be644bd6, content=null, timestamp=1642073796964, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56352, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073796962, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=D72F11DF1E58DE35A77DED2698F58886, http-session-last-accessed-time=1642073796962, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56352 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:36.982  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:36.992  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@278288ba
2022-01-13 11:36:36.996  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@278288ba
2022-01-13 11:36:37.050  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@278288ba
2022-01-13 11:36:37.054  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@278288ba
2022-01-13 11:36:37.146  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@278288ba
2022-01-13 11:36:37.149  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:37.153  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:37.159  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@278288ba
2022-01-13 11:36:37.210  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@278288ba
2022-01-13 11:36:37.213  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:37.221  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:37.225  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@278288ba
2022-01-13 11:36:37.255  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@278288ba
2022-01-13 11:36:37.260  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@278288ba
2022-01-13 11:36:37.324  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17090567863490-713242, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:37.331  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3a8bc9c0-b14a-40b3-ac55-1f89be644bd6, content=DENY, timestamp=1642073797331, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:37.335  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=341ms, Total=365ms
2022-01-13 11:36:37.392  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d82d655f-a5b9-4018-a828-175df389ae13, content=null, timestamp=1642073797385, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56354, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073797381, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=C33AECAC64CD25446999E2D332C66F49, http-session-last-accessed-time=1642073797381, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56354 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:37.400  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:37.406  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7eb76bf7
2022-01-13 11:36:37.409  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7eb76bf7
2022-01-13 11:36:37.444  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7eb76bf7
2022-01-13 11:36:37.450  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7eb76bf7
2022-01-13 11:36:37.502  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7eb76bf7
2022-01-13 11:36:37.505  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:37.507  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:37.513  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7eb76bf7
2022-01-13 11:36:37.556  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7eb76bf7
2022-01-13 11:36:37.559  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:37.561  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:37.564  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7eb76bf7
2022-01-13 11:36:37.628  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7eb76bf7
2022-01-13 11:36:37.631  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7eb76bf7
2022-01-13 11:36:37.663  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17090982514290-817896, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:37.676  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d82d655f-a5b9-4018-a828-175df389ae13, content=DENY, timestamp=1642073797676, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:37.680  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=271ms, Total=290ms
2022-01-13 11:36:37.745  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3b799d81-8960-4c4c-b080-3e3d545361fb, content=null, timestamp=1642073797735, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56356, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073797733, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9AEA3C78BC0BA8623A54708A0D959382, http-session-last-accessed-time=1642073797733, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56356 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:37.752  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:37.759  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6771ef98
2022-01-13 11:36:37.764  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6771ef98
2022-01-13 11:36:37.806  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6771ef98
2022-01-13 11:36:37.811  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6771ef98
2022-01-13 11:36:37.852  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6771ef98
2022-01-13 11:36:37.859  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:37.862  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:37.865  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6771ef98
2022-01-13 11:36:37.933  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6771ef98
2022-01-13 11:36:37.936  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:37.939  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:37.942  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6771ef98
2022-01-13 11:36:37.979  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6771ef98
2022-01-13 11:36:37.984  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6771ef98
2022-01-13 11:36:38.018  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17091335027490-214194, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:38.020  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3b799d81-8960-4c4c-b080-3e3d545361fb, content=DENY, timestamp=1642073798020, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:38.024  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=262ms, Total=281ms
2022-01-13 11:36:38.072  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2f29c29b-b277-4845-bb35-228f4c3333fe, content=null, timestamp=1642073798060, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56358, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073798057, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=028ACE2D15B0E6ECF9ECA5C8CDEB09E3, http-session-last-accessed-time=1642073798057, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56358 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:38.079  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:38.088  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@40cc79c
2022-01-13 11:36:38.092  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@40cc79c
2022-01-13 11:36:38.126  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@40cc79c
2022-01-13 11:36:38.130  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@40cc79c
2022-01-13 11:36:38.214  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@40cc79c
2022-01-13 11:36:38.218  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:38.225  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:38.228  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@40cc79c
2022-01-13 11:36:38.262  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@40cc79c
2022-01-13 11:36:38.273  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:38.276  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:38.284  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@40cc79c
2022-01-13 11:36:38.336  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@40cc79c
2022-01-13 11:36:38.341  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@40cc79c
2022-01-13 11:36:38.422  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17091662075990-800485, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:38.426  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2f29c29b-b277-4845-bb35-228f4c3333fe, content=DENY, timestamp=1642073798426, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:38.429  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=342ms, Total=359ms
2022-01-13 11:36:38.485  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=03f473ef-827e-4798-9ba9-d134d7bc4e77, content=null, timestamp=1642073798475, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56360, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073798473, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=FF4BA7095EBBEB5B3CCD3272AA1B2230, http-session-last-accessed-time=1642073798473, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56360 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:38.493  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:38.505  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b6036fd
2022-01-13 11:36:38.509  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b6036fd
2022-01-13 11:36:38.547  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b6036fd
2022-01-13 11:36:38.552  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b6036fd
2022-01-13 11:36:38.592  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b6036fd
2022-01-13 11:36:38.595  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:38.600  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:38.606  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b6036fd
2022-01-13 11:36:38.676  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b6036fd
2022-01-13 11:36:38.679  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:38.681  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:38.685  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b6036fd
2022-01-13 11:36:38.802  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b6036fd
2022-01-13 11:36:38.804  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b6036fd
2022-01-13 11:36:38.836  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17092075561890-262723, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:38.840  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=03f473ef-827e-4798-9ba9-d134d7bc4e77, content=DENY, timestamp=1642073798840, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:38.846  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=342ms, Total=363ms
2022-01-13 11:36:38.883  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e2614f31-37cf-4715-afc7-68b6f00390cc, content=null, timestamp=1642073798875, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56362, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073798872, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=C537E897DA6F4F4B1B903C7319319A9B, http-session-last-accessed-time=1642073798872, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56362 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:38.887  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:38.895  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@632c6836
2022-01-13 11:36:38.900  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@632c6836
2022-01-13 11:36:38.937  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@632c6836
2022-01-13 11:36:38.942  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@632c6836
2022-01-13 11:36:39.017  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@632c6836
2022-01-13 11:36:39.019  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:39.023  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:39.025  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@632c6836
2022-01-13 11:36:39.057  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@632c6836
2022-01-13 11:36:39.062  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:39.066  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:39.073  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@632c6836
2022-01-13 11:36:39.098  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@632c6836
2022-01-13 11:36:39.100  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@632c6836
2022-01-13 11:36:39.181  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17092467351590-216316, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:39.183  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e2614f31-37cf-4715-afc7-68b6f00390cc, content=DENY, timestamp=1642073799183, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:39.186  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=293ms, Total=305ms
2022-01-13 11:36:39.231  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e3ebe933-aa4f-4a2f-8222-af12ed3f5278, content=null, timestamp=1642073799221, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56364, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073799219, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=86844CE3686752AC032CB51E7438A060, http-session-last-accessed-time=1642073799219, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56364 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:39.242  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:39.257  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68f783ed
2022-01-13 11:36:39.263  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68f783ed
2022-01-13 11:36:39.306  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68f783ed
2022-01-13 11:36:39.311  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68f783ed
2022-01-13 11:36:39.367  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68f783ed
2022-01-13 11:36:39.371  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:39.374  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:39.378  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68f783ed
2022-01-13 11:36:39.410  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68f783ed
2022-01-13 11:36:39.415  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:39.419  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:39.424  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68f783ed
2022-01-13 11:36:39.513  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68f783ed
2022-01-13 11:36:39.516  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68f783ed
2022-01-13 11:36:39.555  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17092833526290-356081, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:39.558  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e3ebe933-aa4f-4a2f-8222-af12ed3f5278, content=DENY, timestamp=1642073799558, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:39.576  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=302ms, Total=350ms
2022-01-13 11:36:39.622  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4530fef0-5c55-4f8d-a6f5-451679f0b8ae, content=null, timestamp=1642073799608, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56366, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073799606, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=01D53F25FA7E5C674DB42E0871DD2C13, http-session-last-accessed-time=1642073799606, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56366 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:39.629  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:39.633  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d57fd0c
2022-01-13 11:36:39.636  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d57fd0c
2022-01-13 11:36:39.661  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d57fd0c
2022-01-13 11:36:39.665  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d57fd0c
2022-01-13 11:36:39.698  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d57fd0c
2022-01-13 11:36:39.704  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:39.706  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:39.712  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d57fd0c
2022-01-13 11:36:39.786  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d57fd0c
2022-01-13 11:36:39.790  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:39.794  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:39.798  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d57fd0c
2022-01-13 11:36:39.839  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d57fd0c
2022-01-13 11:36:39.845  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d57fd0c
2022-01-13 11:36:39.879  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17093208876090-776595, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:39.886  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4530fef0-5c55-4f8d-a6f5-451679f0b8ae, content=DENY, timestamp=1642073799886, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:39.892  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=255ms, Total=272ms
2022-01-13 11:36:39.945  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a0ac452e-c5d9-4ab6-bb2e-f9dbfbe1e18f, content=null, timestamp=1642073799924, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56368, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073799922, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=64AA56B8C90FA909152E027566CD87F4, http-session-last-accessed-time=1642073799922, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56368 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:39.950  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:39.960  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@602226e8
2022-01-13 11:36:39.965  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@602226e8
2022-01-13 11:36:40.036  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@602226e8
2022-01-13 11:36:40.038  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@602226e8
2022-01-13 11:36:40.109  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@602226e8
2022-01-13 11:36:40.111  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:40.114  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:40.118  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@602226e8
2022-01-13 11:36:40.157  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@602226e8
2022-01-13 11:36:40.161  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:40.164  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:40.168  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@602226e8
2022-01-13 11:36:40.202  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@602226e8
2022-01-13 11:36:40.205  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@602226e8
2022-01-13 11:36:40.280  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17093533247290-489502, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:40.285  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a0ac452e-c5d9-4ab6-bb2e-f9dbfbe1e18f, content=DENY, timestamp=1642073800285, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:40.289  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=329ms, Total=351ms
2022-01-13 11:36:40.324  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=da53f672-9e39-4f94-85d0-7f51c4e39d93, content=null, timestamp=1642073800317, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56370, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073800314, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=FC93B1CD2F68B44C8F5376D35FEAA415, http-session-last-accessed-time=1642073800314, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56370 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:40.337  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:40.343  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5453998a
2022-01-13 11:36:40.346  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5453998a
2022-01-13 11:36:40.385  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5453998a
2022-01-13 11:36:40.387  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5453998a
2022-01-13 11:36:40.418  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5453998a
2022-01-13 11:36:40.421  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:40.425  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:40.435  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5453998a
2022-01-13 11:36:40.511  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5453998a
2022-01-13 11:36:40.513  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:40.515  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:40.518  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5453998a
2022-01-13 11:36:40.556  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5453998a
2022-01-13 11:36:40.562  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5453998a
2022-01-13 11:36:40.600  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17093918212290-701498, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:40.607  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=da53f672-9e39-4f94-85d0-7f51c4e39d93, content=DENY, timestamp=1642073800607, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:40.613  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=266ms, Total=291ms
2022-01-13 11:36:40.665  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b9d0d9aa-ca02-4125-b715-7bf5eea6ee8d, content=null, timestamp=1642073800656, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56372, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073800654, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=FD5B0E08AA61E1C3AB40689BEFF52DFC, http-session-last-accessed-time=1642073800654, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56372 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:40.669  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:40.675  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1753323c
2022-01-13 11:36:40.680  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1753323c
2022-01-13 11:36:40.726  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1753323c
2022-01-13 11:36:40.728  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1753323c
2022-01-13 11:36:40.840  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1753323c
2022-01-13 11:36:40.843  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:40.845  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:40.847  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1753323c
2022-01-13 11:36:40.881  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1753323c
2022-01-13 11:36:40.886  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:40.893  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:40.896  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1753323c
2022-01-13 11:36:40.949  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1753323c
2022-01-13 11:36:40.953  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1753323c
2022-01-13 11:36:41.073  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17094248637490-68372, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:41.076  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b9d0d9aa-ca02-4125-b715-7bf5eea6ee8d, content=DENY, timestamp=1642073801076, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:41.078  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=405ms, Total=414ms
2022-01-13 11:36:41.136  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=036227dc-5964-45d0-bf9c-8f3c990b5e24, content=null, timestamp=1642073801121, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56374, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073801114, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=32B9C744F199440A5C911C1F07D3D02F, http-session-last-accessed-time=1642073801114, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56374 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:41.144  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:41.152  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@63b8e50
2022-01-13 11:36:41.157  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@63b8e50
2022-01-13 11:36:41.196  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@63b8e50
2022-01-13 11:36:41.198  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@63b8e50
2022-01-13 11:36:41.236  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@63b8e50
2022-01-13 11:36:41.242  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:41.247  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:41.252  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@63b8e50
2022-01-13 11:36:41.292  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@63b8e50
2022-01-13 11:36:41.298  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:41.300  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:41.305  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@63b8e50
2022-01-13 11:36:41.371  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@63b8e50
2022-01-13 11:36:41.374  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@63b8e50
2022-01-13 11:36:41.407  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17094724617190-663475, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:41.410  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=036227dc-5964-45d0-bf9c-8f3c990b5e24, content=DENY, timestamp=1642073801410, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:41.414  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=263ms, Total=280ms
2022-01-13 11:36:41.459  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f7707cd7-ff57-4390-bd7b-cd5857299b60, content=null, timestamp=1642073801451, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56376, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073801450, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=B0E45C4403381FCDFB0E41CC9696207A, http-session-last-accessed-time=1642073801450, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56376 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:41.465  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:41.477  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d9bc5e8
2022-01-13 11:36:41.480  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d9bc5e8
2022-01-13 11:36:41.515  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d9bc5e8
2022-01-13 11:36:41.521  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d9bc5e8
2022-01-13 11:36:41.546  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d9bc5e8
2022-01-13 11:36:41.553  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:41.560  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:41.566  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d9bc5e8
2022-01-13 11:36:41.634  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d9bc5e8
2022-01-13 11:36:41.636  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:41.640  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:41.643  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d9bc5e8
2022-01-13 11:36:41.668  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d9bc5e8
2022-01-13 11:36:41.671  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d9bc5e8
2022-01-13 11:36:41.704  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17095052632090-784002, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:41.708  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f7707cd7-ff57-4390-bd7b-cd5857299b60, content=DENY, timestamp=1642073801708, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:41.712  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=232ms, Total=254ms
2022-01-13 11:36:41.805  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4644d78b-8d8a-4b8d-a3a9-50b814c465ff, content=null, timestamp=1642073801797, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56378, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073801783, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=79D74ECB0D04D2D7674727B3F776F0AE, http-session-last-accessed-time=1642073801783, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56378 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:41.812  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:41.816  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@41f55b90
2022-01-13 11:36:41.819  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@41f55b90
2022-01-13 11:36:41.859  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@41f55b90
2022-01-13 11:36:41.864  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@41f55b90
2022-01-13 11:36:41.940  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@41f55b90
2022-01-13 11:36:41.944  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:41.946  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:41.951  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@41f55b90
2022-01-13 11:36:41.983  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@41f55b90
2022-01-13 11:36:41.986  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:41.989  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:41.995  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@41f55b90
2022-01-13 11:36:42.037  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@41f55b90
2022-01-13 11:36:42.040  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@41f55b90
2022-01-13 11:36:42.118  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17095392532790-40488, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:42.122  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4644d78b-8d8a-4b8d-a3a9-50b814c465ff, content=DENY, timestamp=1642073802122, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:42.126  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=307ms, Total=323ms
2022-01-13 11:36:42.174  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e56ef202-66cc-4763-be59-120ca42b94b0, content=null, timestamp=1642073802156, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56380, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073802153, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=C5429177EA3764142983445521DB0E28, http-session-last-accessed-time=1642073802153, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56380 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:42.181  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:42.204  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18bd745
2022-01-13 11:36:42.210  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18bd745
2022-01-13 11:36:42.316  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18bd745
2022-01-13 11:36:42.322  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18bd745
2022-01-13 11:36:42.380  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18bd745
2022-01-13 11:36:42.383  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:42.386  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:42.388  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18bd745
2022-01-13 11:36:42.453  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18bd745
2022-01-13 11:36:42.455  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:42.458  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:42.460  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18bd745
2022-01-13 11:36:42.551  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18bd745
2022-01-13 11:36:42.555  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18bd745
2022-01-13 11:36:42.577  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17095770857090-567832, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:42.580  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e56ef202-66cc-4763-be59-120ca42b94b0, content=DENY, timestamp=1642073802580, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:42.586  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=387ms, Total=415ms
2022-01-13 11:36:42.640  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=195b3d19-7af9-4869-ada7-98ec3b47dd82, content=null, timestamp=1642073802633, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56382, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073802624, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=4E5A8238981AE32649C47AA768600C9E, http-session-last-accessed-time=1642073802624, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56382 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:42.648  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:42.655  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4096c501
2022-01-13 11:36:42.660  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4096c501
2022-01-13 11:36:42.685  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4096c501
2022-01-13 11:36:42.688  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4096c501
2022-01-13 11:36:42.719  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4096c501
2022-01-13 11:36:42.725  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:42.729  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:42.732  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4096c501
2022-01-13 11:36:42.806  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4096c501
2022-01-13 11:36:42.808  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:42.811  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:42.815  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4096c501
2022-01-13 11:36:42.845  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4096c501
2022-01-13 11:36:42.852  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4096c501
2022-01-13 11:36:42.892  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17096229569290-47568, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:42.897  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=195b3d19-7af9-4869-ada7-98ec3b47dd82, content=DENY, timestamp=1642073802897, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:42.899  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=245ms, Total=261ms
2022-01-13 11:36:42.946  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0a88e95e-f930-4ecb-ab4e-fa329b09663b, content=null, timestamp=1642073802940, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56384, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073802938, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=F1D88C88058C2456E00E78E453FB6CCF, http-session-last-accessed-time=1642073802938, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56384 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:42.951  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:42.955  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f83e60
2022-01-13 11:36:42.958  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f83e60
2022-01-13 11:36:42.996  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f83e60
2022-01-13 11:36:42.999  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f83e60
2022-01-13 11:36:43.072  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f83e60
2022-01-13 11:36:43.075  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:43.083  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:43.086  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f83e60
2022-01-13 11:36:43.110  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f83e60
2022-01-13 11:36:43.114  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:43.121  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:43.124  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f83e60
2022-01-13 11:36:43.158  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f83e60
2022-01-13 11:36:43.162  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f83e60
2022-01-13 11:36:43.237  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17096530936690-853267, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:43.240  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0a88e95e-f930-4ecb-ab4e-fa329b09663b, content=DENY, timestamp=1642073803240, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:43.247  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=287ms, Total=303ms
2022-01-13 11:36:43.293  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=59392ca0-2acd-44e6-b432-d8ddcec1633a, content=null, timestamp=1642073803285, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56386, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073803284, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=150DF08BFF9FA93CC441BAB813E77E70, http-session-last-accessed-time=1642073803284, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56386 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:43.300  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:43.305  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aabfca8
2022-01-13 11:36:43.307  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aabfca8
2022-01-13 11:36:43.333  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aabfca8
2022-01-13 11:36:43.337  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aabfca8
2022-01-13 11:36:43.362  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aabfca8
2022-01-13 11:36:43.365  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:43.368  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:43.373  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aabfca8
2022-01-13 11:36:43.452  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aabfca8
2022-01-13 11:36:43.454  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:43.456  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:43.459  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aabfca8
2022-01-13 11:36:43.477  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aabfca8
2022-01-13 11:36:43.482  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aabfca8
2022-01-13 11:36:43.520  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17096880337090-66298, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:43.522  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=59392ca0-2acd-44e6-b432-d8ddcec1633a, content=DENY, timestamp=1642073803522, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:43.535  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=219ms, Total=243ms
2022-01-13 11:36:43.618  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=83962b22-8970-4fbf-bf9d-0f3bd61d2df8, content=null, timestamp=1642073803594, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56388, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073803586, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=61D6F6871B4B661EDFD2343DF567176E, http-session-last-accessed-time=1642073803586, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56388 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:43.627  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:43.658  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c82248e
2022-01-13 11:36:43.666  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c82248e
2022-01-13 11:36:43.737  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c82248e
2022-01-13 11:36:43.740  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c82248e
2022-01-13 11:36:43.829  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c82248e
2022-01-13 11:36:43.832  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:43.833  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:43.836  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c82248e
2022-01-13 11:36:43.869  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c82248e
2022-01-13 11:36:43.871  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:43.879  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:43.883  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c82248e
2022-01-13 11:36:43.911  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c82248e
2022-01-13 11:36:43.914  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c82248e
2022-01-13 11:36:43.988  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17097212379290-387705, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:43.991  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=83962b22-8970-4fbf-bf9d-0f3bd61d2df8, content=DENY, timestamp=1642073803991, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:43.994  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=356ms, Total=380ms
2022-01-13 11:36:44.030  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=13e9c8a9-fbb3-4a5f-9498-f53ee0fb4caa, content=null, timestamp=1642073804022, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56390, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073804020, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=EEF19C75F52C19FAD12748F909AC9295, http-session-last-accessed-time=1642073804020, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56390 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:44.036  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:44.042  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67c02cd2
2022-01-13 11:36:44.049  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67c02cd2
2022-01-13 11:36:44.094  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67c02cd2
2022-01-13 11:36:44.097  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67c02cd2
2022-01-13 11:36:44.129  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67c02cd2
2022-01-13 11:36:44.133  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:44.136  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:44.151  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67c02cd2
2022-01-13 11:36:44.229  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67c02cd2
2022-01-13 11:36:44.231  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:44.234  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:44.236  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67c02cd2
2022-01-13 11:36:44.267  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67c02cd2
2022-01-13 11:36:44.270  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67c02cd2
2022-01-13 11:36:44.307  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17097617587790-42893, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:44.309  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=13e9c8a9-fbb3-4a5f-9498-f53ee0fb4caa, content=DENY, timestamp=1642073804309, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:44.316  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=269ms, Total=288ms
2022-01-13 11:36:44.356  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=287a66aa-cb77-4610-aef2-d96d1ff9d2f6, content=null, timestamp=1642073804348, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56392, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073804344, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=D6A92C0494294DE75C4D3F481FCF8973, http-session-last-accessed-time=1642073804344, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56392 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:44.362  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:44.371  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2b7d5039
2022-01-13 11:36:44.374  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2b7d5039
2022-01-13 11:36:44.414  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2b7d5039
2022-01-13 11:36:44.417  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2b7d5039
2022-01-13 11:36:44.492  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2b7d5039
2022-01-13 11:36:44.496  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:44.499  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:44.502  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2b7d5039
2022-01-13 11:36:44.531  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2b7d5039
2022-01-13 11:36:44.535  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:44.537  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:44.542  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2b7d5039
2022-01-13 11:36:44.593  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2b7d5039
2022-01-13 11:36:44.596  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2b7d5039
2022-01-13 11:36:44.668  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17097944918790-492759, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:44.672  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=287a66aa-cb77-4610-aef2-d96d1ff9d2f6, content=DENY, timestamp=1642073804672, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:44.677  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=305ms, Total=323ms
2022-01-13 11:36:44.729  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=051cf9c7-07da-496b-ba71-ddf89cd692ac, content=null, timestamp=1642073804718, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56394, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073804716, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=CAE9371F59638710A1A6E90E2A22DA73, http-session-last-accessed-time=1642073804716, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56394 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:44.736  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:44.742  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75d59e6e
2022-01-13 11:36:44.746  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75d59e6e
2022-01-13 11:36:44.776  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75d59e6e
2022-01-13 11:36:44.784  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75d59e6e
2022-01-13 11:36:44.877  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75d59e6e
2022-01-13 11:36:44.880  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:44.884  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:44.887  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75d59e6e
2022-01-13 11:36:44.933  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75d59e6e
2022-01-13 11:36:44.935  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:44.938  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:44.944  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75d59e6e
2022-01-13 11:36:45.028  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75d59e6e
2022-01-13 11:36:45.032  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75d59e6e
2022-01-13 11:36:45.074  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17098317815590-708790, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:45.079  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=051cf9c7-07da-496b-ba71-ddf89cd692ac, content=DENY, timestamp=1642073805079, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:45.089  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=339ms, Total=364ms
2022-01-13 11:36:45.156  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2c828edf-671e-4e0d-b145-6e28a0e69fe6, content=null, timestamp=1642073805142, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56396, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073805133, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=EE73F259A17A4C89DC563092B81B73DB, http-session-last-accessed-time=1642073805133, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56396 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:45.162  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:45.167  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7de63e25
2022-01-13 11:36:45.172  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7de63e25
2022-01-13 11:36:45.219  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7de63e25
2022-01-13 11:36:45.221  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7de63e25
2022-01-13 11:36:45.254  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7de63e25
2022-01-13 11:36:45.258  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:45.261  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:45.265  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7de63e25
2022-01-13 11:36:45.351  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7de63e25
2022-01-13 11:36:45.355  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:45.358  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:45.360  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7de63e25
2022-01-13 11:36:45.394  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7de63e25
2022-01-13 11:36:45.399  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7de63e25
2022-01-13 11:36:45.443  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17098742548790-352164, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:45.448  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2c828edf-671e-4e0d-b145-6e28a0e69fe6, content=DENY, timestamp=1642073805448, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:45.451  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=283ms, Total=297ms
2022-01-13 11:36:45.495  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=cb423753-3458-4ca3-913c-ba3eb081c414, content=null, timestamp=1642073805484, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56398, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073805483, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=B592E47BFAC7C27B18D02AC4F9934CF7, http-session-last-accessed-time=1642073805483, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56398 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:45.502  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:45.509  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780c9e2f
2022-01-13 11:36:45.514  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780c9e2f
2022-01-13 11:36:45.584  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780c9e2f
2022-01-13 11:36:45.587  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780c9e2f
2022-01-13 11:36:45.617  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780c9e2f
2022-01-13 11:36:45.621  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:45.624  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:45.626  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780c9e2f
2022-01-13 11:36:45.688  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780c9e2f
2022-01-13 11:36:45.692  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:45.695  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:45.699  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780c9e2f
2022-01-13 11:36:45.784  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780c9e2f
2022-01-13 11:36:45.788  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780c9e2f
2022-01-13 11:36:45.827  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17099084201290-390712, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:45.829  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=cb423753-3458-4ca3-913c-ba3eb081c414, content=DENY, timestamp=1642073805829, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:45.832  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=322ms, Total=338ms
2022-01-13 11:36:45.891  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2bd91225-fd5a-4e53-8929-58ead6e69ec9, content=null, timestamp=1642073805880, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56400, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073805879, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=CF884E26DD3AA723599A582A61DA3C58, http-session-last-accessed-time=1642073805879, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56400 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:45.914  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:45.947  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18d9ae94
2022-01-13 11:36:45.965  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18d9ae94
2022-01-13 11:36:46.092  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18d9ae94
2022-01-13 11:36:46.095  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18d9ae94
2022-01-13 11:36:46.168  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18d9ae94
2022-01-13 11:36:46.171  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:46.175  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:46.179  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18d9ae94
2022-01-13 11:36:46.282  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18d9ae94
2022-01-13 11:36:46.286  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:46.289  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:46.315  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18d9ae94
2022-01-13 11:36:46.393  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18d9ae94
2022-01-13 11:36:46.399  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18d9ae94
2022-01-13 11:36:46.514  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17099496331890-888594, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:46.519  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2bd91225-fd5a-4e53-8929-58ead6e69ec9, content=DENY, timestamp=1642073806519, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:46.522  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=600ms, Total=635ms
2022-01-13 11:36:46.597  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c25a06b6-5e8c-41fc-9342-65851e4dde67, content=null, timestamp=1642073806571, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56402, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073806565, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=516ABE2037395C638887E14130F9E5A9, http-session-last-accessed-time=1642073806565, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56402 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:46.612  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:46.619  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fa2c8cf
2022-01-13 11:36:46.622  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fa2c8cf
2022-01-13 11:36:46.701  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fa2c8cf
2022-01-13 11:36:46.705  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fa2c8cf
2022-01-13 11:36:46.747  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fa2c8cf
2022-01-13 11:36:46.752  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:46.754  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:46.757  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fa2c8cf
2022-01-13 11:36:46.778  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fa2c8cf
2022-01-13 11:36:46.782  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:46.785  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:46.791  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fa2c8cf
2022-01-13 11:36:46.869  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fa2c8cf
2022-01-13 11:36:46.873  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fa2c8cf
2022-01-13 11:36:46.902  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17100195050190-633782, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:46.909  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c25a06b6-5e8c-41fc-9342-65851e4dde67, content=DENY, timestamp=1642073806909, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:46.912  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=291ms, Total=331ms
2022-01-13 11:36:46.979  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9abeb7fe-d3f1-462c-8446-db53bcce9df8, content=null, timestamp=1642073806961, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56404, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073806959, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=449B2AC76F8A06C4330A21776C25E52F, http-session-last-accessed-time=1642073806959, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56404 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:46.984  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:46.989  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bd595dd
2022-01-13 11:36:46.993  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bd595dd
2022-01-13 11:36:47.029  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bd595dd
2022-01-13 11:36:47.032  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bd595dd
2022-01-13 11:36:47.066  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bd595dd
2022-01-13 11:36:47.070  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:47.074  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:47.077  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bd595dd
2022-01-13 11:36:47.147  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bd595dd
2022-01-13 11:36:47.155  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:47.160  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:47.169  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bd595dd
2022-01-13 11:36:47.220  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bd595dd
2022-01-13 11:36:47.223  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bd595dd
2022-01-13 11:36:47.268  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17100563982790-487828, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:47.271  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9abeb7fe-d3f1-462c-8446-db53bcce9df8, content=DENY, timestamp=1642073807271, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:47.275  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=285ms, Total=299ms
2022-01-13 11:36:47.337  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2a7ab8ac-2a8e-412f-9f7d-a7957f46cfc1, content=null, timestamp=1642073807325, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56406, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073807320, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=6878AAEC6B216F41DAC05D091AC9924F, http-session-last-accessed-time=1642073807320, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56406 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:47.343  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:47.354  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18c642ac
2022-01-13 11:36:47.357  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18c642ac
2022-01-13 11:36:47.402  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18c642ac
2022-01-13 11:36:47.404  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18c642ac
2022-01-13 11:36:47.478  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18c642ac
2022-01-13 11:36:47.483  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:47.487  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:47.491  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18c642ac
2022-01-13 11:36:47.557  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18c642ac
2022-01-13 11:36:47.565  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:47.568  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:47.572  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18c642ac
2022-01-13 11:36:47.603  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18c642ac
2022-01-13 11:36:47.612  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18c642ac
2022-01-13 11:36:47.690  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17100924821090-840295, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:47.696  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2a7ab8ac-2a8e-412f-9f7d-a7957f46cfc1, content=DENY, timestamp=1642073807696, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:47.702  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=349ms, Total=368ms
2022-01-13 11:36:47.793  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7c68df9d-3df3-4ba3-8fcf-40dd28cedf2d, content=null, timestamp=1642073807757, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56408, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073807753, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=0FCDF7143DA079DAE4F37D350F173507, http-session-last-accessed-time=1642073807753, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56408 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:47.801  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:47.806  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@81ccce0
2022-01-13 11:36:47.811  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@81ccce0
2022-01-13 11:36:47.872  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@81ccce0
2022-01-13 11:36:47.876  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@81ccce0
2022-01-13 11:36:47.924  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@81ccce0
2022-01-13 11:36:47.928  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:47.933  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:47.937  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@81ccce0
2022-01-13 11:36:47.990  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@81ccce0
2022-01-13 11:36:47.994  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:47.996  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:47.999  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@81ccce0
2022-01-13 11:36:48.103  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@81ccce0
2022-01-13 11:36:48.109  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@81ccce0
2022-01-13 11:36:48.138  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17101382500690-46918, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:48.142  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7c68df9d-3df3-4ba3-8fcf-40dd28cedf2d, content=DENY, timestamp=1642073808142, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:48.149  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=337ms, Total=368ms
2022-01-13 11:36:48.221  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8af8d644-8c94-4b34-b1d7-a16cf8064f7d, content=null, timestamp=1642073808207, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56410, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073808198, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9DC8269C2D34B60AA10478198E8FC7A6, http-session-last-accessed-time=1642073808198, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56410 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:48.231  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:48.245  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d56ca79
2022-01-13 11:36:48.248  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d56ca79
2022-01-13 11:36:48.301  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d56ca79
2022-01-13 11:36:48.305  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d56ca79
2022-01-13 11:36:48.333  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d56ca79
2022-01-13 11:36:48.342  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:48.347  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:48.349  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d56ca79
2022-01-13 11:36:48.424  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d56ca79
2022-01-13 11:36:48.427  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:48.429  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:48.431  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d56ca79
2022-01-13 11:36:48.479  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d56ca79
2022-01-13 11:36:48.481  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d56ca79
2022-01-13 11:36:48.532  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17101812124290-723082, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:48.535  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8af8d644-8c94-4b34-b1d7-a16cf8064f7d, content=DENY, timestamp=1642073808535, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:48.538  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=301ms, Total=320ms
2022-01-13 11:36:48.605  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4182068a-da63-45ad-9118-bd437b86cddd, content=null, timestamp=1642073808591, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56412, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073808580, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=7EE637C9F40339C089E66FE35B0B1F84, http-session-last-accessed-time=1642073808580, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56412 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:48.611  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:48.632  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@56c162f3
2022-01-13 11:36:48.644  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@56c162f3
2022-01-13 11:36:48.675  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@56c162f3
2022-01-13 11:36:48.680  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@56c162f3
2022-01-13 11:36:48.793  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@56c162f3
2022-01-13 11:36:48.797  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:48.805  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:48.812  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@56c162f3
2022-01-13 11:36:48.871  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@56c162f3
2022-01-13 11:36:48.874  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:48.878  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:48.884  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@56c162f3
2022-01-13 11:36:48.939  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@56c162f3
2022-01-13 11:36:48.942  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@56c162f3
2022-01-13 11:36:49.009  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17102196696990-8603, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:49.014  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4182068a-da63-45ad-9118-bd437b86cddd, content=DENY, timestamp=1642073809014, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:49.018  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=395ms, Total=414ms
2022-01-13 11:36:49.068  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ff2e8bf2-33f7-43a4-8afb-10247de827c9, content=null, timestamp=1642073809058, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56414, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073809057, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=545B59ECF09F0691DA87EFBE9A9AFEC0, http-session-last-accessed-time=1642073809057, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56414 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:49.082  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:49.089  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1cea3368
2022-01-13 11:36:49.105  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1cea3368
2022-01-13 11:36:49.187  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1cea3368
2022-01-13 11:36:49.197  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1cea3368
2022-01-13 11:36:49.238  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1cea3368
2022-01-13 11:36:49.241  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:49.244  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:49.248  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1cea3368
2022-01-13 11:36:49.319  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1cea3368
2022-01-13 11:36:49.323  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:49.325  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:49.329  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1cea3368
2022-01-13 11:36:49.433  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1cea3368
2022-01-13 11:36:49.440  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1cea3368
2022-01-13 11:36:49.472  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17102664989890-946317, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:49.475  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ff2e8bf2-33f7-43a4-8afb-10247de827c9, content=DENY, timestamp=1642073809475, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:49.480  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=388ms, Total=414ms
2022-01-13 11:36:49.540  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=02a36a5d-f181-47ea-afad-bbc9f52ed752, content=null, timestamp=1642073809526, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56416, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073809523, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=0CAE19A071EBAC05B54C67C8ADC307BB, http-session-last-accessed-time=1642073809523, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56416 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:49.544  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:49.548  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fd8070c
2022-01-13 11:36:49.552  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fd8070c
2022-01-13 11:36:49.586  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fd8070c
2022-01-13 11:36:49.589  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fd8070c
2022-01-13 11:36:49.662  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fd8070c
2022-01-13 11:36:49.665  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:49.667  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:49.670  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fd8070c
2022-01-13 11:36:49.716  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fd8070c
2022-01-13 11:36:49.719  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:49.723  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:49.726  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fd8070c
2022-01-13 11:36:49.765  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fd8070c
2022-01-13 11:36:49.772  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fd8070c
2022-01-13 11:36:49.855  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17103124156990-534054, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:49.860  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=02a36a5d-f181-47ea-afad-bbc9f52ed752, content=DENY, timestamp=1642073809860, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:49.865  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=313ms, Total=327ms
2022-01-13 11:36:49.898  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ef5f17e5-885e-42b2-9dc3-8024f89ef076, content=null, timestamp=1642073809890, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56418, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073809889, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=76CBA9F9FD5594B657E422C7AF444DA4, http-session-last-accessed-time=1642073809889, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56418 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:49.911  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:49.914  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693adb90
2022-01-13 11:36:49.917  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693adb90
2022-01-13 11:36:49.954  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693adb90
2022-01-13 11:36:49.960  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693adb90
2022-01-13 11:36:49.988  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693adb90
2022-01-13 11:36:49.991  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:49.994  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:49.999  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693adb90
2022-01-13 11:36:50.074  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693adb90
2022-01-13 11:36:50.079  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:50.082  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:50.087  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693adb90
2022-01-13 11:36:50.116  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693adb90
2022-01-13 11:36:50.121  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@693adb90
2022-01-13 11:36:50.154  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17103490337090-754128, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:50.159  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ef5f17e5-885e-42b2-9dc3-8024f89ef076, content=DENY, timestamp=1642073810159, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:50.174  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=246ms, Total=277ms
2022-01-13 11:36:50.228  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7cba424f-c928-4b51-9c07-85289955bf1e, content=null, timestamp=1642073810218, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56420, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073810214, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=091B90DB08691491E3F5312C026ED829, http-session-last-accessed-time=1642073810214, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56420 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:50.235  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:50.239  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f4439fc
2022-01-13 11:36:50.251  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f4439fc
2022-01-13 11:36:50.288  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f4439fc
2022-01-13 11:36:50.293  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f4439fc
2022-01-13 11:36:50.363  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f4439fc
2022-01-13 11:36:50.366  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:50.368  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:50.374  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f4439fc
2022-01-13 11:36:50.432  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f4439fc
2022-01-13 11:36:50.436  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:50.438  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:50.441  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f4439fc
2022-01-13 11:36:50.512  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f4439fc
2022-01-13 11:36:50.516  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f4439fc
2022-01-13 11:36:50.630  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17103814072890-237661, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:50.636  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7cba424f-c928-4b51-9c07-85289955bf1e, content=DENY, timestamp=1642073810636, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:50.641  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=399ms, Total=414ms
2022-01-13 11:36:50.711  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e5c9ad8e-a9dc-4451-9e5d-9b7bd586d901, content=null, timestamp=1642073810694, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56422, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073810681, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=18CB05D3266916F3BA29BF0DDF9FF30D, http-session-last-accessed-time=1642073810681, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56422 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:50.719  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:50.727  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10f0861d
2022-01-13 11:36:50.734  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10f0861d
2022-01-13 11:36:50.767  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10f0861d
2022-01-13 11:36:50.770  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10f0861d
2022-01-13 11:36:50.847  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10f0861d
2022-01-13 11:36:50.851  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:50.854  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:50.857  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10f0861d
2022-01-13 11:36:50.914  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10f0861d
2022-01-13 11:36:50.921  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:50.925  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:50.929  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10f0861d
2022-01-13 11:36:51.009  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10f0861d
2022-01-13 11:36:51.012  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10f0861d
2022-01-13 11:36:51.060  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17104299518590-310005, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:51.072  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e5c9ad8e-a9dc-4451-9e5d-9b7bd586d901, content=DENY, timestamp=1642073811072, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:51.080  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=350ms, Total=370ms
2022-01-13 11:36:51.143  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bbd1b60e-0934-48b1-a68c-1fd6848da4b2, content=null, timestamp=1642073811128, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56424, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073811125, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=4A0D9DE690FB573894C985E1D28B1BF7, http-session-last-accessed-time=1642073811125, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56424 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:51.149  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:51.170  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d2fff15
2022-01-13 11:36:51.175  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d2fff15
2022-01-13 11:36:51.239  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d2fff15
2022-01-13 11:36:51.245  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d2fff15
2022-01-13 11:36:51.322  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d2fff15
2022-01-13 11:36:51.327  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:51.334  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:51.338  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d2fff15
2022-01-13 11:36:51.427  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d2fff15
2022-01-13 11:36:51.435  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:51.440  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:51.445  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d2fff15
2022-01-13 11:36:51.502  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d2fff15
2022-01-13 11:36:51.505  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d2fff15
2022-01-13 11:36:51.584  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17104733032690-829210, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:51.586  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bbd1b60e-0934-48b1-a68c-1fd6848da4b2, content=DENY, timestamp=1642073811586, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:51.591  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=431ms, Total=450ms
2022-01-13 11:36:51.644  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5b0bdae8-f388-4eaa-822c-988976cb8377, content=null, timestamp=1642073811638, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56426, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073811626, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=86A42CAF31D05C3BEBC8AD9B7AC46198, http-session-last-accessed-time=1642073811626, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56426 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:51.656  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:51.665  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7644e79c
2022-01-13 11:36:51.671  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7644e79c
2022-01-13 11:36:51.711  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7644e79c
2022-01-13 11:36:51.714  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7644e79c
2022-01-13 11:36:51.802  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7644e79c
2022-01-13 11:36:51.805  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:51.807  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:51.810  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7644e79c
2022-01-13 11:36:51.874  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7644e79c
2022-01-13 11:36:51.887  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:51.890  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:51.894  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7644e79c
2022-01-13 11:36:51.971  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7644e79c
2022-01-13 11:36:51.979  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7644e79c
2022-01-13 11:36:52.101  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17105235927290-545129, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:52.110  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5b0bdae8-f388-4eaa-822c-988976cb8377, content=DENY, timestamp=1642073812110, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:52.113  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=452ms, Total=470ms
2022-01-13 11:36:52.189  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f2c25e15-77e1-4649-a646-79a57a5195db, content=null, timestamp=1642073812170, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56428, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073812157, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=8DE635F41E8DD5F143C627241FC8A3AF, http-session-last-accessed-time=1642073812157, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56428 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:52.193  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:52.199  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bce7eb9
2022-01-13 11:36:52.203  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bce7eb9
2022-01-13 11:36:52.291  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bce7eb9
2022-01-13 11:36:52.294  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bce7eb9
2022-01-13 11:36:52.348  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bce7eb9
2022-01-13 11:36:52.351  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:52.362  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:52.368  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bce7eb9
2022-01-13 11:36:52.442  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bce7eb9
2022-01-13 11:36:52.445  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:52.448  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:52.451  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bce7eb9
2022-01-13 11:36:52.510  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bce7eb9
2022-01-13 11:36:52.512  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bce7eb9
2022-01-13 11:36:52.635  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17105773083390-89119, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:52.640  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f2c25e15-77e1-4649-a646-79a57a5195db, content=DENY, timestamp=1642073812640, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:52.644  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=444ms, Total=461ms
2022-01-13 11:36:52.708  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9a75e038-f663-4c32-9b14-d0aac550dd4a, content=null, timestamp=1642073812691, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56430, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073812678, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=F6F6546AE8B251F2F6E52D15F0549763, http-session-last-accessed-time=1642073812678, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56430 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:52.713  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:52.717  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5236ab1d
2022-01-13 11:36:52.720  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5236ab1d
2022-01-13 11:36:52.771  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5236ab1d
2022-01-13 11:36:52.773  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5236ab1d
2022-01-13 11:36:52.801  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5236ab1d
2022-01-13 11:36:52.810  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:52.814  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:52.820  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5236ab1d
2022-01-13 11:36:52.850  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5236ab1d
2022-01-13 11:36:52.854  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:52.858  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:52.861  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5236ab1d
2022-01-13 11:36:52.940  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5236ab1d
2022-01-13 11:36:52.943  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5236ab1d
2022-01-13 11:36:52.978  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17106293763490-464028, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:52.982  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9a75e038-f663-4c32-9b14-d0aac550dd4a, content=DENY, timestamp=1642073812982, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:52.986  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=266ms, Total=282ms
2022-01-13 11:36:53.032  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=19e7322f-a324-488f-9394-079e5f1cec7f, content=null, timestamp=1642073813024, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56432, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073813021, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=81F7750A024B7E1738C7D29A8AB4A0C9, http-session-last-accessed-time=1642073813021, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56432 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:53.040  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:53.045  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75778763
2022-01-13 11:36:53.050  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75778763
2022-01-13 11:36:53.089  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75778763
2022-01-13 11:36:53.096  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75778763
2022-01-13 11:36:53.142  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75778763
2022-01-13 11:36:53.149  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:53.152  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:53.155  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75778763
2022-01-13 11:36:53.217  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75778763
2022-01-13 11:36:53.222  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:53.225  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:53.228  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75778763
2022-01-13 11:36:53.247  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75778763
2022-01-13 11:36:53.251  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75778763
2022-01-13 11:36:53.286  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17106621054790-240939, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:53.289  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=19e7322f-a324-488f-9394-079e5f1cec7f, content=DENY, timestamp=1642073813289, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:53.293  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=245ms, Total=265ms
2022-01-13 11:36:53.337  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9253f4dd-9fc1-43b4-856f-5fcb35dec67f, content=null, timestamp=1642073813325, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56434, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073813324, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=BF438F8B72A8AA3E7CF89D82F620F927, http-session-last-accessed-time=1642073813324, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56434 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:53.347  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:53.351  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e524f4b
2022-01-13 11:36:53.353  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e524f4b
2022-01-13 11:36:53.436  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e524f4b
2022-01-13 11:36:53.438  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e524f4b
2022-01-13 11:36:53.483  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e524f4b
2022-01-13 11:36:53.488  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:53.491  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:53.494  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e524f4b
2022-01-13 11:36:53.566  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e524f4b
2022-01-13 11:36:53.570  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:53.573  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:53.576  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e524f4b
2022-01-13 11:36:53.662  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e524f4b
2022-01-13 11:36:53.666  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e524f4b
2022-01-13 11:36:53.704  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17106927160890-520074, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:53.719  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9253f4dd-9fc1-43b4-856f-5fcb35dec67f, content=DENY, timestamp=1642073813719, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:53.726  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=369ms, Total=390ms
2022-01-13 11:36:53.781  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=31383793-8389-4c38-9264-7e5f41991fa9, content=null, timestamp=1642073813769, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56436, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073813762, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=4CED81A85686FB229B3DA500C5EA48F3, http-session-last-accessed-time=1642073813762, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56436 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:53.790  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:53.796  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74fc21f9
2022-01-13 11:36:53.798  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74fc21f9
2022-01-13 11:36:53.867  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74fc21f9
2022-01-13 11:36:53.872  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74fc21f9
2022-01-13 11:36:53.900  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74fc21f9
2022-01-13 11:36:53.905  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:53.911  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:53.914  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74fc21f9
2022-01-13 11:36:53.984  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74fc21f9
2022-01-13 11:36:53.986  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:53.989  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:53.991  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74fc21f9
2022-01-13 11:36:54.021  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74fc21f9
2022-01-13 11:36:54.028  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74fc21f9
2022-01-13 11:36:54.067  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17107370211690-522075, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:54.069  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=31383793-8389-4c38-9264-7e5f41991fa9, content=DENY, timestamp=1642073814069, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:54.075  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=276ms, Total=297ms
2022-01-13 11:36:54.128  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=183e6b6b-d791-4710-bb5a-e40a7bb95518, content=null, timestamp=1642073814118, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56438, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073814116, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=77B9559F70A05B22F641FD8E6308E81F, http-session-last-accessed-time=1642073814116, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56438 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:54.134  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:54.139  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42d12057
2022-01-13 11:36:54.143  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42d12057
2022-01-13 11:36:54.182  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42d12057
2022-01-13 11:36:54.190  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42d12057
2022-01-13 11:36:54.252  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42d12057
2022-01-13 11:36:54.255  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:54.258  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:54.261  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42d12057
2022-01-13 11:36:54.293  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42d12057
2022-01-13 11:36:54.300  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:54.305  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:54.309  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42d12057
2022-01-13 11:36:54.342  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42d12057
2022-01-13 11:36:54.346  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42d12057
2022-01-13 11:36:54.418  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17107715175290-55205, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:54.421  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=183e6b6b-d791-4710-bb5a-e40a7bb95518, content=DENY, timestamp=1642073814421, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:54.426  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=283ms, Total=300ms
2022-01-13 11:36:54.466  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7628147b-765a-4a08-9ab7-51c191b88994, content=null, timestamp=1642073814451, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56440, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073814448, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=65ED275B7C7B5719F7300C56A7019C71, http-session-last-accessed-time=1642073814448, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56440 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:54.471  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:54.476  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69192f98
2022-01-13 11:36:54.479  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69192f98
2022-01-13 11:36:54.512  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69192f98
2022-01-13 11:36:54.516  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69192f98
2022-01-13 11:36:54.558  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69192f98
2022-01-13 11:36:54.562  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:54.570  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:54.573  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69192f98
2022-01-13 11:36:54.646  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69192f98
2022-01-13 11:36:54.648  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:54.650  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:54.654  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69192f98
2022-01-13 11:36:54.690  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69192f98
2022-01-13 11:36:54.694  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69192f98
2022-01-13 11:36:54.728  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17108051235290-519232, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:54.732  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7628147b-765a-4a08-9ab7-51c191b88994, content=DENY, timestamp=1642073814732, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:54.735  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=258ms, Total=271ms
2022-01-13 11:36:54.827  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b69c0b78-b611-4a55-936c-b1dd4628c1bb, content=null, timestamp=1642073814800, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56442, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073814789, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=8CA6BC0366CB2E8F5D5548038E44836F, http-session-last-accessed-time=1642073814789, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56442 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:54.833  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:54.846  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49bf60f3
2022-01-13 11:36:54.849  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49bf60f3
2022-01-13 11:36:54.914  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49bf60f3
2022-01-13 11:36:54.918  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49bf60f3
2022-01-13 11:36:55.016  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49bf60f3
2022-01-13 11:36:55.019  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:55.023  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:55.028  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49bf60f3
2022-01-13 11:36:55.069  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49bf60f3
2022-01-13 11:36:55.071  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:55.076  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:55.081  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49bf60f3
2022-01-13 11:36:55.168  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49bf60f3
2022-01-13 11:36:55.171  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49bf60f3
2022-01-13 11:36:55.281  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17108415556090-117735, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:55.284  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b69c0b78-b611-4a55-936c-b1dd4628c1bb, content=DENY, timestamp=1642073815284, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:55.288  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=446ms, Total=475ms
2022-01-13 11:36:55.332  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b666406c-97d0-4e7f-834b-40c0d60a4956, content=null, timestamp=1642073815321, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56444, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073815319, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=172DA7380A14F01B17FC28CAD218FB0B, http-session-last-accessed-time=1642073815319, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56444 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:55.339  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:55.353  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@316050d
2022-01-13 11:36:55.357  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@316050d
2022-01-13 11:36:55.385  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@316050d
2022-01-13 11:36:55.389  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@316050d
2022-01-13 11:36:55.436  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@316050d
2022-01-13 11:36:55.440  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:55.444  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:55.447  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@316050d
2022-01-13 11:36:55.482  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@316050d
2022-01-13 11:36:55.484  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:55.487  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:55.489  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@316050d
2022-01-13 11:36:55.552  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@316050d
2022-01-13 11:36:55.555  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@316050d
2022-01-13 11:36:55.582  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17108923012090-200905, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:55.585  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b666406c-97d0-4e7f-834b-40c0d60a4956, content=DENY, timestamp=1642073815585, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:55.588  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=239ms, Total=259ms
2022-01-13 11:36:55.628  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0f68799f-b293-4c49-9997-33a3c3305581, content=null, timestamp=1642073815621, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56446, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073815620, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=1821E2B13AACFECBA43AF26B3A7D0DC7, http-session-last-accessed-time=1642073815620, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56446 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:55.631  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:55.635  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c68b891
2022-01-13 11:36:55.638  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c68b891
2022-01-13 11:36:55.674  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c68b891
2022-01-13 11:36:55.677  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c68b891
2022-01-13 11:36:55.741  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c68b891
2022-01-13 11:36:55.745  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:55.747  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:55.749  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c68b891
2022-01-13 11:36:55.768  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c68b891
2022-01-13 11:36:55.770  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:55.774  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:55.776  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c68b891
2022-01-13 11:36:55.806  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c68b891
2022-01-13 11:36:55.813  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c68b891
2022-01-13 11:36:55.881  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17109211187390-714480, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:55.884  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0f68799f-b293-4c49-9997-33a3c3305581, content=DENY, timestamp=1642073815884, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:55.887  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=250ms, Total=262ms
2022-01-13 11:36:55.942  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=21522021-8e7b-4dce-b22e-aba50f6a8dde, content=null, timestamp=1642073815933, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56448, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073815931, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=F7D30B4FC8A1A139499F9F7A842AD378, http-session-last-accessed-time=1642073815931, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56448 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:55.948  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:55.952  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2bdcd401
2022-01-13 11:36:55.955  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2bdcd401
2022-01-13 11:36:56.014  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2bdcd401
2022-01-13 11:36:56.017  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2bdcd401
2022-01-13 11:36:56.075  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2bdcd401
2022-01-13 11:36:56.079  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:56.080  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:56.084  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2bdcd401
2022-01-13 11:36:56.131  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2bdcd401
2022-01-13 11:36:56.134  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:56.141  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:56.144  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2bdcd401
2022-01-13 11:36:56.231  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2bdcd401
2022-01-13 11:36:56.234  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2bdcd401
2022-01-13 11:36:56.280  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17109527689090-7015, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:56.285  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=21522021-8e7b-4dce-b22e-aba50f6a8dde, content=DENY, timestamp=1642073816285, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:56.290  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=335ms, Total=353ms
2022-01-13 11:36:56.353  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7a7d23b3-92d4-472f-a3cd-a2b7444661fb, content=null, timestamp=1642073816339, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56450, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073816335, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=F3E3003064B75E59874BD4BCE854D54C, http-session-last-accessed-time=1642073816335, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56450 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:56.362  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:56.389  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@199b2bfd
2022-01-13 11:36:56.397  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@199b2bfd
2022-01-13 11:36:56.492  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@199b2bfd
2022-01-13 11:36:56.495  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@199b2bfd
2022-01-13 11:36:56.571  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@199b2bfd
2022-01-13 11:36:56.577  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:56.579  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:56.583  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@199b2bfd
2022-01-13 11:36:56.662  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@199b2bfd
2022-01-13 11:36:56.665  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:56.668  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:56.671  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@199b2bfd
2022-01-13 11:36:56.714  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@199b2bfd
2022-01-13 11:36:56.718  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@199b2bfd
2022-01-13 11:36:56.772  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17109994792190-719715, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:56.776  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7a7d23b3-92d4-472f-a3cd-a2b7444661fb, content=DENY, timestamp=1642073816776, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:56.784  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=392ms, Total=433ms
2022-01-13 11:36:56.831  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d7ce7db4-40c0-4130-9863-10b56bdd9c85, content=null, timestamp=1642073816822, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56452, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073816820, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=477BF0EFC40FFD7A4D2BE56EFC65BED9, http-session-last-accessed-time=1642073816820, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56452 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:56.837  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:56.841  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e7b2be0
2022-01-13 11:36:56.843  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e7b2be0
2022-01-13 11:36:56.891  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e7b2be0
2022-01-13 11:36:56.894  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e7b2be0
2022-01-13 11:36:56.980  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e7b2be0
2022-01-13 11:36:56.984  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:56.986  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:56.991  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e7b2be0
2022-01-13 11:36:57.032  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e7b2be0
2022-01-13 11:36:57.035  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:57.038  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:57.041  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e7b2be0
2022-01-13 11:36:57.074  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e7b2be0
2022-01-13 11:36:57.078  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e7b2be0
2022-01-13 11:36:57.168  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17110450480490-448267, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:57.170  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d7ce7db4-40c0-4130-9863-10b56bdd9c85, content=DENY, timestamp=1642073817170, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:57.179  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=331ms, Total=351ms
2022-01-13 11:36:57.231  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=48e6dd28-75f0-4dc1-992f-f8593c8d80d7, content=null, timestamp=1642073817219, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56454, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073817216, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=8CBC74167BB8F1EEBDD81266804CB269, http-session-last-accessed-time=1642073817216, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56454 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:57.237  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:57.243  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4db1fa85
2022-01-13 11:36:57.248  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4db1fa85
2022-01-13 11:36:57.271  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4db1fa85
2022-01-13 11:36:57.275  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4db1fa85
2022-01-13 11:36:57.317  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4db1fa85
2022-01-13 11:36:57.319  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:57.322  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:57.326  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4db1fa85
2022-01-13 11:36:57.354  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4db1fa85
2022-01-13 11:36:57.357  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:57.361  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:57.365  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4db1fa85
2022-01-13 11:36:57.447  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4db1fa85
2022-01-13 11:36:57.450  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4db1fa85
2022-01-13 11:36:57.486  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17110850912890-20176, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:57.493  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=48e6dd28-75f0-4dc1-992f-f8593c8d80d7, content=DENY, timestamp=1642073817493, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:57.499  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=253ms, Total=271ms
2022-01-13 11:36:57.559  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b4878b0a-945d-4cd9-b047-92933f451d5e, content=null, timestamp=1642073817549, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56456, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073817547, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=5423136AE0300DEEDB97D172B24C5DA3, http-session-last-accessed-time=1642073817547, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56456 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:57.568  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:57.574  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ef6ddb4
2022-01-13 11:36:57.577  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ef6ddb4
2022-01-13 11:36:57.608  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ef6ddb4
2022-01-13 11:36:57.613  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ef6ddb4
2022-01-13 11:36:57.656  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ef6ddb4
2022-01-13 11:36:57.659  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:57.662  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:57.667  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ef6ddb4
2022-01-13 11:36:57.730  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ef6ddb4
2022-01-13 11:36:57.733  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:57.735  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:57.740  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ef6ddb4
2022-01-13 11:36:57.775  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ef6ddb4
2022-01-13 11:36:57.779  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ef6ddb4
2022-01-13 11:36:57.862  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17111183628390-417997, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:57.868  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b4878b0a-945d-4cd9-b047-92933f451d5e, content=DENY, timestamp=1642073817868, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:57.876  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=296ms, Total=319ms
2022-01-13 11:36:58.003  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6cb68fbf-5bf3-4150-9053-c4bf013bc54c, content=null, timestamp=1642073817947, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56458, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073817929, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=1FF003A38B8FF03E4F1A201B55499793, http-session-last-accessed-time=1642073817929, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56458 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:58.014  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:58.017  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@337b4339
2022-01-13 11:36:58.022  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@337b4339
2022-01-13 11:36:58.057  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@337b4339
2022-01-13 11:36:58.061  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@337b4339
2022-01-13 11:36:58.140  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@337b4339
2022-01-13 11:36:58.145  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:58.148  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:58.151  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@337b4339
2022-01-13 11:36:58.185  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@337b4339
2022-01-13 11:36:58.190  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:58.194  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:58.203  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@337b4339
2022-01-13 11:36:58.236  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@337b4339
2022-01-13 11:36:58.241  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@337b4339
2022-01-13 11:36:58.317  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17111627204190-804872, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:58.321  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6cb68fbf-5bf3-4150-9053-c4bf013bc54c, content=DENY, timestamp=1642073818321, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:58.326  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=305ms, Total=325ms
2022-01-13 11:36:58.392  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=72fc0cab-1796-40b9-a45f-6464b905782d, content=null, timestamp=1642073818376, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56462, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073818374, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=22D4184898ED51CA4CA97E53826CC227, http-session-last-accessed-time=1642073818374, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56462 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:58.397  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:58.405  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f30f129
2022-01-13 11:36:58.408  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f30f129
2022-01-13 11:36:58.441  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f30f129
2022-01-13 11:36:58.445  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f30f129
2022-01-13 11:36:58.482  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f30f129
2022-01-13 11:36:58.486  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:58.489  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:58.493  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f30f129
2022-01-13 11:36:58.530  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f30f129
2022-01-13 11:36:58.534  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:58.538  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:58.543  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f30f129
2022-01-13 11:36:58.631  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f30f129
2022-01-13 11:36:58.634  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f30f129
2022-01-13 11:36:58.662  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17112012270390-461082, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:58.666  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=72fc0cab-1796-40b9-a45f-6464b905782d, content=DENY, timestamp=1642073818666, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:58.669  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=265ms, Total=282ms
2022-01-13 11:36:58.751  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f7e63a8e-88d8-43d7-aa34-4829a9460324, content=null, timestamp=1642073818725, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56464, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073818721, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=5463EA2F6DCF298644072E09E5AF137F, http-session-last-accessed-time=1642073818721, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56464 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:58.759  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:58.768  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c2f8806
2022-01-13 11:36:58.773  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c2f8806
2022-01-13 11:36:58.803  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c2f8806
2022-01-13 11:36:58.805  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c2f8806
2022-01-13 11:36:58.830  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c2f8806
2022-01-13 11:36:58.835  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:58.837  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:58.843  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c2f8806
2022-01-13 11:36:58.913  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c2f8806
2022-01-13 11:36:58.918  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:58.922  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:58.925  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c2f8806
2022-01-13 11:36:58.958  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c2f8806
2022-01-13 11:36:58.965  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c2f8806
2022-01-13 11:36:58.999  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17112374460090-258437, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:59.001  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f7e63a8e-88d8-43d7-aa34-4829a9460324, content=DENY, timestamp=1642073819001, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:59.005  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=238ms, Total=256ms
2022-01-13 11:36:59.067  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7e533b00-d45f-4c21-b54a-8ac320527491, content=null, timestamp=1642073819052, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56466, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073819047, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=A36BFA8B5E92F1DBAFD0206D88616055, http-session-last-accessed-time=1642073819047, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56466 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:59.075  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:59.089  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@164e417d
2022-01-13 11:36:59.094  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@164e417d
2022-01-13 11:36:59.172  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@164e417d
2022-01-13 11:36:59.175  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@164e417d
2022-01-13 11:36:59.269  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@164e417d
2022-01-13 11:36:59.272  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:59.282  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:59.287  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@164e417d
2022-01-13 11:36:59.347  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@164e417d
2022-01-13 11:36:59.350  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:59.353  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:59.356  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@164e417d
2022-01-13 11:36:59.406  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@164e417d
2022-01-13 11:36:59.409  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@164e417d
2022-01-13 11:36:59.479  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17112690046390-102229, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:59.483  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7e533b00-d45f-4c21-b54a-8ac320527491, content=DENY, timestamp=1642073819483, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:59.488  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=404ms, Total=423ms
2022-01-13 11:36:59.540  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ca9ee981-4b90-41e8-aba1-4241505d0599, content=null, timestamp=1642073819532, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56468, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073819529, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=7991B491E231DF70269DD9162AD01F5F, http-session-last-accessed-time=1642073819529, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56468 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:59.550  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:59.555  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d4a5ad
2022-01-13 11:36:59.558  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d4a5ad
2022-01-13 11:36:59.587  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d4a5ad
2022-01-13 11:36:59.591  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d4a5ad
2022-01-13 11:36:59.626  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d4a5ad
2022-01-13 11:36:59.629  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:59.634  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:59.638  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d4a5ad
2022-01-13 11:36:59.675  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d4a5ad
2022-01-13 11:36:59.682  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:59.687  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:59.693  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d4a5ad
2022-01-13 11:36:59.769  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d4a5ad
2022-01-13 11:36:59.772  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d4a5ad
2022-01-13 11:36:59.809  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17113165034390-850885, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:36:59.817  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ca9ee981-4b90-41e8-aba1-4241505d0599, content=DENY, timestamp=1642073819817, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:36:59.824  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=262ms, Total=286ms
2022-01-13 11:36:59.879  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2b3fc61c-1864-4c78-8776-f0d20b8d7e09, content=null, timestamp=1642073819863, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56470, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073819860, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=F79EBF6870E9EBA5C203FFD45A7B145C, http-session-last-accessed-time=1642073819860, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56470 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:36:59.885  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:36:59.893  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a4827f8
2022-01-13 11:36:59.898  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a4827f8
2022-01-13 11:36:59.943  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a4827f8
2022-01-13 11:36:59.947  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a4827f8
2022-01-13 11:36:59.974  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a4827f8
2022-01-13 11:36:59.978  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:36:59.981  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:36:59.985  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a4827f8
2022-01-13 11:37:00.065  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a4827f8
2022-01-13 11:37:00.068  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:37:00.070  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:37:00.072  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a4827f8
2022-01-13 11:37:00.105  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a4827f8
2022-01-13 11:37:00.112  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a4827f8
2022-01-13 11:37:00.156  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17113499532490-674753, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:37:00.162  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2b3fc61c-1864-4c78-8776-f0d20b8d7e09, content=DENY, timestamp=1642073820162, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:37:00.165  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=274ms, Total=288ms
2022-01-13 11:37:00.212  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9cef2da3-bffe-4b9b-9cc9-e0ab1330c84f, content=null, timestamp=1642073820204, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56472, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073820202, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=87D11A98A3A04268C666CB947EA26BD2, http-session-last-accessed-time=1642073820202, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56472 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:37:00.217  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:37:00.228  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7100516f
2022-01-13 11:37:00.247  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7100516f
2022-01-13 11:37:00.286  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7100516f
2022-01-13 11:37:00.292  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7100516f
2022-01-13 11:37:00.390  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7100516f
2022-01-13 11:37:00.393  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:37:00.396  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:37:00.399  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7100516f
2022-01-13 11:37:00.427  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7100516f
2022-01-13 11:37:00.433  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:37:00.438  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:37:00.442  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7100516f
2022-01-13 11:37:00.475  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7100516f
2022-01-13 11:37:00.478  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7100516f
2022-01-13 11:37:00.553  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17113834739990-263847, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:37:00.558  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9cef2da3-bffe-4b9b-9cc9-e0ab1330c84f, content=DENY, timestamp=1642073820558, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:37:00.561  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=335ms, Total=351ms
2022-01-13 11:37:00.632  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9eea7c01-6766-400e-8ef4-e10defab959b, content=null, timestamp=1642073820617, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56474, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073820605, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=398AAA34F21E09EF0B436ECEEEA0232C, http-session-last-accessed-time=1642073820605, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56474 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:37:00.639  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:37:00.650  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@706f036d
2022-01-13 11:37:00.659  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@706f036d
2022-01-13 11:37:00.756  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@706f036d
2022-01-13 11:37:00.759  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@706f036d
2022-01-13 11:37:00.816  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@706f036d
2022-01-13 11:37:00.819  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:37:00.824  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:37:00.827  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@706f036d
2022-01-13 11:37:00.890  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@706f036d
2022-01-13 11:37:00.893  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:37:00.896  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:37:00.901  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@706f036d
2022-01-13 11:37:01.007  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@706f036d
2022-01-13 11:37:01.015  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@706f036d
2022-01-13 11:37:01.073  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17114259808190-966397, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:37:01.076  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9eea7c01-6766-400e-8ef4-e10defab959b, content=DENY, timestamp=1642073821076, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:37:01.081  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=427ms, Total=451ms
2022-01-13 11:37:01.128  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=79380ece-b92f-4757-b0fc-29862bfe9a0d, content=null, timestamp=1642073821119, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56476, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073821116, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=20F45A1611D1C27D767C9AF3CB793B19, http-session-last-accessed-time=1642073821116, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56476 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:37:01.134  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:37:01.140  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f1ceb6a
2022-01-13 11:37:01.142  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f1ceb6a
2022-01-13 11:37:01.175  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f1ceb6a
2022-01-13 11:37:01.180  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f1ceb6a
2022-01-13 11:37:01.219  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f1ceb6a
2022-01-13 11:37:01.223  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:37:01.225  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:37:01.228  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f1ceb6a
2022-01-13 11:37:01.303  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f1ceb6a
2022-01-13 11:37:01.306  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:37:01.308  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:37:01.312  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f1ceb6a
2022-01-13 11:37:01.341  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f1ceb6a
2022-01-13 11:37:01.345  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f1ceb6a
2022-01-13 11:37:01.380  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17114749600990-98478, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:37:01.385  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=79380ece-b92f-4757-b0fc-29862bfe9a0d, content=DENY, timestamp=1642073821385, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:37:01.388  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=247ms, Total=265ms
2022-01-13 11:37:01.439  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=221807a5-51b4-488b-9f50-0d71fd6f4285, content=null, timestamp=1642073821418, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56478, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073821415, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9B3341163D9DFFED0DB0F21FBE686614, http-session-last-accessed-time=1642073821415, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56478 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:37:01.447  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:37:01.455  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2daab33c
2022-01-13 11:37:01.460  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2daab33c
2022-01-13 11:37:01.493  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2daab33c
2022-01-13 11:37:01.500  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2daab33c
2022-01-13 11:37:01.578  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2daab33c
2022-01-13 11:37:01.582  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:37:01.585  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:37:01.587  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2daab33c
2022-01-13 11:37:01.611  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2daab33c
2022-01-13 11:37:01.617  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:37:01.620  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:37:01.624  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2daab33c
2022-01-13 11:37:01.664  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2daab33c
2022-01-13 11:37:01.667  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2daab33c
2022-01-13 11:37:01.759  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17115064629290-107211, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:37:01.761  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=221807a5-51b4-488b-9f50-0d71fd6f4285, content=DENY, timestamp=1642073821761, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:37:01.767  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=308ms, Total=331ms
2022-01-13 11:37:01.813  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=13573116-63db-4e25-b384-cd48fee86fb0, content=null, timestamp=1642073821806, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56480, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073821803, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9E326E0B402A0BDB8707C88B5962AABF, http-session-last-accessed-time=1642073821803, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56480 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:37:01.820  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:37:01.827  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e2a8a99
2022-01-13 11:37:01.830  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e2a8a99
2022-01-13 11:37:01.863  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e2a8a99
2022-01-13 11:37:01.869  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e2a8a99
2022-01-13 11:37:01.911  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e2a8a99
2022-01-13 11:37:01.914  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:37:01.917  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:37:01.923  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e2a8a99
2022-01-13 11:37:01.992  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e2a8a99
2022-01-13 11:37:01.995  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:37:01.998  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:37:02.003  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e2a8a99
2022-01-13 11:37:02.037  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e2a8a99
2022-01-13 11:37:02.042  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e2a8a99
2022-01-13 11:37:02.091  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17115435811390-483549, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:37:02.095  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=13573116-63db-4e25-b384-cd48fee86fb0, content=DENY, timestamp=1642073822095, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:37:02.099  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=271ms, Total=287ms
2022-01-13 11:37:02.174  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=503b2a37-3c5d-4f25-89f8-99d49a95699e, content=null, timestamp=1642073822144, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=56482, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=41e54d18924a, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=09c6119d-2ccc-47e4-a6de-f7b9316e38a6, http-req-server-port=80, http-header-accept=*/*, kc-id=99243dfe-03cf-4c18-9f95-9c06f359a356, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1642073822143, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeAP3XNxAH4AEQAAAABh4A6xdAAkOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJGMkZTX3JJMDR0SkpMYkFER0UzVVZBVUl3Q0FXM09mM2U2cFdWM3ZiczhVIn0.eyJleHAiOjE2NDIwNzQwNzcsImlhdCI6MTY0MjA3Mzc3NywianRpIjoiOTkyNDNkZmUtMDNjZi00YzE4LTlmOTUtOWMwNmYzNTlhMzU2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMDljNjExOWQtMmNjYy00N2U0LWE2ZGUtZjdiOTMxNmUzOGE2IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.F-QVY0lJY5gQ15H1DKcHfzbJJRXNL8kDYOG7kqB5gmnvbpI-3FXSwlqN6_hEZIedXR2-Z8clx1lkRupB0sY6kKvHjtKW3wsGRUhjVWjO_Y0g-sVoeXtLCw5wfcG_NZweUJwi7IQMSZxD9rlW6iDBRGIRmU8Apco6zwO3_-Hgpt8je8R-LIK51tobRc7S83KYuxZ6Zknd8iVViJoMMsW-AiPv2Ysw2cdpRe8e9Sbw5S3XeWDc87J6VSX0S7wQuCYvoF2piXcfB8A1q-9mx8B4ss1u7iiTFD3amX_l7RsVlKNBzdGXyynXpA5jJkgz1InvICBXTpuMbsWfWhCvIuXdbA, http-req-servlet-path=/rest/acute-care-demo/hospital/end_es, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital/end_es, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1642074077, actionId=POST, http-req-url=/rest/acute-care-demo/hospital/end_es, http-req-uri=/rest/acute-care-demo/hospital/end_es, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=984A84FB48A73E00C4618A991985D670, http-session-last-accessed-time=1642073822143, kc-category-name=ACCESS, kc-iat=1642073777, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:56482 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-13 11:37:02.183  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-13 11:37:02.189  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65dd83ce
2022-01-13 11:37:02.194  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65dd83ce
2022-01-13 11:37:02.268  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65dd83ce
2022-01-13 11:37:02.272  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65dd83ce
2022-01-13 11:37:02.370  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65dd83ce
2022-01-13 11:37:02.374  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:37:02.379  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:37:02.383  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65dd83ce
2022-01-13 11:37:02.424  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65dd83ce
2022-01-13 11:37:02.427  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2022-01-13 11:37:02.436  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2022-01-13 11:37:02.439  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65dd83ce
2022-01-13 11:37:02.471  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65dd83ce
2022-01-13 11:37:02.475  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65dd83ce
2022-01-13 11:37:02.547  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-17115797853790-52782, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}})
2022-01-13 11:37:02.551  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=503b2a37-3c5d-4f25-89f8-99d49a95699e, content=DENY, timestamp=1642073822551, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-hospital:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-hospital, asclepios:obligation:parent=End-ES, asclepios:obligation:name=Rule 9 - Start and end teams are different, asclepios:obligation:decision=DENY}, TrackingObligation:eba9cb72-ded5-45d5-b061-384bb978fc5f:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=eba9cb72-ded5-45d5-b061-384bb978fc5f, asclepios:obligation:name=End-ES, asclepios:obligation:decision=DENY}}))
2022-01-13 11:37:02.557  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=364ms, Total=384ms
